[{"path":"https://nicholasclark.github.io/TIRTLtools/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 TIRTLtools authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/TCRdist.html","id":"what-is-tcrdist","dir":"Articles","previous_headings":"","what":"What is TCRdist?","title":"Fast TCR similarity calculation with TCRdist GPU","text":"TCRdist (Dash et al., Nature 2017) quantifies similarity two T-cell receptors based concordance amino acid sequences regions important antigen recognition. algorithm computes weighted Hamming distance two TCRs, using BLOSUM62 substitution matrix penalize amino acids mismatches V/J segments CDR3 loops.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/TCRdist.html","id":"why-is-tcrdist-important","dir":"Articles","previous_headings":"","what":"Why is TCRdist important?","title":"Fast TCR similarity calculation with TCRdist GPU","text":"TCRdist can used discover clusters similar TCRs associated response antigen. combined databases known TCRs associated certain viruses epitopes, like VDJ-db metaCoNGA, TCRdist can used label virus/epitope-specific TCRs currently unknown TCRs. reverse epitope discovery techniques, experimental methods can used discover epitopes targeted antigen-responsive TCR clusters.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/TCRdist.html","id":"why-do-we-need-another-tcrdist-implementation","dir":"Articles","previous_headings":"","what":"Why do we need another TCRdist implementation?","title":"Fast TCR similarity calculation with TCRdist GPU","text":"TCRdist originally implemented Python (tcr-dist), computation becomes slow calculating pairwise TCRdist values thousands TCRs. Efforts speed TCRdist calculation Python made using numba, high-performance just--time (JIT) compiler (tcrdist3), Cython, compiles Python code fast C code (fast_tcrdist), standard C++ (CoNGA). faster implementations work well paired TCR datasets ~100k TCRs, sufficient thus far. However, TIRTLseq become possible rapidly cheaply generate even larger paired TCR datasets computation time scales quadratically number TCRs, calculating TCRdist becomes prohibitively slow hundreds thousands 1 million+ TCRs. address , leveraged GPU computation, can significantly outperform compiled C++ executed CPU. wrote GPU-enabled TCRdist implementation Python (R wrapper) faster existing implementations suitable use extra-large datasets paired TCRs. efficient (minutes hours) datasets 100k 1 million+ TCRs super-fast (seconds) datasets 10k 100k TCRs. batches computation, keeps results sparse format, can progressively write results text file rather returning cumbersomely large data object. implementation compatible NVIDIA Apple Silicon GPUs automatically detects user’s GPU type. uses cupy (NVIDIA GPUs) mlx (Apple Silicon GPUs) compute pairwise TCRdist batch TCRs, using numpy backup GPU available. TCRdist() function TIRTLtoolsis wrapper allows us run fast GPU implementation via R using reticulate package.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/TCRdist.html","id":"notes-on-our-implementation","dir":"Articles","previous_headings":"","what":"Notes on our implementation","title":"Fast TCR similarity calculation with TCRdist GPU","text":"va - V-segment alpha chain cdr3a - CDR3 amino acid sequence alpha chain vb - V-segment beta chain cdr3b - CDR3 amino acid sequence beta chain implementation currently ignores J-segments calculates similarity based V-segment CDR3 amino acid sequence. implementation currently align CDR3 segments. pads CDR3 amino acid sequences center blanks common length (29 AA) penalizes mismatches two sequences. implementation currently requires V-segments CDR3 sequences alpha beta chains. single-chain data , can insert dummy values V CDR3 columns missing chain allow compatibility function. implementation uses pre-calculated substitution matrix amino acids V-segments. TCRs whose amino acid sequences contain stop codons (*) frameshifts (_) TCRs V-segments found substitution matrix dropped. list permitted amino acids V-segments, see TIRTLtools::params$feature. V-segments include allele identifier, e.g. “TRAV13-1*03”. V-segments include alleles, function automatically add “*01” . may also run TCRdist directly Python https://github.com/NicholasClark/TCRdist_gpu. However, steps preparing data (dropping improper TCRs adding alleles) part Python function, may want run prep_for_tcrdist() data first write data frame file. discard large TCRdist values (>= cutoff, default 90) return dataframe row contains one TCRdist value pair TCRs.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/TCRdist.html","id":"load-the-package","dir":"Articles","previous_headings":"TCRdist example","what":"Load the package","title":"Fast TCR similarity calculation with TCRdist GPU","text":"","code":"library(TIRTLtools) library(dplyr) library(rmarkdown)"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/TCRdist.html","id":"load-a-paired-tcr-dataset","dir":"Articles","previous_headings":"TCRdist example","what":"Load a paired TCR dataset","title":"Fast TCR similarity calculation with TCRdist GPU","text":"example, load paired TCRs TIRTLseq experiments using CD4 CD8-isolated T-cell samples taken COVID-19-infected patients three timepoints part St. Jude Tracking Study Immune Responses Associated COVID-19 (SJTRC). can use get_all_tcrs() function get data frame paired TCRs samples. can optionally remove MAIT TCRs, share invariant alpha-chain thus often lower TCRdist values, forming dense clusters may interested . filtering, ~100k TCRs.","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\", package = \"TIRTLtools\") data = load_tirtlseq(folder, meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\", chain = \"paired\", verbose = FALSE) ## Loading files from: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/TIRTLtools/extdata/SJTRC_TIRTL_seq_longitudinal... ## Found 6 beta chain pseudo-bulk files. ## Found 6 paired chain files. ## Loaded 6 files from 6 samples. ## 0.7 seconds data$meta %>%   mutate(label = paste(substr(label, 0, 20), \"...\", sep = \"\")) %>%   paged_table() all_tcrs = get_all_tcrs(data) input_tcrs = all_tcrs %>% prep_for_tcrdist(remove_MAIT = TRUE) ## Removed 1,755 TCRs with unknown V-segments (1.1%) from a total of 165,671 TCRs. ## Removed 94 TCRs with short CDR3 segments (0.057%) from a total of 163,916 TCRs. ## Removed 59,986 TCRs with non-functional CDR3 amino acid sequences (37%) from a total of 163,822 TCRs. ## Removed 1,321 MAIT TCRs (1.3%) from a total of 103,836 TCRs. ## Filtered data frame contains 102,515 TCRs (62%) of original 165,671 TCRs. ### note: You may replace this with a file of your choice - needs to have columns \"va\", \"vb\", \"cdr3a\", and \"cdr3b\"  input_tcrs %>%   mutate(alpha_nuc = paste(substr(alpha_nuc, 0, 20), \"...\", sep = \"\"),          beta_nuc = paste(substr(beta_nuc, 0, 20), \"...\", sep = \"\")) %>%   arrange(desc(wij)) %>%   paged_table()"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/TCRdist.html","id":"run-tcrdist","dir":"Articles","previous_headings":"TCRdist example","what":"Run TCRdist","title":"Fast TCR similarity calculation with TCRdist GPU","text":"TCRs processed chunks (default 1000). dataset size (~100k TCRs), computation laptop Apple Silicon M4 Pro GPU takes 30 seconds.","code":"install_python_env() ## if you do not run this line, you may be prompted to install the python environment necessary for TCRdist() ## Installing/updating the Python environment for TIRTLtools... ## Done. result = TCRdist(tcr1 = input_tcrs, tcrdist_cutoff = 90, chunk_size = 1000) ## Removed 0 TCRs with unknown V-segments (0%) from a total of 102,515 TCRs. ## Removed 0 TCRs with short CDR3 segments (0%) from a total of 102,515 TCRs. ## Removed 0 TCRs with non-functional CDR3 amino acid sequences (0%) from a total of 102,515 TCRs. ## [1] \"converting to data.table\" ## Filtered data frame contains 102,515 TCRs (100%) of original 102,515 TCRs."},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/TCRdist.html","id":"inspect-the-output","dir":"Articles","previous_headings":"TCRdist example","what":"Inspect the output","title":"Fast TCR similarity calculation with TCRdist GPU","text":"function returns “list” two slots: TCRdist_df - dataframe 3 columns, containing TCRdist values <= cutoff (default 90) sparse format. row contains TCRdist value two TCRs identified indices. may thought dataframe “edges” “nodes” (TCRs) network. tcr1 - dataframe input TCRs, assigned indices, metadata. TCR indices, starting 0, found tcr_index column. Note dataframe may fewer rows input TCRs non-functional CDR3s non-standard V-segments may removed. calculating TCRdist two different sets TCRs, output also contain another slot tcr2 second dataframe input TCRs. Important note: TCRs assigned indices starting 0 (Python-style) rather starting 1 (R style) dataset ~100k TCRs, detect ~75k relationships similar TCRs (TCRdist <= 90). row output table, can view two TCRs:","code":"edge_df = result[['TCRdist_df']] ### table of TCRdist values <= cutoff node_df = result[['tcr1']] ### table of input data with indices  node_df %>%    select(tcr_index, everything()) %>%   mutate(alpha_nuc = paste(substr(alpha_nuc, 0, 20), \"...\", sep = \"\"),          beta_nuc = paste(substr(beta_nuc, 0, 20), \"...\", sep = \"\")) %>%   paged_table() edge_df %>% paged_table() nrow(edge_df) # ~75k edges ## [1] 75713 row_idx = 1 node_df %>%    filter(tcr_index %in% c(edge_df$node1_0index[row_idx], edge_df$node2_0index[row_idx])) %>%   select(va, ja, cdr3a, cdr3b, vb, jb) %>%   paged_table()"},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/TIRTLtools.html","id":"option-1-install-directly-from-github","dir":"Articles","previous_headings":"Installation","what":"Option 1: Install directly from GitHub","title":"Quickstart","text":"","code":"# install.packages(\"remotes\") ## Run if you need to install the 'remotes' package remotes::install_github(\"NicholasClark/TIRTLtools\") library(TIRLTtools)"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/TIRTLtools.html","id":"option-2-advanced-download-to-local-folder-and-load-using-devtools","dir":"Articles","previous_headings":"Installation","what":"Option 2: (advanced) Download to local folder and load using ‘devtools’","title":"Quickstart","text":"Run following line terminal download git repository. Load package local folder R","code":"git clone https://github.com/NicholasClark/TIRTLtools.git # install.packages(\"devtools\") ## Run if you need to install the 'devtools' package devtools::load_all(\"./TIRTLtools\") ### location of cloned repo on your machine"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/data_loading.html","id":"tirtlseq-text-file-data-structure","dir":"Articles","previous_headings":"","what":"TIRTLseq text file data structure","title":"Loading Paired TCR TIRTLseq data in R","text":"TIRTLseq data kept tab-separated text files (.tsv). files may ‘gzipped’ (.tsv.gz) save space. Output sample consists 3 files: <sample-name>_TIRTLoutput.tsv(.gz)– Paired TCRs – table computationally paired alpha/beta TCRs <sample-name>_pseudobulk_TRA.tsv(.gz) – Alpha chain “pseudo-bulk” data – table read count summary metrics alpha-chains across wells plate <sample-name>_pseudobulk_TRB.tsv(.gz) – Beta chain “pseudo-bulk” data – table read count summary metrics beta-chains across wells plate","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/data_loading.html","id":"loading-tirtlseq-data","dir":"Articles","previous_headings":"","what":"Loading TIRTLseq Data","title":"Loading Paired TCR TIRTLseq data in R","text":"load_tirtlseq() function loads paired TCR TIRTLseq data text files directory. function can also automatically assemble metadata table files named way specifies sample metadata. , files named (marker)_(timepoint)_(version)_ ... .tsv.gz, e.g. cd8_tp1_v2_TIRTLoutput.tsv.","code":"library(TIRTLtools) library(dplyr) library(rmarkdown) folder = system.file(\"extdata/SJTRC_TIRTLseq_minimal\", package = \"TIRTLtools\") dir(folder) ## [1] \"cd8_tp1_v2_pseudobulk_TRA.tsv.gz\" \"cd8_tp1_v2_pseudobulk_TRB.tsv.gz\" ## [3] \"cd8_tp1_v2_TIRTLoutput.tsv.gz\"    \"cd8_tp2_v2_pseudobulk_TRA.tsv.gz\" ## [5] \"cd8_tp2_v2_pseudobulk_TRB.tsv.gz\" \"cd8_tp2_v2_TIRTLoutput.tsv.gz\" ts_data = load_tirtlseq(folder, meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\") ## these files are named (marker)_(timepoint)_(version)_etc.tsv.gz"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/data_loading.html","id":"the-tirtlseqdataset-object","dir":"Articles","previous_headings":"","what":"The “TIRTLseqDataSet” object","title":"Loading Paired TCR TIRTLseq data in R","text":"R, store TIRTLseq data “list”, can contain type unstructured data, following structure: list contains two slots. meta - data frame sample metadata data - list data sample convenience, list given class “TIRTLseqDataSet”, print() summary() methods.","code":"your_data_object (list) ├───meta (metadata dataframe) └───data (list)     └───sample_1 (list)         ├───alpha (alpha pseudobulk dataframe)         ├───beta (beta pseudobulk dataframe)         └───paired (paired pseudobulk dataframe)     ...     └───sample_n (list)         ├───alpha (alpha pseudobulk dataframe)         ├───beta (beta pseudobulk dataframe)         └───paired (paired pseudobulk dataframe) names(ts_data) ## [1] \"data\" \"meta\" ## [1] \"data\" \"meta\" ## slots are accessible via \"$\" ## ts_data$meta ## a data frame ## ts_data$data ## a list with data for each sample class(ts_data) ## \"TIRTLseqDataSet\" ## [1] \"TIRTLseqDataSet\" print(ts_data) ## <TIRTLseqDataSet> ##   Number of samples: 2  ##   Samples: cd8_tp1_v2 cd8_tp2_v2 summary(ts_data) ## <TIRTLseqDataSet> ##   Number of samples: 2  ##   Per-sample TCR counts (alpha / beta / paired): ## # A tibble: 2 × 5 ##   sample_id  `Paired TCRs` `Unique Paired TCRs` `Alpha Chains` `Beta Chains` ##   <chr>              <int>                <int>          <int>         <int> ## 1 cd8_tp1_v2         20690                14273         937875        928777 ## 2 cd8_tp2_v2         26260                17891         980522        895688"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/data_loading.html","id":"the-metadata-table","dir":"Articles","previous_headings":"The “TIRTLseqDataSet” object","what":"The metadata table","title":"Loading Paired TCR TIRTLseq data in R","text":"$meta slot contains data frame columns sample_id (determined filename) columns specified “meta_columns” argument. label column combines metadata columns one string. specify “meta_columns” load_tirtlseq() call, table contain sample_id label columns.","code":"class(ts_data$meta) ## data.frame ## [1] \"tbl_df\"     \"tbl\"        \"data.frame\" ts_data$meta %>%   mutate(label = paste(substr(label, 0, 20), \"...\", sep = \"\")) %>%   paged_table()"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/data_loading.html","id":"the-data-list","dir":"Articles","previous_headings":"The “TIRTLseqDataSet” object","what":"The data list","title":"Loading Paired TCR TIRTLseq data in R","text":"$data slot also “list” contains one object sample, named sample_id. sample, $data$<sample-name> “list” three data frames. $data$<sample-name>$alpha contains pseudo-bulk data alpha chain $data$<sample-name>$beta contains pseudo-bulk data beta chain $data$<sample-name>$paired contains alpha beta chains paired computationally MAD-HYPE T-SHELL algorithms.","code":"class(ts_data$data) ## list ## [1] \"list\" names(ts_data$data) ## [1] \"cd8_tp1_v2\" \"cd8_tp2_v2\" ## [1] \"cd8_tp1_v2\" \"cd8_tp2_v2\" class(ts_data$data$cd8_tp1_v2) ## list ## [1] \"list\" names(ts_data$data$cd8_tp1_v2) ## [1] \"alpha\"  \"beta\"   \"paired\" ## [1] \"alpha\"  \"beta\"   \"paired\""},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/data_loading.html","id":"the-pseudo-bulk-data-frames","dir":"Articles","previous_headings":"The “TIRTLseqDataSet” object > The data list","what":"The pseudo-bulk data frames","title":"Loading Paired TCR TIRTLseq data in R","text":"TIRTLseq assay, one experiment repeated hundreds times multi-well plate. Generally, experiment repeated half plate (192 wells) whole plate (384 wells). Alpha beta TCRs sequenced simultaneously, separately well. reads well processed using MiXCR, calls V J segments, assembles CDR3 nucleotide sequence, generates corresponding amino acid sequence. clonotype defined unique CDR3 nucleotide sequence, following reported:","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/data_loading.html","id":"read-identifying-information","dir":"Articles","previous_headings":"The “TIRTLseqDataSet” object > The data list > The pseudo-bulk data frames","what":"Read identifying information","title":"Loading Paired TCR TIRTLseq data in R","text":"targetSequences - CDR3 nucleotide sequence v - V-segment call MiXCR j - J-segment call MiXCR aaSeqCDR3 - CDR3 amino acid sequence, including stop codons (*) frameshifts (_)","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/data_loading.html","id":"read-count-summary-metrics","dir":"Articles","previous_headings":"The “TIRTLseqDataSet” object > The data list > The pseudo-bulk data frames","what":"Read count summary metrics","title":"Loading Paired TCR TIRTLseq data in R","text":"readCount - sum read counts wells clonotype readFraction - fraction reads attributed clonotype sem - standard error mean read fraction. n_wells - number wells clonotype observed max_wells - number wells used experiment (generally clonotypes) readCount_max - maximum read count well clonotype readCount_median - median read count clonotype $data$<sample-name>$alpha $data$<sample-name>$beta contain pseudo-bulk data alpha beta chains, respectively.","code":"ts_data$data$cd8_tp1_v2$alpha %>%   mutate(targetSequences = paste(substr(targetSequences, 0, 20), \"...\", sep = \"\")) %>%   paged_table() ts_data$data$cd8_tp1_v2$beta %>%   mutate(targetSequences = paste(substr(targetSequences, 0, 20), \"...\", sep = \"\")) %>%   paged_table()"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/data_loading.html","id":"the-paired-data-frame","dir":"Articles","previous_headings":"The “TIRTLseqDataSet” object > The data list","what":"The paired data frame","title":"Loading Paired TCR TIRTLseq data in R","text":"use computational algorithms based occurrence patterns (MAD-HYPE algorithm) correlation read fractions (T-SHELL) TCR chains across wells identify alpha beta chains present clone. general, MAD-HYPE method works well moderately frequent clones, fails frequent clones found almost wells. T-SHELL algorithm works well pairing frequent clones. pair, report:","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/data_loading.html","id":"vjcdr3-sequences","dir":"Articles","previous_headings":"The “TIRTLseqDataSet” object > The data list > The paired data frame","what":"V/J/CDR3 sequences","title":"Loading Paired TCR TIRTLseq data in R","text":"alpha_nuc_seq, alpha_nuc - alpha CDR3 nucleotide sequence beta_nuc_seq, beta_nuc - beta CDR3 nucleotide sequence alpha_beta - alpha-beta pair concatenated nucleotide sequence cdr3a - alpha CDR3 amino acid sequence va - alpha V gene ja - alpha J gene cdr3b - beta CDR3 amino acid sequence vb - beta V gene jb - beta J gene","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/data_loading.html","id":"alphabeta-chain-occurence-and-overlap","dir":"Articles","previous_headings":"The “TIRTLseqDataSet” object > The data list > The paired data frame","what":"Alpha/beta chain occurence and overlap","title":"Loading Paired TCR TIRTLseq data in R","text":"wa - number wells alpha found wb - number wells beta found wi - number wells alpha found, beta wj - number wells beta found, alpha wij - number wells alpha beta found","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/data_loading.html","id":"pairing-method-scores-and-metrics","dir":"Articles","previous_headings":"The “TIRTLseqDataSet” object > The data list > The paired data frame","what":"Pairing method scores and metrics","title":"Loading Paired TCR TIRTLseq data in R","text":"method - method resulted pairing: T-SHELL MAD-HYPE r - T-SHELL, Pearson correlation coefficient alpha beta chain frequencies ts - T-SHELL, t-statistic correlation pval - T-SHELL, p-value correlation pval_adj - T-SHELL, adjusted p-value correlation score - MAD-HYPE, score pairing (higher better) loss_a_frac - fraction wells lost alpha chain loss_b_frac - fraction wells lost beta chain Note: TCR pair paired algorithms, listed twice $paired data frame, “MAD-HYPE” method “T-SHELL” method. see unique TCR pairs, may following:","code":"ts_data$data$cd8_tp1_v2$paired %>%   mutate(alpha_nuc = paste(substr(alpha_nuc, 0, 20), \"...\", sep = \"\"),          beta_nuc = paste(substr(beta_nuc, 0, 20), \"...\", sep = \"\")          ) %>%   paged_table() ## example TCR pair with two entries, one for each pairing algorithm ts_data$data$cd8_tp1_v2$paired %>%    filter(alpha_beta == \"TGTGTGAGAGCCGGAGGCTTCAAAACTATCTTT_TGCAGTGCTACATCTCGGAGAGAGCCCTACGAGCAGTACTTC\") %>%   select(alpha_nuc, beta_nuc, method, everything()) %>%   paged_table() pairs = ts_data$data$cd8_tp1_v2$paired pairs_unique = pairs[!duplicated(pairs$alpha_beta),]  pairs_unique %>%   mutate(alpha_nuc = paste(substr(alpha_nuc, 0, 20), \"...\", sep = \"\"),          beta_nuc = paste(substr(beta_nuc, 0, 20), \"...\", sep = \"\")) %>%   paged_table() nrow(pairs) ## ~20k TCR pairs called by one or both methods ## [1] 20690 nrow(pairs_unique) ## ~14k unique TCR pairs called ## [1] 14273"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/pairing_zenodo_data.html","id":"tutorial-overview","dir":"Articles","previous_headings":"","what":"Tutorial overview","title":"TCR-alpha/beta pairing for COVID-19 related TCRs","text":"vignette shows generate paired TCR single-chain “pseudo-bulk” data using raw TIRTLseq TCR-alpha/beta read counts half 384-well plate. find TCR pairs CD8+ T-cells isolated patient samples naturally acquired SARS-CoV-2 infection re-create figure TIRTLseq paper showing changes patient’s TCR repertoire time.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/pairing_zenodo_data.html","id":"study-details","dir":"Articles","previous_headings":"","what":"Study details","title":"TCR-alpha/beta pairing for COVID-19 related TCRs","text":"example, use data St. Jude Tracking Study Immune Responses Associated COVID-19 (SJTRC), clinical trial launched 2020 study T-cell receptor repertoires adults naturally acquired COVID-19. prospective, longitudinal cohort study involving adult employees (18 years older) St. Jude Children’s Research Hospital Memphis, TN, USA. Participants underwent weekly PCR screening SARS-CoV-2 infection St. Jude campus. Blood samples collected 8-ml cell preparation tubes, processed within 24 h cellular plasma components, aliquoted frozen future analysis. , use samples healthy 33-year-old female donor naturally acquired mild SARS-CoV-2 infection prior history SARS-CoV-2 infection vaccination. Samples collected 143 days donor’s first positive SARS-CoV-2 PCR test (baseline sample), 6 days (acute sample) 29 days (convalescent sample).","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/pairing_zenodo_data.html","id":"download-data","dir":"Articles","previous_headings":"Instructions","what":"Download data","title":"TCR-alpha/beta pairing for COVID-19 related TCRs","text":"need download data Zenodo running code. data using exp3_clones.tar.gz, includes well-level TIRTLseq data three 384-well plates. need unzip tar.gz file well data plate. Note: large files. tar.gz file 1.4 GB uncompressed data 7.8 GB.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/pairing_zenodo_data.html","id":"set-up-inputoutput-directories","dir":"Articles","previous_headings":"Instructions","what":"Set up input/output directories","title":"TCR-alpha/beta pairing for COVID-19 related TCRs","text":"Change folder locations following code block directory downloaded unzipped data (folder) directory like save paired TCR output (save_folder).","code":"folder = \"~/Downloads/zenodo/exp3_clones/\" ### change this to the directory with your downloaded data! save_folder = \"~/git/TIRTLtools/extra/exp3_cd8\" ### change this to the folder you would like to save paired output in (if the folder does not exist it will be created)"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/pairing_zenodo_data.html","id":"select-plate-rows-and-columns","dir":"Articles","previous_headings":"Instructions","what":"Select plate rows and columns","title":"TCR-alpha/beta pairing for COVID-19 related TCRs","text":"CD4+ CD8+ T-cells isolated peripheral blood mononuclear cells (PBMCs) sample. timepoint, CD8+ cells plated left half wells 384-well plate CD4+ cells plated right half. case, pair CD8+ cells, select columns 1 12 (left half plate) rows 1 16 (P, rows).","code":"library(TIRTLtools) ## Loading required package: ggplot2 tp1 = file.path(folder, \"TCR_clones_ID02\") ## baseline (pre-infection) tp2 = file.path(folder, \"TCR_clones_ID03\") ## acute (6 days after infection) tp3 = file.path(folder, \"TCR_clones_ID04\") ## convalescent (29 days after infection)  cd8_wells = get_well_subset(row_range = 1:16, col_range = 1:12) ## left half of the plate (CD8+)"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/pairing_zenodo_data.html","id":"run-pairing-algorithms","dir":"Articles","previous_headings":"Instructions","what":"Run pairing algorithms","title":"TCR-alpha/beta pairing for COVID-19 related TCRs","text":"run_pairing() function run pairing scripts, implement MAD-HYPE T-SHELL algorithms. algorithms implemented Python using GPU-accelerated packages (numpy CPU-backup) fast calculation. package automatically install python environment necessary packages detect GPU type (NVIDIA Apple Silicon) machine, one available. function call may take minutes run. main arguments function : folder_path - path folder well-level data folder_out - path folder write results (function create folder exist) prefix - prefix (e.g. sample name) output file names well_filter_thres - threshold number unique clones found well, quality control well_pos - position well ID (e.g. “B5”) file names. wellset1 - vector wells use pairing. information, check documentation ?run_pairing. well-level data files folder named something like MVP113_TIRTLseq_P12_S263.TCRa_ID02.clones_TRA.tsv, well ID (P12 case) third position (separate underscores) use well_pos=3. use get_well_subset() function generate vector wells left side plate. , run run_pairing() function, saving output CD8+ cells plate folder, different prefix : <experiment>_<timepoint>_<marker>.","code":"install_python_env() ## if you do not run this line, you may be prompted to install the python environment necessary for run_pairing() ## Installing/updating the Python environment for TIRTLtools... ## Done. run_pairing(folder_path = tp1, folder_out = save_folder, prefix = \"exp3_tp1_cd8\", well_filter_thres = 0.5,           well_pos = 3, wellset1 = cd8_wells) ## [1] \"start\" ## [1] \"2025-12-01 11:56:36 CST\" ## [1] \"Folder already exists: ~/git/TIRTLtools/extra/exp3_cd8\" ## [1] \"384 TCRalpha well files loaded\" ## [1] \"384 TCRalpha well files loaded\" ## [1] \"2025-12-01 11:57:07 CST\" ## [1] \"Clone threshold for QC:\" ## [1] 3210 ## [1] \"Alpha wells passing QC:\" ##  ## FALSE  TRUE  ##   193   191  ## [1] \"Beta wells passing QC:\" ##  ## FALSE  TRUE  ##   193   191  ## [1] \"Tabulating TCRalpha pseudobulk counts\" ## [1] \"2025-12-01 11:57:07 CST\" ## [1] \"Tabulating TCRbeta pseudobulk counts\" ## [1] \"2025-12-01 11:57:31 CST\" ## [1] \"Pseudobulk done.\" ## [1] \"2025-12-01 11:57:52 CST\" ## [1] \"Merging alpha clonesets...\" ## [1] \"Done! Unique alpha clones and wells after filtering:\" ## [1] 937875    191 ## [1] \"2025-12-01 11:57:53 CST\" ## [1] \"Unique alpha clones and wells in more than: 2 wells\" ## [1] 36679   191 ## [1] \"Done! beta clones and wells after filtering:\" ## [1] 928777    191 ## [1] \"2025-12-01 11:57:54 CST\" ## [1] \"Unique beta clones and wells in more than: 2 wells\" ## [1] 36080   191 ## [1] \"2025-12-01 11:57:54 CST\" ## [1] \"Pre-computing look-up table:\" ##   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100% ## [1] \"2025-12-01 11:57:58 CST\" ## [1] \"Filtering results, adding amino acid and V segment information\" ## [1] \"Scoring unique pairs...\" ## [1] \"2025-12-01 11:58:26 CST\" ## [1] \"All is done! Number of paired clones:\" ##  ## madhype  tshell  ##   13379    7311 ## Key: <wi, wj, wij> ##           wi    wj   wij                                     alpha_nuc ##        <num> <num> <num>                                        <char> ##     1:     0     0     3             TGTGTGAGAGCCGGAGGCTTCAAAACTATCTTT ##     2:     0     0     3             TGTGTGAGAGCCGGAGGCTTCAAAACTATCTTT ##     3:     0     0     3    TGTGCAATGAGAAATCGTAGTTCCGGGTATGCACTCAACTTC ##     4:     0     0     3       TGTGCTCTGAGCCATACTGGAGGCTTCAAAACTATCTTT ##     5:     0     0     3    TGTGCTCTAATCCGCAATTCAGGAAACACACCTCTTGTCTTT ##    ---                                                                 ## 20686:    92     0    38                   TGTGGGGGTTACCAGAAAGTTACCTTT ## 20687:    94     0    42 TGTGCTCTTGGGGAAAGGATGGACAGCTGGGGGAAATTGCAGTTT ## 20688:    97     0    56       TGTGCTCTAGAACCTGGTGGCTACAATAAGCTGATTTTT ## 20689:    98     0    49    TGTGCAATGAGTGCATCAGGAGGAAGCTACATACCTACATTT ## 20690:   101     0    53          TGTGCTCTTTACAGCAGTGCTTCCAAGATAATCTTT ##                                                    beta_nuc    wa    wb ##                                                      <char> <int> <int> ##     1:           TGCAGTGCTACATCTCGGAGAGAGCCCTACGAGCAGTACTTC     3     3 ##     2:        TGCGCCAGCAGCCCCGTCTGACGAATTGGAAACACCATATATTTT     3     3 ##     3:           TGTGCCAGCAGTGAGACAGGGCTCTCCTACGAGCAGTACTTC     3     3 ##     4:              TGTGCCAGCAGCCATGATGGCTCCTACGAGCAGTACTTC     3     3 ##     5:     TGTGCCAGCAGCTCCGGCGAAAGAAGGTCCTACAATGAGCAGTTCTTC     3     3 ##    ---                                                                  ## 20686:       TGTGCCAGTAGTATCAACGGTTACTCCCCCGGGGAGCTGTTTTTTT   130    38 ## 20687: TGTGCCAGCAGTTACACGTCCGTGGGGCGCAGCGGTGAAAAACTGTTTTTTT   136    42 ## 20688:         TGTGCCATCAGTGACGATGCCACCCCCAAGAGACCCAGTACTTC   153    56 ## 20689:           TGTGCAAGTCGCCTAGGACTAGCGGGAGAGACCCAGTACTTC   147    49 ## 20690:  TGCGCCAGCAGCTTGGTTCCCTCGGACAGGGCCAATCAGCCCCAGCACTTT   154    53 ##                                        alpha_nuc_seq ##                                               <char> ##     1:             TGTGTGAGAGCCGGAGGCTTCAAAACTATCTTT ##     2:             TGTGTGAGAGCCGGAGGCTTCAAAACTATCTTT ##     3:    TGTGCAATGAGAAATCGTAGTTCCGGGTATGCACTCAACTTC ##     4:       TGTGCTCTGAGCCATACTGGAGGCTTCAAAACTATCTTT ##     5:    TGTGCTCTAATCCGCAATTCAGGAAACACACCTCTTGTCTTT ##    ---                                               ## 20686:                   TGTGGGGGTTACCAGAAAGTTACCTTT ## 20687: TGTGCTCTTGGGGAAAGGATGGACAGCTGGGGGAAATTGCAGTTT ## 20688:       TGTGCTCTAGAACCTGGTGGCTACAATAAGCTGATTTTT ## 20689:    TGTGCAATGAGTGCATCAGGAGGAAGCTACATACCTACATTT ## 20690:          TGTGCTCTTTACAGCAGTGCTTCCAAGATAATCTTT ##                                                beta_nuc_seq ##                                                      <char> ##     1:           TGCAGTGCTACATCTCGGAGAGAGCCCTACGAGCAGTACTTC ##     2:        TGCGCCAGCAGCCCCGTCTGACGAATTGGAAACACCATATATTTT ##     3:           TGTGCCAGCAGTGAGACAGGGCTCTCCTACGAGCAGTACTTC ##     4:              TGTGCCAGCAGCCATGATGGCTCCTACGAGCAGTACTTC ##     5:     TGTGCCAGCAGCTCCGGCGAAAGAAGGTCCTACAATGAGCAGTTCTTC ##    ---                                                      ## 20686:       TGTGCCAGTAGTATCAACGGTTACTCCCCCGGGGAGCTGTTTTTTT ## 20687: TGTGCCAGCAGTTACACGTCCGTGGGGCGCAGCGGTGAAAAACTGTTTTTTT ## 20688:         TGTGCCATCAGTGACGATGCCACCCCCAAGAGACCCAGTACTTC ## 20689:           TGTGCAAGTCGCCTAGGACTAGCGGGAGAGACCCAGTACTTC ## 20690:  TGCGCCAGCAGCTTGGTTCCCTCGGACAGGGCCAATCAGCCCCAGCACTTT ##                                                                                                alpha_beta ##                                                                                                    <char> ##     1:                       TGTGTGAGAGCCGGAGGCTTCAAAACTATCTTT_TGCAGTGCTACATCTCGGAGAGAGCCCTACGAGCAGTACTTC ##     2:                    TGTGTGAGAGCCGGAGGCTTCAAAACTATCTTT_TGCGCCAGCAGCCCCGTCTGACGAATTGGAAACACCATATATTTT ##     3:              TGTGCAATGAGAAATCGTAGTTCCGGGTATGCACTCAACTTC_TGTGCCAGCAGTGAGACAGGGCTCTCCTACGAGCAGTACTTC ##     4:                    TGTGCTCTGAGCCATACTGGAGGCTTCAAAACTATCTTT_TGTGCCAGCAGCCATGATGGCTCCTACGAGCAGTACTTC ##     5:        TGTGCTCTAATCCGCAATTCAGGAAACACACCTCTTGTCTTT_TGTGCCAGCAGCTCCGGCGAAAGAAGGTCCTACAATGAGCAGTTCTTC ##    ---                                                                                                    ## 20686:                         TGTGGGGGTTACCAGAAAGTTACCTTT_TGTGCCAGTAGTATCAACGGTTACTCCCCCGGGGAGCTGTTTTTTT ## 20687: TGTGCTCTTGGGGAAAGGATGGACAGCTGGGGGAAATTGCAGTTT_TGTGCCAGCAGTTACACGTCCGTGGGGCGCAGCGGTGAAAAACTGTTTTTTT ## 20688:               TGTGCTCTAGAACCTGGTGGCTACAATAAGCTGATTTTT_TGTGCCATCAGTGACGATGCCACCCCCAAGAGACCCAGTACTTC ## 20689:              TGTGCAATGAGTGCATCAGGAGGAAGCTACATACCTACATTT_TGTGCAAGTCGCCTAGGACTAGCGGGAGAGACCCAGTACTTC ## 20690:           TGTGCTCTTTACAGCAGTGCTTCCAAGATAATCTTT_TGCGCCAGCAGCTTGGTTCCCTCGGACAGGGCCAATCAGCCCCAGCACTTT ##         method     r    ts  pval pval_adj loss_a_frac loss_b_frac     score ##         <char> <num> <num> <num>    <num>       <num>       <num>     <num> ##     1: madhype    NA    NA    NA       NA           0   0.0000000 0.6184880 ##     2: madhype    NA    NA    NA       NA           0   0.0000000 0.6184880 ##     3: madhype    NA    NA    NA       NA           0   0.0000000 0.6184880 ##     4: madhype    NA    NA    NA       NA           0   0.0000000 0.6184880 ##     5: madhype    NA    NA    NA       NA           0   0.0000000 0.6184880 ##    ---                                                                      ## 20686: madhype    NA    NA    NA       NA           0   0.7076923 1.8528944 ## 20687: madhype    NA    NA    NA       NA           0   0.6911765 1.7626683 ## 20688: madhype    NA    NA    NA       NA           0   0.6339869 1.1176341 ## 20689: madhype    NA    NA    NA       NA           0   0.6666667 1.1736806 ## 20690: madhype    NA    NA    NA       NA           0   0.6558442 0.5082625 ##                  cdr3a         va     ja              cdr3b       vb      jb ##                 <char>     <char> <char>             <char>   <char>  <char> ##     1:     CVRAGGFKTIF   TRAV12-1  TRAJ9     CSATSRREPYEQYF TRBV20-1 TRBJ2-7 ##     2:     CVRAGGFKTIF   TRAV12-1  TRAJ9    CASSPV*RIGNTIYF  TRBV5-1 TRBJ1-3 ##     3:  CAMRNRSSGYALNF TRAV14/DV4 TRAJ41     CASSETGLSYEQYF TRBV25-1 TRBJ2-7 ##     4:   CALSHTGGFKTIF    TRAV9-2  TRAJ9      CASSHDGSYEQYF  TRBV3-1 TRBJ2-7 ##     5:  CALIRNSGNTPLVF     TRAV16 TRAJ29   CASSSGERRSYNEQFF  TRBV5-4 TRBJ2-1 ##    ---                                                                       ## 20686:       CGGYQKVTF   TRAV12-3 TRAJ13   CASSINGY_PPGSCFF   TRBV19 TRBJ2-2 ## 20687: CALGERMDSWGKLQF      TRDV1 TRAJ24 CASSYTSVG_AAVKNCFF  TRBV6-6 TRBJ1-4 ## 20688:   CALEPGGYNKLIF      TRAV6  TRAJ4    CAISDDA_PQETQYF TRBV10-3 TRBJ2-5 ## 20689:  CAMSASGGSYIPTF TRAV14/DV4  TRAJ6     CASRLGLAGETQYF TRBV12-2 TRBJ2-5 ## 20690:    CALYSSASKIIF      TRAV6  TRAJ3  CASSLVPSDRANQPQHF  TRBV5-1 TRBJ1-5 run_pairing(folder_path = tp2, folder_out = save_folder, prefix = \"exp3_tp2_cd8\", well_filter_thres = 0.5,             well_pos = 3, wellset1 = cd8_wells) ## [1] \"start\" ## [1] \"2025-12-01 11:58:27 CST\" ## [1] \"Folder already exists: ~/git/TIRTLtools/extra/exp3_cd8\" ## [1] \"384 TCRalpha well files loaded\" ## [1] \"384 TCRalpha well files loaded\" ## [1] \"2025-12-01 11:58:48 CST\" ## [1] \"Clone threshold for QC:\" ## [1] 3844 ## [1] \"Alpha wells passing QC:\" ##  ## FALSE  TRUE  ##   193   191  ## [1] \"Beta wells passing QC:\" ##  ## FALSE  TRUE  ##   193   191  ## [1] \"Tabulating TCRalpha pseudobulk counts\" ## [1] \"2025-12-01 11:58:48 CST\" ## [1] \"Tabulating TCRbeta pseudobulk counts\" ## [1] \"2025-12-01 11:59:15 CST\" ## [1] \"Pseudobulk done.\" ## [1] \"2025-12-01 11:59:36 CST\" ## [1] \"Merging alpha clonesets...\" ## [1] \"Done! Unique alpha clones and wells after filtering:\" ## [1] 980522    191 ## [1] \"2025-12-01 11:59:37 CST\" ## [1] \"Unique alpha clones and wells in more than: 2 wells\" ## [1] 58954   191 ## [1] \"Done! beta clones and wells after filtering:\" ## [1] 895688    191 ## [1] \"2025-12-01 11:59:38 CST\" ## [1] \"Unique beta clones and wells in more than: 2 wells\" ## [1] 56637   191 ## [1] \"2025-12-01 11:59:38 CST\" ## [1] \"Pre-computing look-up table:\" ##   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100% ## [1] \"2025-12-01 11:59:41 CST\" ## [1] \"Filtering results, adding amino acid and V segment information\" ## [1] \"Scoring unique pairs...\" ## [1] \"2025-12-01 12:00:27 CST\" ## [1] \"All is done! Number of paired clones:\" ##  ## madhype  tshell  ##   16369    9891 ## Key: <wi, wj, wij> ##           wi    wj   wij                                           alpha_nuc ##        <num> <num> <num>                                              <char> ##     1:     0     0     3       TGTGCTACGGACGCGGAAACCGGCACTGCCAGTAAACTCACCTTT ##     2:     0     0     3          TGTGCTGTCTTCCTCAAAGCTGCAGGCAACAAGCTAACTTTT ##     3:     0     0     3             TGTGCTCTCCAGGGGAATAACAATGCCAGACTCATGTTT ##     4:     0     0     3          TGTGCTCTCCTCCTTGTTTCAGATGGCCAGAAGCTGCTCTTT ##     5:     0     0     3          TGTGCTGTGAGTCAGAAGAACAGAGATGACAAGATCATCTTT ##    ---                                                                       ## 26256:    95     0    36                TGCATCCTGAGAGAAGGGGGGAGTGACATGCGCTTT ## 26257:    97     0    31       TGTGCCGTCCTCTGGGGGGTTTCAGGAAACACACCTCTTGTCTTT ## 26258:    97     0    51                TGTGCAGAGAGGGGTGGAGGCTTCAAAACTATCTTT ## 26259:    97     0    53 TGTGTTGTGAGTGGCTTTATACTCACGGGAGGAGGAAACAAACTCACCTTT ## 26260:    98     0    46       TGTGCTCTGAGTGAGGCGAATTCAGATGGCCAGAAGCTGCTCTTT ##                                                        beta_nuc    wa    wb ##                                                          <char> <int> <int> ##     1:         TGTGCCAGCAGCGTAGCTCTGTCAGGGGGCTTCTATGGCTACACCTTC     3     3 ##     2:           TGTGCCAGCAGCTTAGACGTCAGGGGCAGACACTGAAGCTTTCTTT     3     3 ##     3:      TGCGCCAGCAGCTTGGCCGGAGTTCACAGGACCACAGATACGCAGTATTTT     3     3 ##     4:      TGCGCCAGCAGCTTGGCCGGAGTTCACAGGACCACAGATACGCAGTATTTT     3     3 ##     5:                  TGCAGCGTCCGACTAGCGGGAGAAACCGAGCAGTACTTC     3     3 ##    ---                                                                      ## 26256:            TGTGCCAGCAGCTTATGGGGGGGGGGGGACACTGAAGCTTTCTTT   131    36 ## 26257:       TGTGCCAGCAGTCCCCTCCCATGGGGGATGACACAGATACGCAGTATTTT   128    31 ## 26258:            TGCGCCAGCAGCTTGCGGGACCAGCCCTACAACGAGCAGTTCTTC   148    51 ## 26259: TGTGCCAGCAGCCAAGAAGGACTAGCGGGGGGGCCTACACCGGGGAGCTGTTTTTT   150    53 ## 26260:                 TGTGCCAGCAGTTTTTTGGGAGAACAATGAGCAGTTCTTC   144    46 ##                                              alpha_nuc_seq ##                                                     <char> ##     1:       TGTGCTACGGACGCGGAAACCGGCACTGCCAGTAAACTCACCTTT ##     2:          TGTGCTGTCTTCCTCAAAGCTGCAGGCAACAAGCTAACTTTT ##     3:             TGTGCTCTCCAGGGGAATAACAATGCCAGACTCATGTTT ##     4:          TGTGCTCTCCTCCTTGTTTCAGATGGCCAGAAGCTGCTCTTT ##     5:          TGTGCTGTGAGTCAGAAGAACAGAGATGACAAGATCATCTTT ##    ---                                                     ## 26256:                TGCATCCTGAGAGAAGGGGGGAGTGACATGCGCTTT ## 26257:       TGTGCCGTCCTCTGGGGGGTTTCAGGAAACACACCTCTTGTCTTT ## 26258:                TGTGCAGAGAGGGGTGGAGGCTTCAAAACTATCTTT ## 26259: TGTGTTGTGAGTGGCTTTATACTCACGGGAGGAGGAAACAAACTCACCTTT ## 26260:       TGTGCTCTGAGTGAGGCGAATTCAGATGGCCAGAAGCTGCTCTTT ##                                                    beta_nuc_seq ##                                                          <char> ##     1:         TGTGCCAGCAGCGTAGCTCTGTCAGGGGGCTTCTATGGCTACACCTTC ##     2:           TGTGCCAGCAGCTTAGACGTCAGGGGCAGACACTGAAGCTTTCTTT ##     3:      TGCGCCAGCAGCTTGGCCGGAGTTCACAGGACCACAGATACGCAGTATTTT ##     4:      TGCGCCAGCAGCTTGGCCGGAGTTCACAGGACCACAGATACGCAGTATTTT ##     5:                  TGCAGCGTCCGACTAGCGGGAGAAACCGAGCAGTACTTC ##    ---                                                          ## 26256:            TGTGCCAGCAGCTTATGGGGGGGGGGGGACACTGAAGCTTTCTTT ## 26257:       TGTGCCAGCAGTCCCCTCCCATGGGGGATGACACAGATACGCAGTATTTT ## 26258:            TGCGCCAGCAGCTTGCGGGACCAGCCCTACAACGAGCAGTTCTTC ## 26259: TGTGCCAGCAGCCAAGAAGGACTAGCGGGGGGGCCTACACCGGGGAGCTGTTTTTT ## 26260:                 TGTGCCAGCAGTTTTTTGGGAGAACAATGAGCAGTTCTTC ##                                                                                                          alpha_beta ##                                                                                                              <char> ##     1:               TGTGCTACGGACGCGGAAACCGGCACTGCCAGTAAACTCACCTTT_TGTGCCAGCAGCGTAGCTCTGTCAGGGGGCTTCTATGGCTACACCTTC ##     2:                    TGTGCTGTCTTCCTCAAAGCTGCAGGCAACAAGCTAACTTTT_TGTGCCAGCAGCTTAGACGTCAGGGGCAGACACTGAAGCTTTCTTT ##     3:                  TGTGCTCTCCAGGGGAATAACAATGCCAGACTCATGTTT_TGCGCCAGCAGCTTGGCCGGAGTTCACAGGACCACAGATACGCAGTATTTT ##     4:               TGTGCTCTCCTCCTTGTTTCAGATGGCCAGAAGCTGCTCTTT_TGCGCCAGCAGCTTGGCCGGAGTTCACAGGACCACAGATACGCAGTATTTT ##     5:                           TGTGCTGTGAGTCAGAAGAACAGAGATGACAAGATCATCTTT_TGCAGCGTCCGACTAGCGGGAGAAACCGAGCAGTACTTC ##    ---                                                                                                              ## 26256:                           TGCATCCTGAGAGAAGGGGGGAGTGACATGCGCTTT_TGTGCCAGCAGCTTATGGGGGGGGGGGGACACTGAAGCTTTCTTT ## 26257:             TGTGCCGTCCTCTGGGGGGTTTCAGGAAACACACCTCTTGTCTTT_TGTGCCAGCAGTCCCCTCCCATGGGGGATGACACAGATACGCAGTATTTT ## 26258:                           TGTGCAGAGAGGGGTGGAGGCTTCAAAACTATCTTT_TGCGCCAGCAGCTTGCGGGACCAGCCCTACAACGAGCAGTTCTTC ## 26259: TGTGTTGTGAGTGGCTTTATACTCACGGGAGGAGGAAACAAACTCACCTTT_TGTGCCAGCAGCCAAGAAGGACTAGCGGGGGGGCCTACACCGGGGAGCTGTTTTTT ## 26260:                       TGTGCTCTGAGTGAGGCGAATTCAGATGGCCAGAAGCTGCTCTTT_TGTGCCAGCAGTTTTTTGGGAGAACAATGAGCAGTTCTTC ##         method     r    ts  pval pval_adj loss_a_frac loss_b_frac    score ##         <char> <num> <num> <num>    <num>       <num>       <num>    <num> ##     1: madhype    NA    NA    NA       NA           0   0.0000000 0.417523 ##     2: madhype    NA    NA    NA       NA           0   0.0000000 0.417523 ##     3: madhype    NA    NA    NA       NA           0   0.0000000 0.417523 ##     4: madhype    NA    NA    NA       NA           0   0.0000000 0.417523 ##     5: madhype    NA    NA    NA       NA           0   0.0000000 0.417523 ##    ---                                                                     ## 26256: madhype    NA    NA    NA       NA           0   0.7251908 1.073628 ## 26257: madhype    NA    NA    NA       NA           0   0.7578125 0.388667 ## 26258: madhype    NA    NA    NA       NA           0   0.6554054 1.113315 ## 26259: madhype    NA    NA    NA       NA           0   0.6466667 1.052812 ## 26260: madhype    NA    NA    NA       NA           0   0.6805556 0.990934 ##                    cdr3a       va     ja               cdr3b       vb      jb ##                   <char>   <char> <char>              <char>   <char>  <char> ##     1:   CATDAETGTASKLTF   TRAV17 TRAJ44    CASSVALSGGFYGYTF    TRBV9 TRBJ1-2 ##     2:    CAVFLKAAGNKLTF    TRAV3 TRAJ17    CASSLDVR_ADTEAFF TRBV11-2 TRBJ1-1 ##     3:     CALQGNNNARLMF   TRAV21 TRAJ31   CASSLAGVHRTTDTQYF  TRBV5-1 TRBJ2-3 ##     4:    CALLLVSDGQKLLF    TRAV6 TRAJ16   CASSLAGVHRTTDTQYF  TRBV5-1 TRBJ2-3 ##     5:    CAVSQKNRDDKIIF  TRAV8-6 TRAJ30       CSVRLAGETEQYF TRBV29-1 TRBJ2-7 ##    ---                                                                        ## 26256:      CILREGGSDMRF TRAV26-2 TRAJ43     CASSLWGGGDTEAFF  TRBV7-2 TRBJ1-1 ## 26257:   CAVLWGVSGNTPLVF TRAV12-2 TRAJ29   CASSPLPW_DDTDTQYF TRBV12-3 TRBJ2-3 ## 26258:      CAERGGGFKTIF    TRAV5  TRAJ9     CASSLRDQPYNEQFF  TRBV5-1 TRBJ2-1 ## 26259: CVVSGFILTGGGNKLTF  TRAV8-2 TRAJ10 CASSQEGLA_GAYTGELFF  TRBV3-1 TRBJ2-2 ## 26260:   CALSEANSDGQKLLF   TRAV19 TRAJ16      CASSFLG_NNEQFF   TRBV28 TRBJ2-1 run_pairing(folder_path = tp3, folder_out = save_folder, prefix = \"exp3_tp3_cd8\", well_filter_thres = 0.5,             well_pos = 3, wellset1 = cd8_wells) ## [1] \"start\" ## [1] \"2025-12-01 12:00:27 CST\" ## [1] \"Folder already exists: ~/git/TIRTLtools/extra/exp3_cd8\" ## [1] \"384 TCRalpha well files loaded\" ## [1] \"384 TCRalpha well files loaded\" ## [1] \"2025-12-01 12:00:49 CST\" ## [1] \"Clone threshold for QC:\" ## [1] 3036 ## [1] \"Alpha wells passing QC:\" ##  ## FALSE  TRUE  ##   192   192  ## [1] \"Beta wells passing QC:\" ##  ## FALSE  TRUE  ##   192   192  ## [1] \"Tabulating TCRalpha pseudobulk counts\" ## [1] \"2025-12-01 12:00:49 CST\" ## [1] \"Tabulating TCRbeta pseudobulk counts\" ## [1] \"2025-12-01 12:01:12 CST\" ## [1] \"Pseudobulk done.\" ## [1] \"2025-12-01 12:01:32 CST\" ## [1] \"Merging alpha clonesets...\" ## [1] \"Done! Unique alpha clones and wells after filtering:\" ## [1] 850578    192 ## [1] \"2025-12-01 12:01:32 CST\" ## [1] \"Unique alpha clones and wells in more than: 2 wells\" ## [1] 37721   192 ## [1] \"Done! beta clones and wells after filtering:\" ## [1] 830552    192 ## [1] \"2025-12-01 12:01:33 CST\" ## [1] \"Unique beta clones and wells in more than: 2 wells\" ## [1] 38382   192 ## [1] \"2025-12-01 12:01:33 CST\" ## [1] \"Pre-computing look-up table:\" ##   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100% ## [1] \"2025-12-01 12:01:37 CST\" ## [1] \"Filtering results, adding amino acid and V segment information\" ## [1] \"Scoring unique pairs...\" ## [1] \"2025-12-01 12:02:05 CST\" ## [1] \"All is done! Number of paired clones:\" ##  ## madhype  tshell  ##   13076    7474 ## Key: <wi, wj, wij> ##           wi    wj   wij                                     alpha_nuc ##        <num> <num> <num>                                        <char> ##     1:     0     0     3    TGTGCCGTGGGCCTTACCGGCACTGCCAGTAAACTCACCTTT ##     2:     0     0     3                            TTCGACAGACTCATGTTT ##     3:     0     0     3          TGTGCTGTGACCAATGGGGCAGGCAAATCAACCTTT ##     4:     0     0     3          TGTGCTGTGACCAATGGGGCAGGCAAATCAACCTTT ##     5:     0     0     3                TGTGCCGCTGTTAACAATGACATGCGCTTT ##    ---                                                                 ## 20546:    94     0    37 TGTGCCGTGGAGGGGGAGTCTGGTGGCTACAATAAGCTGATTTTT ## 20547:    96     0    50          TGTGCCCCCATGGATAGCAACTATCAGTTAATCTGG ## 20548:    97     0    36 TGCGCTGTGAGAGATAGGGACACCAATGCAGGCAAATCAACCTTT ## 20549:   101     0    36             TGTGCAGACGGCCCCCAAGGAAATCTCATCTTT ## 20550:   103     0    46    TGCGGCACAGAGAGTGGAGGTAGCAACTATAAACTGACATTT ##                                                beta_nuc    wa    wb ##                                                  <char> <int> <int> ##     1:             TGTGCCAGCAGGGGAAACAATCAGCCCCAGCATTTT     3     3 ##     2:       TGTGCCAGCAGTGCCGCACCAGCAAACACTGAAGCTTTCTTT     3     3 ##     3: TGCGCCAGCAGCCAAGGGGGGGGGGGGGACCAAGAGACCCAGTACTTC     3     3 ##     4:  TGCGCCAGCAGCCAAGGGGGGGGGGGGACCAAGAGACCCAGTACTTC     3     3 ##     5:             TGTGCCAGCAGTGAAAACTCCTACGAGCAGTACTTC     3     3 ##    ---                                                              ## 20546:   TGTGCCAGCAGCGCCCACGGGGAAGGGAACGAAAAACTGTTTTTTT   131    37 ## 20547:      TGCAGTGCTAAATTAGCGGGCGACACCGGGGAGCTGTTTTTTT   146    50 ## 20548:      TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC   133    36 ## 20549:      TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC   137    36 ## 20550:          TGTGCCAGCAGCTGGGACAAAACCTACGAGCAGTACTTC   149    46 ##                                        alpha_nuc_seq ##                                               <char> ##     1:    TGTGCCGTGGGCCTTACCGGCACTGCCAGTAAACTCACCTTT ##     2:                            TTCGACAGACTCATGTTT ##     3:          TGTGCTGTGACCAATGGGGCAGGCAAATCAACCTTT ##     4:          TGTGCTGTGACCAATGGGGCAGGCAAATCAACCTTT ##     5:                TGTGCCGCTGTTAACAATGACATGCGCTTT ##    ---                                               ## 20546: TGTGCCGTGGAGGGGGAGTCTGGTGGCTACAATAAGCTGATTTTT ## 20547:          TGTGCCCCCATGGATAGCAACTATCAGTTAATCTGG ## 20548: TGCGCTGTGAGAGATAGGGACACCAATGCAGGCAAATCAACCTTT ## 20549:             TGTGCAGACGGCCCCCAAGGAAATCTCATCTTT ## 20550:    TGCGGCACAGAGAGTGGAGGTAGCAACTATAAACTGACATTT ##                                            beta_nuc_seq ##                                                  <char> ##     1:             TGTGCCAGCAGGGGAAACAATCAGCCCCAGCATTTT ##     2:       TGTGCCAGCAGTGCCGCACCAGCAAACACTGAAGCTTTCTTT ##     3: TGCGCCAGCAGCCAAGGGGGGGGGGGGGACCAAGAGACCCAGTACTTC ##     4:  TGCGCCAGCAGCCAAGGGGGGGGGGGGACCAAGAGACCCAGTACTTC ##     5:             TGTGCCAGCAGTGAAAACTCCTACGAGCAGTACTTC ##    ---                                                  ## 20546:   TGTGCCAGCAGCGCCCACGGGGAAGGGAACGAAAAACTGTTTTTTT ## 20547:      TGCAGTGCTAAATTAGCGGGCGACACCGGGGAGCTGTTTTTTT ## 20548:      TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC ## 20549:      TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC ## 20550:          TGTGCCAGCAGCTGGGACAAAACCTACGAGCAGTACTTC ##                                                                                          alpha_beta ##                                                                                              <char> ##     1:              TGTGCCGTGGGCCTTACCGGCACTGCCAGTAAACTCACCTTT_TGTGCCAGCAGGGGAAACAATCAGCCCCAGCATTTT ##     2:                                TTCGACAGACTCATGTTT_TGTGCCAGCAGTGCCGCACCAGCAAACACTGAAGCTTTCTTT ##     3:        TGTGCTGTGACCAATGGGGCAGGCAAATCAACCTTT_TGCGCCAGCAGCCAAGGGGGGGGGGGGGACCAAGAGACCCAGTACTTC ##     4:         TGTGCTGTGACCAATGGGGCAGGCAAATCAACCTTT_TGCGCCAGCAGCCAAGGGGGGGGGGGGACCAAGAGACCCAGTACTTC ##     5:                          TGTGCCGCTGTTAACAATGACATGCGCTTT_TGTGCCAGCAGTGAAAACTCCTACGAGCAGTACTTC ##    ---                                                                                              ## 20546: TGTGCCGTGGAGGGGGAGTCTGGTGGCTACAATAAGCTGATTTTT_TGTGCCAGCAGCGCCCACGGGGAAGGGAACGAAAAACTGTTTTTTT ## 20547:             TGTGCCCCCATGGATAGCAACTATCAGTTAATCTGG_TGCAGTGCTAAATTAGCGGGCGACACCGGGGAGCTGTTTTTTT ## 20548:    TGCGCTGTGAGAGATAGGGACACCAATGCAGGCAAATCAACCTTT_TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC ## 20549:                TGTGCAGACGGCCCCCAAGGAAATCTCATCTTT_TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC ## 20550:           TGCGGCACAGAGAGTGGAGGTAGCAACTATAAACTGACATTT_TGTGCCAGCAGCTGGGACAAAACCTACGAGCAGTACTTC ##         method     r    ts  pval pval_adj loss_a_frac loss_b_frac     score ##         <char> <num> <num> <num>    <num>       <num>       <num>     <num> ##     1: madhype    NA    NA    NA       NA           0   0.0000000 0.6057843 ##     2: madhype    NA    NA    NA       NA           0   0.0000000 0.6057843 ##     3: madhype    NA    NA    NA       NA           0   0.0000000 0.6057843 ##     4: madhype    NA    NA    NA       NA           0   0.0000000 0.6057843 ##     5: madhype    NA    NA    NA       NA           0   0.0000000 0.6057843 ##    ---                                                                      ## 20546: madhype    NA    NA    NA       NA           0   0.7175573 1.5618088 ## 20547: madhype    NA    NA    NA       NA           0   0.6575342 1.6288014 ## 20548: madhype    NA    NA    NA       NA           0   0.7293233 1.0688280 ## 20549: madhype    NA    NA    NA       NA           0   0.7372263 0.5297975 ## 20550: madhype    NA    NA    NA       NA           0   0.6912752 0.4727439 ##                  cdr3a       va     ja            cdr3b       vb      jb ##                 <char>   <char> <char>           <char>   <char>  <char> ##     1:  CAVGLTGTASKLTF   TRAV39 TRAJ44     CASRGNNQPQHF   TRBV27 TRBJ1-5 ##     2:          FDRLMF  TRAV1-1 TRAJ31   CASSAAPANTEAFF  TRBV6-4 TRBJ1-1 ##     3:    CAVTNGAGKSTF  TRAV8-4 TRAJ27 CASSQGGGGDQETQYF  TRBV4-1 TRBJ2-5 ##     4:    CAVTNGAGKSTF  TRAV8-4 TRAJ27 CASSQGGG_DQETQYF  TRBV4-1 TRBJ2-5 ##     5:      CAAVNNDMRF TRAV12-2 TRAJ43     CASSENSYEQYF  TRBV6-1 TRBJ2-7 ##    ---                                                                   ## 20546: CAVEGESGGYNKLIF TRAV12-2  TRAJ4 CASSAHGE_GTKNCFF    TRBV9 TRBJ1-4 ## 20547:    CAPMDSNYQLIW  TRAV1-2 TRAJ33  CSAKLAG_TPGSCFF TRBV20-1 TRBJ2-2 ## 20548: CAVRDRDTNAGKSTF  TRAV1-1 TRAJ27  CASSFCG_AGYEQYF   TRBV28 TRBJ2-7 ## 20549:     CADGPQGNLIF TRAV13-2 TRAJ42  CASSFCG_AGYEQYF   TRBV28 TRBJ2-7 ## 20550:  CGTESGGSNYKLTF   TRAV30 TRAJ53    CASSWDKTYEQYF  TRBV5-1 TRBJ2-7"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/pairing_zenodo_data.html","id":"load-paired-tcr-data","dir":"Articles","previous_headings":"Instructions","what":"Load paired TCR data","title":"TCR-alpha/beta pairing for COVID-19 related TCRs","text":"output call run_pairing() 3 tab-separated text files (.tsv): <sample-name>_TIRTLoutput.tsv(.gz)– Paired TCRs – table computationally paired alpha/beta TCRs <sample-name>_pseudobulk_TRA.tsv(.gz) – Alpha chain “pseudo-bulk” data – table read count summary metrics alpha-chains across wells plate <sample-name>_pseudobulk_TRB.tsv(.gz) – Beta chain “pseudo-bulk” data – table read count summary metrics beta-chains across wells plate load_tirtlseq() function can used load data folder. function loads data “list”, can contain type unstructured data, following structure: list contains two slots. meta - data frame sample metadata data - list data sample Since used <experiment>_<timepoint>_<marker> prefix set output files, add meta_columns argument, function creates data frame sample metadata information.","code":"your_data_object (list) ├───meta (metadata dataframe) └───data (list)     └───sample_1 (list)         ├───alpha (alpha pseudobulk dataframe)         ├───beta (beta pseudobulk dataframe)         └───paired (paired pseudobulk dataframe)     ...     └───sample_n (list)         ├───alpha (alpha pseudobulk dataframe)         ├───beta (beta pseudobulk dataframe)         └───paired (paired pseudobulk dataframe) data = load_tirtlseq(save_folder, sep = \"_\", verbose = FALSE,                      meta_columns = c(\"experiment\", \"timepoint\", \"marker\")) ## Loading files from: ~/git/TIRTLtools/extra/exp3_cd8... ## Found 3 beta chain pseudo-bulk files. ## Found 3 paired chain files. ## Loaded 9 files from 3 samples. ## 3.7 seconds"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/pairing_zenodo_data.html","id":"plot-changes-in-tcr-repertoire-over-time","dir":"Articles","previous_headings":"Instructions","what":"Plot changes in TCR repertoire over time","title":"TCR-alpha/beta pairing for COVID-19 related TCRs","text":"loading data, can use plot_sample_vs_sample() function make scatter plot clone frequencies two samples. can re-create top half Figure 3B paper, showing clone comparisons baseline (pre-infection) acute (6 days post-infection) acute convalescent (29 days post-infection)   Note objects returned plotting functions package almost ggplot objects, can modified functions ggplot2 package theme() function. ggplot2 function loaded default TIRTLtools, available user without specifying ggplot2:: function name. Since figures smaller paper without legend, can re-create .","code":"gg1 = plot_sample_vs_sample(   data$data$exp3_tp1_cd8, data$data$exp3_tp2_cd8,    labelx = \"Frequency at baseline\", labely = \"Frequency at acute\",   log2fc_cutoff = 3,   sem_cutoff = 2.5,   smooth_sem = \"none\"   ) gg2 = plot_sample_vs_sample(   data$data$exp3_tp2_cd8, data$data$exp3_tp3_cd8,    labelx = \"Frequency at acute\", labely = \"Frequency at conv\",   log2fc_cutoff = 3,   sem_cutoff = 2.5,   smooth_sem = \"none\"   ) gg1 ## baseline vs. acute (top left of Fig. 3B) gg2 ## acute vs. convalescent (top right of Fig. 3B) gg1 + theme(legend.position = \"none\") ## baseline vs. acute (top left of Fig. 3B) gg2 + theme(legend.position = \"none\") ## acute vs. convalescent (top right of Fig. 3B)"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/pairing_zenodo_data.html","id":"find-the-number-of-expanded-and-contracted-clones","dir":"Articles","previous_headings":"Instructions","what":"Find the number of expanded and contracted clones","title":"TCR-alpha/beta pairing for COVID-19 related TCRs","text":"can also call function return_data = TRUE get data used create plot, read fractions, log2 fold-change, labels whether clone expanded, contracted, stable. numbers expanded contracted clones match figures paper, small differences due differing quality control settings.","code":"baseline_to_acute_df = plot_sample_vs_sample(data$data$exp3_tp1_cd8, data$data$exp3_tp2_cd8,                                               return_data = TRUE, smooth_sem = \"none\") acute_to_conv_df = plot_sample_vs_sample(data$data$exp3_tp2_cd8, data$data$exp3_tp3_cd8,                                           return_data = TRUE, smooth_sem = \"none\")  baseline_to_acute_df ## Key: <targetSequences, aaSeqCDR3, v, j> ##                                                targetSequences ##                                                         <char> ##     1:                       CACAGCGCCGGGACACCTTATGGCTACACCTTC ##     2:                    CCCGAGCGGCGAGAGATCGGGTTAGAGCAGTACTTC ##     3:                      CCCTACTCACGGGGCTTACACTGAAGCTTTCTTT ##     4:                          CGCAGCAGAGGCGCAGATACGCAGTATTTT ##     5:                       CGCAGCGCCGGAGGGAACACTGAAGCTTTCTTT ##    ---                                                         ## 44269:                TTGTGCTAGTGGTTCTTGGACAGGCAATGAGCAGTTCTTC ## 44270:          TTGTGCTAGTGGTTTGATAGGTCAAAACCCAAATGAGCAGTTCTTC ## 44271: TTGTGCTAGTGGTTTGGTGACTAGCGGGAGGGCGGACACCGGGGAGCTGTTTTTT ## 44272:                    TTTGCCAGTAGTGTTGGCAGAACTGGCTACACCTTC ## 44273:                    TTTGCCGCGGGACTAGCGGGTCGGGAGCAGTACTTC ##                  aaSeqCDR3        v       j readCount.x n_wells.x ##                     <char>   <char>  <char>       <num>     <num> ##     1:         HSAGTPYGYTF TRBV29-1 TRBJ1-2           0         0 ##     2:        PERREIGLEQYF   TRBV19 TRBJ2-7           0         0 ##     3:        PYSRGL_TEAFF   TRBV30 TRBJ1-1         258        11 ##     4:          RSRGADTQYF TRBV20-1 TRBJ2-3          18         5 ##     5:         RSAGGNTEAFF TRBV29-1 TRBJ1-1           0         0 ##    ---                                                            ## 44269:      LC*WFLD_GNEQFF TRBV12-5 TRBJ2-1         148        16 ## 44270:    LC*WFDRS_NPNEQFF TRBV12-5 TRBJ2-1           0         0 ## 44271: LC*WFGD*R_RADTGELFF TRBV12-5 TRBJ2-2           0         0 ## 44272:        FASSVGRTGYTF   TRBV19 TRBJ1-2           0         0 ## 44273:        FAAGLAGREQYF  TRBV4-2 TRBJ2-7         144        13 ##        readCount_max.x readCount_median.x        sem.x readFraction.x ##                  <num>              <num>        <num>          <num> ##     1:               0                  0 5.627777e-06   0.000000e+00 ##     2:               0                  0 5.627777e-06   0.000000e+00 ##     3:              37                 24 8.155221e-07   2.623903e-06 ##     4:               7                  4 9.325517e-08   1.830630e-07 ##     5:               0                  0 5.627777e-06   0.000000e+00 ##    ---                                                                ## 44269:              28                  9 3.981132e-07   1.505185e-06 ## 44270:               0                  0 5.627777e-06   0.000000e+00 ## 44271:               0                  0 5.627777e-06   0.000000e+00 ## 44272:               0                  0 5.627777e-06   0.000000e+00 ## 44273:              21                 11 3.998983e-07   1.464504e-06 ##        max_wells.x        avg.x readCount.y n_wells.y readCount_max.y ##              <num>        <num>       <num>     <num>           <num> ##     1:           0 0.000000e+00           8         6               2 ##     2:           0 0.000000e+00         159        17              20 ##     3:         191 2.623903e-06          48         6              11 ##     4:         191 1.830630e-07           4         1               4 ##     5:           0 0.000000e+00          36         6               9 ##    ---                                                                ## 44269:         191 1.505185e-06          64        15               7 ## 44270:           0 0.000000e+00          23         5               7 ## 44271:           0 0.000000e+00         108        25              14 ## 44272:           0 0.000000e+00         288        13              31 ## 44273:         191 1.464504e-06          11         2               7 ##        readCount_median.y        sem.y readFraction.y max_wells.y        avg.y ##                     <num>        <num>          <num>       <num>        <num> ##     1:                1.0 3.870094e-08   1.000851e-07         191 1.000851e-07 ##     2:                9.0 5.352627e-07   1.989191e-06         191 1.989191e-06 ##     3:                9.0 2.728054e-07   6.005106e-07         191 6.005106e-07 ##     4:                4.0 2.211298e-06   5.004255e-08         191 5.004255e-08 ##     5:                7.0 2.013660e-07   4.503830e-07         191 4.503830e-07 ##    ---                                                                         ## 44269:                5.0 2.237762e-07   8.006808e-07         191 8.006808e-07 ## 44270:                4.0 1.475716e-07   2.877447e-07         191 2.877447e-07 ## 44271:                4.0 2.984159e-07   1.351149e-06         191 1.351149e-06 ## 44272:               22.0 1.009929e-06   3.603064e-06         191 3.603064e-06 ## 44273:                5.5 2.211298e-06   1.376170e-07         191 1.376170e-07 ##            log2FC   sign ##             <num> <char> ##     1:  0.1376151 stable ##     2:  1.5797553 stable ##     3: -1.1790120 stable ##     4: -0.1720791 stable ##     5:  0.5364339 stable ##    ---                   ## 44269: -0.4763744 stable ## 44270:  0.3648466 stable ## 44271:  1.2333659 stable ## 44272:  2.2025944 stable ## 44273: -1.1152823 stable acute_to_conv_df ## Key: <targetSequences, aaSeqCDR3, v, j> ##                                                targetSequences ##                                                         <char> ##     1:                       CACAGCGCCGGGACACCTTATGGCTACACCTTC ##     2:                    CCCGAGCGGCGAGAGATCGGGTTAGAGCAGTACTTC ##     3:                      CCCTACTCACGGGGCTTACACTGAAGCTTTCTTT ##     4:                    CGCAGCCCCCAGGAGGGAGGCTATGGCTACACCTTC ##     5:                       CGCAGCGCCGGAGGGAACACTGAAGCTTTCTTT ##    ---                                                         ## 43622:                TTGTGCTAGTGGTTCTTGGACAGGCAATGAGCAGTTCTTC ## 43623:          TTGTGCTAGTGGTTTGATAGGTCAAAACCCAAATGAGCAGTTCTTC ## 43624: TTGTGCTAGTGGTTTGGTGACTAGCGGGAGGGCGGACACCGGGGAGCTGTTTTTT ## 43625:                 TTTAGCGGCAAGGGATGGTGGAATCAGCCCCAGCATTTT ## 43626:                    TTTGCCAGTAGTGTTGGCAGAACTGGCTACACCTTC ##                  aaSeqCDR3        v       j readCount.x n_wells.x ##                     <char>   <char>  <char>       <num>     <num> ##     1:         HSAGTPYGYTF TRBV29-1 TRBJ1-2           8         6 ##     2:        PERREIGLEQYF   TRBV19 TRBJ2-7         159        17 ##     3:        PYSRGL_TEAFF   TRBV30 TRBJ1-1          48         6 ##     4:        RSPQEGGYGYTF TRBV29-1 TRBJ1-2           8         3 ##     5:         RSAGGNTEAFF TRBV29-1 TRBJ1-1          36         6 ##    ---                                                            ## 43622:      LC*WFLD_GNEQFF TRBV12-5 TRBJ2-1          64        15 ## 43623:    LC*WFDRS_NPNEQFF TRBV12-5 TRBJ2-1          23         5 ## 43624: LC*WFGD*R_RADTGELFF TRBV12-5 TRBJ2-2         108        25 ## 43625:       FSGKGWWNQPQHF   TRBV14 TRBJ1-5           0         0 ## 43626:        FASSVGRTGYTF   TRBV19 TRBJ1-2         288        13 ##        readCount_max.x readCount_median.x        sem.x readFraction.x ##                  <num>              <num>        <num>          <num> ##     1:               2                  1 3.870094e-08   1.000851e-07 ##     2:              20                  9 5.352627e-07   1.989191e-06 ##     3:              11                  9 2.728054e-07   6.005106e-07 ##     4:               5                  2 8.333671e-08   1.000851e-07 ##     5:               9                  7 2.013660e-07   4.503830e-07 ##    ---                                                                ## 43622:               7                  5 2.237762e-07   8.006808e-07 ## 43623:               7                  4 1.475716e-07   2.877447e-07 ## 43624:              14                  4 2.984159e-07   1.351149e-06 ## 43625:               0                  0 2.134084e-06   0.000000e+00 ## 43626:              31                 22 1.009929e-06   3.603064e-06 ##        max_wells.x        avg.x readCount.y n_wells.y readCount_max.y ##              <num>        <num>       <num>     <num>           <num> ##     1:         191 1.000851e-07           0         0               0 ##     2:         191 1.989191e-06           0         0               0 ##     3:         191 6.005106e-07          70         2              35 ##     4:         191 1.000851e-07          14         6               3 ##     5:         191 4.503830e-07          15         3              12 ##    ---                                                                ## 43622:         191 8.006808e-07         146        19              16 ## 43623:         191 2.877447e-07          25         4              10 ## 43624:         191 1.351149e-06          79        14              10 ## 43625:           0 0.000000e+00          95         8              18 ## 43626:         191 3.603064e-06         290        14              32 ##        readCount_median.y        sem.y readFraction.y max_wells.y        avg.y ##                     <num>        <num>          <num>       <num>        <num> ##     1:                0.0 3.884462e-06   0.000000e+00           0 0.000000e+00 ##     2:                0.0 3.884462e-06   0.000000e+00           0 0.000000e+00 ##     3:               35.0 3.884462e-06   8.434052e-07         192 8.434052e-07 ##     4:                2.0 6.673244e-08   1.686810e-07         192 1.686810e-07 ##     5:                2.0 1.446004e-07   1.807297e-07         192 1.807297e-07 ##    ---                                                                         ## 43622:                7.0 4.064522e-07   1.759102e-06         192 1.759102e-06 ## 43623:                5.0 1.979693e-07   3.012161e-07         192 3.012161e-07 ## 43624:                5.0 2.602906e-07   9.518430e-07         192 9.518430e-07 ## 43625:               11.5 3.799922e-07   1.144621e-06         192 1.144621e-06 ## 43626:               18.5 9.497320e-07   3.494107e-06         192 3.494107e-06 ##             log2FC   sign ##              <num> <char> ##     1: -0.13761513 stable ##     2: -1.57975527 stable ##     3:  0.20384100 stable ##     4:  0.08726611 stable ##     5: -0.29675516 stable ##    ---                    ## 43622:  0.61565649 stable ## 43623:  0.01501407 stable ## 43624: -0.26852885 stable ## 43625:  1.10072296 stable ## 43626: -0.03455981 stable table(baseline_to_acute_df$sign) ##  ##   down stable     up  ##    113  43180    980 table(acute_to_conv_df$sign) ##  ##   down stable     up  ##    321  43197    108"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/plot_examples.html","id":"load-the-package","dir":"Articles","previous_headings":"","what":"Load the package","title":"Plot examples with SJTRC COVID-19 data","text":"","code":"library(TIRTLtools) library(magrittr) library(dplyr)"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/plot_examples.html","id":"load-the-sjtrc-covid-19-data","dir":"Articles","previous_headings":"","what":"Load the SJTRC COVID-19 data","title":"Plot examples with SJTRC COVID-19 data","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\", package = \"TIRTLtools\") dir(folder) ##  [1] \"cd4_tp1_v2_pseudobulk_TRA.tsv.gz\" \"cd4_tp1_v2_pseudobulk_TRB.tsv.gz\" ##  [3] \"cd4_tp1_v2_TIRTLoutput.tsv.gz\"    \"cd4_tp2_v2_pseudobulk_TRA.tsv.gz\" ##  [5] \"cd4_tp2_v2_pseudobulk_TRB.tsv.gz\" \"cd4_tp2_v2_TIRTLoutput.tsv.gz\"    ##  [7] \"cd4_tp3_v2_pseudobulk_TRA.tsv.gz\" \"cd4_tp3_v2_pseudobulk_TRB.tsv.gz\" ##  [9] \"cd4_tp3_v2_TIRTLoutput.tsv.gz\"    \"cd8_tp1_v2_pseudobulk_TRA.tsv.gz\" ## [11] \"cd8_tp1_v2_pseudobulk_TRB.tsv.gz\" \"cd8_tp1_v2_TIRTLoutput.tsv.gz\"    ## [13] \"cd8_tp2_v2_pseudobulk_TRA.tsv.gz\" \"cd8_tp2_v2_pseudobulk_TRB.tsv.gz\" ## [15] \"cd8_tp2_v2_TIRTLoutput.tsv.gz\"    \"cd8_tp3_v2_pseudobulk_TRA.tsv.gz\" ## [17] \"cd8_tp3_v2_pseudobulk_TRB.tsv.gz\" \"cd8_tp3_v2_TIRTLoutput.tsv.gz\" sjtrc = load_tirtlseq(folder, meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\")"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/plot_examples.html","id":"process-the-data","dir":"Articles","previous_headings":"","what":"Process the data","title":"Plot examples with SJTRC COVID-19 data","text":"initially load data, data frames lack information needed plotting functions. TIRTL_process() function runs 3 package functions add information data frames: add_single_chain_data() - adds single-chain read counts/fractions paired TCR data frames identify_paired() - adds column pseudobulk data indicating single-chains paired identify_non_functional_seqs() - adds columns paired data frames indicating whether CDR3A/B amino acid sequences functional (containing stop codons frameshifts) clean = TRUE specified, clean_pairs() function also run preceding functions. function removes excess pairs alpha beta chains. Biologically, expect alpha paired one beta beta paired two alphas clone. use clean = FALSE show data looks -.","code":"sjtrc = TIRTL_process(sjtrc, clean = FALSE) ## Adding single-chain data to paired dataframe for sample 1 ## Adding single-chain data to paired dataframe for sample 2 ## Adding single-chain data to paired dataframe for sample 3 ## Adding single-chain data to paired dataframe for sample 4 ## Adding single-chain data to paired dataframe for sample 5 ## Adding single-chain data to paired dataframe for sample 6 ##  ## Annotating data with pairing status by MAD-HYPE and T-SHELL algorithms for sample 1 ## Annotating data with pairing status by MAD-HYPE and T-SHELL algorithms for sample 2 ## Annotating data with pairing status by MAD-HYPE and T-SHELL algorithms for sample 3 ## Annotating data with pairing status by MAD-HYPE and T-SHELL algorithms for sample 4 ## Annotating data with pairing status by MAD-HYPE and T-SHELL algorithms for sample 5 ## Annotating data with pairing status by MAD-HYPE and T-SHELL algorithms for sample 6"},{"path":"https://nicholasclark.github.io/TIRTLtools/articles/plot_examples.html","id":"longitudinal-plots-for-individual-tcrs-or-groups-of-tcrs","dir":"Articles","previous_headings":"","what":"Longitudinal plots for individual TCRs or groups of TCRs","title":"Plot examples with SJTRC COVID-19 data","text":"CD8-selected T-cells, get nucleotide sequences 5 frequent beta chains timepoints 1 2 show frequencies across samples timepoints. can see highly frequent CD8 timepoint 3, CD4 samples.  can also plot proportion reads occupied 10 frequent clones, top 100, 1000, etc sample. can see top CD8 clones occupy repertoire CD4 counterparts.  good robust measure repertoire diversity number clones needed make half total reads (d50). higher d50 means less clonal repertoire lower d50 means repertoire dominated small number clones. see CD8 repertoire clonal CD4 timepoint 2 clonal. package offers large number diversity metrics, including Simpson, inverse Simpson, Shannon, richness, etc. full list available metrics, run get_all_div_metrics(). can also plot total number alpha beta chain reads sample.  can also check many alpha beta chains paired sample algorithm.  quality control purposes, chains paired, can plot many partners assigned. expect alpha chains one beta chain partner beta chains two alpha chain partners. Higher numbers partners indicative problems pairing. Sometimes extra partners indicate mispairings sometimes sequencing/PCR errors true partner.  can also check percentage chains paired within read fraction range. expect good pairing highly frequent chains worse pairing rare chains. see beta chains frequent one ten-thousand (0.0001, darkest three bars) paired well samples. rarer chains, fraction paired drops almost none chains one--one-hundred-thousand one--one-million range (light green, [1e-06,1e-05]) paired.  might expect algorithms (least T-SHELL) able pair majority frequent clones. can check often pairing algorithms fail top clones stepped line-chart tracks many top clones fail pair given sample. CD8 sample timepoint 1, see T-SHELL algorithm able pair almost top 100 clones, MAD-HYPE algorithm able pair half. expected since MAD-HYPE calls pairs based occurrence patterns therefore difficult time pairing clones found almost wells. Another way visualize pairing top clones plot rank left right read fraction y-axis, points colored pairing status. , unpaired clones shown green dots cross. Clones paired T-SHELL algorithm shown yellow. can see T-SHELL works well frequent clones MAD-HYPE algorithm trouble clones frequent one thousand (10^-3). might also expect frequent alpha clones paired frequent beta clones vice versa. next plot shows information last one, alpha beta clones graph (top alpha clones flipped left side). Lines alpha clones (left) beta clones (right) indicate pairs. can see top 100 alpha clones partner top 100 beta clones, makes sense.  can also plot rank versus read fraction clones compare shapes curves among samples. can see frequent beta chains CD4 samples frequency around 1 1000 (10^-3) frequent clones CD8 samples frequency 1%.  another quality control check, can plot many top clones sample shared samples. plot overlap top 200 clones sample see significant sharing within CD4 CD8 samples, , expected.  may also want find whether clones expanding contracting -timepoints. , CD8 clones expanding timepoint 1 2 shown orange contracting shown green.","code":"top_clones1 = sjtrc$data$cd8_tp1_v2$beta %>% arrange(desc(readFraction)) %>% head(5) %>% extract2(\"targetSequences\") %>% as.character() top_clones2 = sjtrc$data$cd8_tp2_v2$beta %>% arrange(desc(readFraction)) %>% head(5) %>% extract2(\"targetSequences\") %>% as.character()  plot_clone_size_across_samples(sjtrc, clones = c(top_clones1, top_clones2), chain = \"beta\") plot_clonotype_indices(sjtrc, chain = \"beta\") div = calculate_diversity(sjtrc, chain = \"beta\", metrics = \"d50\") ##  ## -- Calculating diversity indices for sample 1 of 6. ## -- Calculating diversity indices for sample 2 of 6. ## -- Calculating diversity indices for sample 3 of 6. ## -- Calculating diversity indices for sample 4 of 6. ## -- Calculating diversity indices for sample 5 of 6. ## -- Calculating diversity indices for sample 6 of 6. plot_diversity(div, metric = \"d50\") get_all_div_metrics() ##  [1] \"simpson\"        \"gini\"           \"gini.simpson\"   \"inv.simpson\"    ##  [5] \"shannon\"        \"berger.parker\"  \"richness\"       \"d50\"            ##  [9] \"dXX\"            \"renyi\"          \"hill\"           \"top10fraction\"  ## [13] \"top100fraction\" \"topNfraction\" plot_n_reads(sjtrc) plot_paired(sjtrc) plot_num_partners(sjtrc) plot_paired_by_read_fraction_range(sjtrc, chain = \"beta\") plot_paired_vs_rank(sjtrc, sample = 4) plot_read_fraction_vs_pair_status(sjtrc, sample = 4) plot_pairs_with_eachother(sjtrc, sample = 1) plot_ranks(sjtrc, chain = \"beta\") plot_sample_overlap(sjtrc, chain = \"beta\") plot_sample_vs_sample(sjtrc$data$cd8_tp1_v2, sjtrc$data$cd8_tp2_v2, chain = \"beta\")"},{"path":"https://nicholasclark.github.io/TIRTLtools/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Nicholas Clark. Author, maintainer. Mikhail Pogorelyy. Author.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Clark N, Pogorelyy M (2025). TIRTLtools: Analysis Tools TIRTLseq Data. R package version 0.1.8, https://nicholasclark.github.io/TIRTLtools/.","code":"@Manual{,   title = {TIRTLtools: Analysis Tools for TIRTLseq Data},   author = {Nicholas Clark and Mikhail Pogorelyy},   year = {2025},   note = {R package version 0.1.8},   url = {https://nicholasclark.github.io/TIRTLtools/}, }"},{"path":"https://nicholasclark.github.io/TIRTLtools/index.html","id":"tirtltools-r-package","dir":"","previous_headings":"","what":"Analysis Tools for TIRTLseq Data","title":"Analysis Tools for TIRTLseq Data","text":"Package active development may change frequently.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/index.html","id":"news","dir":"","previous_headings":"","what":"News","title":"Analysis Tools for TIRTLseq Data","text":"Nov. 24th 2025 TIRTLseq assay paper published Nature Methods: TIRTL-seq: deep, quantitative affordable paired TCR repertoire sequencing.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/index.html","id":"documentation-and-usage-instructions","dir":"","previous_headings":"","what":"Documentation and usage instructions","title":"Analysis Tools for TIRTLseq Data","text":"Installation instructions Reference manual Tutorials vignettes","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Analysis Tools for TIRTLseq Data","text":"TIRTLtools software package analyzing T-cell receptor (TCR) repertoires created using TIRTL-seq (Throughput-Intensive Rapid TCR Library sequencing) (Pogorelyy Kirk et al., Nature Methods 2025). provide functions analysis paired TCR repertoires well single-chain bulk TCR-sequencing data. addition various analysis plotting functions, provide efficient batched GPU implementation TCRdist (Dash et al., Nature 2017) works NVIDIA Apple Silicon GPUs. testing, able calculate pairwise TCRdist repertoire ~1 million TCRs hours using MacBook Pro (16-core GPU, M4 Pro).","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/index.html","id":"the-tirtlseq-assay","dir":"","previous_headings":"","what":"The TIRTLseq assay","title":"Analysis Tools for TIRTLseq Data","text":"T-cell receptor (TCR), allows adaptive immune response, made two separate protein chains, TCR-alpha TCR-beta. Bulk single-chain TCR-sequencing allows cost-effective -depth TCR-repertoire profiling, provide chain pairings, essential determining T-cell specificity. Single-cell TCR sequencing can produce paired chain data, much expensive thus limited thousands cells total cost-prohibitive cohort-scale studies. TIRTL-seq novel assay (published Nov. 2025) can rapidly economically sequence single-chain TCRs millions human T-cells produce paired TCR-sequencing information tens thousands T cell clones per sample fraction cost single-cell sequencing. Cells split across wells 384-well 96-well plates 2,500 25,000 cells per well alpha/beta TCR chains sequenced simultaneously well. Computational algorithms based chain co-occurrence correlation chain frequency used identify alpha/beta chain pairs derive T-cell clone. simple new algorithm (T-SHELL) allows effective pairing abundant clones, frustrated previous algorithms. Along paired TCR information, single-chain read frequency can used identify expanded clones one sample well track clone expansions contractions longitudinally across samples.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Analysis Tools for TIRTLseq Data","text":"details pairing pipeline, see TIRTLseq paper (Pogorelyy Kirk et al., Nature Methods 2025) github repository. details MAD-HYPE algorithm, see Holec Berleant et al., 2019. details MiXCR, see website publications Nature Methods (2015) Nature Biotechnology (2017). details TCRdist, see Dash et al., Nature 2017","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TCRdist.html","id":null,"dir":"Reference","previous_headings":"","what":"GPU implementation of TCRdist, a distance/similarity metric for pairs of TCRs — TCRdist","title":"GPU implementation of TCRdist, a distance/similarity metric for pairs of TCRs — TCRdist","text":"efficient, batched version TCRdist compatible NVIDIA Apple Silicon GPUs.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TCRdist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GPU implementation of TCRdist, a distance/similarity metric for pairs of TCRs — TCRdist","text":"","code":"TCRdist(   tcr1,   tcr2 = NULL,   remove_MAIT = FALSE,   params = NULL,   submat = NULL,   tcrdist_cutoff = 90,   chunk_size = 1000,   print_chunk_size = 10,   print_res = TRUE,   only_lower_tri = TRUE,   return_data = TRUE,   write_to_tsv = FALSE,   backend = c(\"auto\", \"cpu\", \"cupy\", \"mlx\"),   fork = NULL,   shared = NULL )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TCRdist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GPU implementation of TCRdist, a distance/similarity metric for pairs of TCRs — TCRdist","text":"tcr1 data frame one TCR per row. must columns \"va\", \"vb\", \"cdr3a\", \"cdr3b\" tcr2 (optional) another data frame TCRs. supplied, TCRdist calculated every combination one TCR tcr1 one TCR tcr2. Otherwise, calculate TCRdist every pair TCRs tcr1. remove_MAIT whether remove TCRs MAIT cells (default FALSE) params (optional) table valid parameters amino acids va/vb segments. (default NULL, uses TIRTLtools::params) submat (optional) substitution matrix mismatch penalties combination amino acids va/vb segments (default NULL, uses TIRTLtools::submat). tcrdist_cutoff (optional) discard TCRdist values cutoff (default 90). chunk_size (optional) chunk size use calculation TCRdist (default 1000). set n, calculate pairwise TCRdist n x n TCRs . may high allowable GPU memory (testing, chunk_size 1000 5000 provided fastest runtime chunk_size 7500 resulted memory errors GPUs). print_chunk_size (optional) print line output every n TCRs processed (default 1000) print_res (optional) print summary results (default TRUE) only_lower_tri (optional) return one TCRdist value pair (like lower triangle symmetric matrix). Default TRUE. return_data (optional) whether return output result function. large data may desirable write result disk instead. (default TRUE, returns output) write_to_tsv (optional) write results tab-separated file \".tsv\" (default FALSE, write .tsv file) backend (optional) CPU GPU backend use (default \"auto\") fork (optional) TRUE/FALSE value whether \"fork\" new Python process running TCRdist via \"basilisk\" package. Default NULL, use choose safe value based package loaded. shared (optional) TRUE/FALSE value whether \"share\" Python process running TCRdist via \"basilisk\" package. Default NULL, use choose safe value based package loaded.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TCRdist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GPU implementation of TCRdist, a distance/similarity metric for pairs of TCRs — TCRdist","text":"list entries: $TCRdist_df - data frame three columns: \"node1_0index\", \"node2_0index\", \"TCRdist\". first two columns contain indices (0-indexed) TCRs pair. last column contains TCRdist cutoff. output sparse contains pairs TCRdist <= cutoff. $tcr1 - data frame TCRs supplied function. contains additional column \"tcr_index\" (0-indexed) index TCR. $tcr2 - similar data frame tcr2, supplied.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TCRdist.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"GPU implementation of TCRdist, a distance/similarity metric for pairs of TCRs — TCRdist","text":"function calculates pairwise TCRdist (Dash et al., Nature 2017) set TCRs (two sets TCRs) returns sparse output TCRdist indices pairs TCRdist less equal desired cutoff (default cutoff 90). function uses reticulate package call python script uses cupy (NVIDIA GPUs), mlx (Apple Silicon GPUs), numpy (GPU) calculate TCRdist efficiently.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TCRdist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"GPU implementation of TCRdist, a distance/similarity metric for pairs of TCRs — TCRdist","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTLseq_minimal\",   package = \"TIRTLtools\") sjtrc = load_tirtlseq(folder,   meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\",   chain = \"paired\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTLseq_minimal... #> Found 2 beta chain pseudo-bulk files. #> Found 2 paired chain files. #> Loaded 2 files from 2 samples. #> 0.1 seconds df = get_all_tcrs(sjtrc, chain=\"paired\", remove_duplicates = TRUE) result = TCRdist(df, tcrdist_cutoff = 90) #> Removed 384 TCRs with unknown V-segments (1.2%) from a total of 32,164 TCRs. #> Removed 12 TCRs with short CDR3 segments (0.038%) from a total of 31,780 TCRs. #> Removed 13,324 TCRs with non-functional CDR3 amino acid sequences (42%) from a total of 31,768 TCRs. #> Filtered data frame contains 18,444 TCRs (57%) of original 32,164 TCRs. edge_df = result[['TCRdist_df']] %>%   data.table::as.data.table() ### table of TCRdist values <= cutoff node_df = result[['tcr1']] %>%   data.table::as.data.table() ### table of input data with indices  edge_df ## sparse 3-column output: node1, node2, TCRdist #>        node1_0index node2_0index TCRdist #>               <int>        <int>   <int> #>     1:          158          157       0 #>     2:          286          284      84 #>     3:          287          283      89 #>     4:          288          284      89 #>     5:          289          285      89 #>    ---                                   #> 18422:        18434        18073       0 #> 18423:        18437        18406      72 #> 18424:        18440        18241      90 #> 18425:        18440        18324      66 #> 18426:        18440        18422      84 ## note that indices start at 0 and are found in node_df$tcr_index  node_df %>%   select(tcr_index, everything()) %>%   mutate(alpha_nuc = paste(substr(alpha_nuc, 0, 20), \"...\", sep = \"\"),          beta_nuc = paste(substr(beta_nuc, 0, 20), \"...\", sep = \"\")) #> Error in mutate(., alpha_nuc = paste(substr(alpha_nuc, 0, 20), \"...\",     sep = \"\"), beta_nuc = paste(substr(beta_nuc, 0, 20), \"...\",     sep = \"\")): could not find function \"mutate\""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TCRdist_cpp.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallelized C++ implementation of TCRdist (no GPU required) — TCRdist_cpp","title":"Parallelized C++ implementation of TCRdist (no GPU required) — TCRdist_cpp","text":"alternative GPU version TCRdist still fast large datasets (tens thousands TCRs). written C++ run parallel across available CPU cores.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TCRdist_cpp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallelized C++ implementation of TCRdist (no GPU required) — TCRdist_cpp","text":"","code":"TCRdist_cpp(tcr1, tcr2 = NULL)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TCRdist_cpp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallelized C++ implementation of TCRdist (no GPU required) — TCRdist_cpp","text":"tcr1 data frame one TCR per row. must columns \"va\", \"vb\", \"cdr3a\", \"cdr3b\" tcr2 (optional) another data frame TCRs. supplied, TCRdist calculated every combination one TCR tcr1 one TCR tcr2. Otherwise, calculate TCRdist every pair TCRs tcr1.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TCRdist_cpp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallelized C++ implementation of TCRdist (no GPU required) — TCRdist_cpp","text":"list two objects (three tcr2 null): matrix - matrix TCRdist values tcr1 - input matrix tcr1, pre-processing removing unacceptable TCRs tcr2 (supplied) - input matrix tcr2, pre-processing removing unacceptable TCRs","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TCRdist_cpp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Parallelized C++ implementation of TCRdist (no GPU required) — TCRdist_cpp","text":"version TCRdist currently less feature-rich TCRdist() returns dense matrix output. yet allow sparse output writing output directly file.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TCRdist_cpp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parallelized C++ implementation of TCRdist (no GPU required) — TCRdist_cpp","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTLseq_minimal\",   package = \"TIRTLtools\") sjtrc = load_tirtlseq(folder,   meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\",   chain = \"paired\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTLseq_minimal... #> Found 2 beta chain pseudo-bulk files. #> Found 2 paired chain files. #> Loaded 2 files from 2 samples. #> 0.2 seconds df = get_all_tcrs(sjtrc, chain=\"paired\", remove_duplicates = TRUE)  result = TCRdist_cpp(df) #> Removed 384 TCRs with unknown V-segments (1.2%) from a total of 32,164 TCRs. #> Removed 12 TCRs with short CDR3 segments (0.038%) from a total of 31,780 TCRs. #> Removed 13,324 TCRs with non-functional CDR3 amino acid sequences (42%) from a total of 31,768 TCRs. #> Removed 812 MAIT TCRs (4.4%) from a total of 18,444 TCRs. #> Filtered data frame contains 17,632 TCRs (55%) of original 32,164 TCRs. #> Removed 384 TCRs with unknown V-segments (1.2%) from a total of 32,164 TCRs. #> Removed 12 TCRs with short CDR3 segments (0.038%) from a total of 31,780 TCRs. #> Removed 13,324 TCRs with non-functional CDR3 amino acid sequences (42%) from a total of 31,768 TCRs. #> Removed 812 MAIT TCRs (4.4%) from a total of 18,444 TCRs. #> Filtered data frame contains 17,632 TCRs (55%) of original 32,164 TCRs.  mat = result$matrix node_df = result$tcr1  mat[1:5,1:5] #>      [,1] [,2] [,3] [,4] [,5] #> [1,]   NA   NA   NA   NA   NA #> [2,]  338   NA   NA   NA   NA #> [3,]  287  270   NA   NA   NA #> [4,]  374  320  293   NA   NA #> [5,]  382  372  386  387   NA ## note: TCRdist is symmetric. Returned matrix contains only lower-triangular values  node_df %>%   mutate(alpha_nuc = paste(substr(alpha_nuc, 0, 20), \"...\", sep = \"\"),          beta_nuc = paste(substr(beta_nuc, 0, 20), \"...\", sep = \"\")) %>%   data.table::as.data.table() #> Error in mutate(., alpha_nuc = paste(substr(alpha_nuc, 0, 20), \"...\",     sep = \"\"), beta_nuc = paste(substr(beta_nuc, 0, 20), \"...\",     sep = \"\")): could not find function \"mutate\""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TIRTL_process.html","id":null,"dir":"Reference","previous_headings":"","what":"Run data processing functions on a TIRTLseqDataSet object — TIRTL_process","title":"Run data processing functions on a TIRTLseqDataSet object — TIRTL_process","text":"function runs annotation data cleaning functions TIRTLseqDataSet object. Specifically, calls functions add_single_chain_data(), identify_paired(), identify_non_functional_seqs(), (optionally) clean_pairs().","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TIRTL_process.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run data processing functions on a TIRTLseqDataSet object — TIRTL_process","text":"","code":"TIRTL_process(data, clean = FALSE, remove_nonfunctional = FALSE)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TIRTL_process.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run data processing functions on a TIRTLseqDataSet object — TIRTL_process","text":"data TIRTLseqDataSet object clean (optional) TRUE/FALSE value, whether \"clean\" paired data removing excess pairs individual alpha beta chains (default FALSE). remove_nonfunctional whether remove non-functional TCR chains (default FALSE)","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TIRTL_process.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run data processing functions on a TIRTLseqDataSet object — TIRTL_process","text":"TIRTLseqDataSet object annotated (optionally) cleaned data","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TIRTLtools-package.html","id":null,"dir":"Reference","previous_headings":"","what":"TIRTLtools: Analysis Tools for TIRTLseq Data — TIRTLtools-package","title":"TIRTLtools: Analysis Tools for TIRTLseq Data — TIRTLtools-package","text":"suite tools analyzing paired T-cell receptor (TCR) datasets created using TIRTL-seq assay. Contains efficient GPU implementation TCRdist (Dash et al., Nature 2017).","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/TIRTLtools-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"TIRTLtools: Analysis Tools for TIRTLseq Data — TIRTLtools-package","text":"Maintainer: Nicholas Clark nicholas.clark00@gmail.com Authors: Mikhail Pogorelyy mpogorel@fredhutch.org","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/add_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Add metadata to a TIRTLseqDataSet object — add_metadata","title":"Add metadata to a TIRTLseqDataSet object — add_metadata","text":"function adds metadata data frame, obj$meta, input TIRTLseqDataSet object based sample names. can useful metadata specified initial object loaded.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/add_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add metadata to a TIRTLseqDataSet object — add_metadata","text":"","code":"add_metadata(obj, meta_columns = NULL, sep = \"_\")"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/add_metadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add metadata to a TIRTLseqDataSet object — add_metadata","text":"obj TIRTLseqDataSet object meta_columns (optional) vector names metadata field sample names. sep (optional) character separating fields sample names data example c(\"marker\", \"timepoint\", \"donor\") samples named something like \"cd8_timepoint2_donor1\".","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/add_metadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add metadata to a TIRTLseqDataSet object — add_metadata","text":"TIRTLseqDataSet object added metadata","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/add_single_chain_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Add single-chain read counts/fractions to the paired TCR data — add_single_chain_data","title":"Add single-chain read counts/fractions to the paired TCR data — add_single_chain_data","text":"add_single_chain_data() function adds read counts proportions single-chain pseudobulk data paired data frame sample dataset.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/add_single_chain_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add single-chain read counts/fractions to the paired TCR data — add_single_chain_data","text":"","code":"add_single_chain_data(data, verbose = TRUE)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/add_single_chain_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add single-chain read counts/fractions to the paired TCR data — add_single_chain_data","text":"data TIRTLseq dataset created load_tirtlseq() verbose (optional) whether print progress function (default TRUE).","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/add_single_chain_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add single-chain read counts/fractions to the paired TCR data — add_single_chain_data","text":"TIRTLseq dataset object paired data frames sample added columns read counts proportions single-chain pseudobulk data.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/calculate_diversity.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate TCR repertoire diversity metrics — calculate_diversity","title":"Calculate TCR repertoire diversity metrics — calculate_diversity","text":"calculate_diversity() returns number clonal diversity measures (e.g. Hill numbers, Shannon Simpson indices) calculated supplied data.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/calculate_diversity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate TCR repertoire diversity metrics — calculate_diversity","text":"","code":"calculate_diversity(   data,   chain = c(\"beta\", \"alpha\"),   metrics = get_all_div_metrics(),   samples = NULL,   q = 0:6,   percent = seq(10, 90, 10),   n = 10 )  diversity(...)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/calculate_diversity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate TCR repertoire diversity metrics — calculate_diversity","text":"data TIRTLseqDataSet object chain chain use calculating metrics, alpha beta (default \"beta\") metrics diversity indices metrics calculate. samples samples calculate diversity metrics (default NULL, samples) q vector integers specifying \"orders\" calculate Hill numbers Renyi entropy. percent percentage (100) vector percentages use calculating dXX values, .e. minimum number clones needed cover XX percent sample. n number frequent clones use topNfraction metric.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/calculate_diversity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate TCR repertoire diversity metrics — calculate_diversity","text":"returns list requested indices. \"simpson\", \"gini\", \"gini.simpson\", \"inv.simpson\", \"shannon\", \"berger.parker\", \"richness\" return vector length one. \"d50\" \"dXX\" return data frame minimum number clones needed make 50 (XX) percent data, percentage (50 XX) supplied, actual percentage data made clones. \"dXX\" may return data frame many rows supplied vector percentages. \"renyi\" \"hill\" return data frame two columns, row contains value Hill (Renyi) number order 'q', contains value corresponding 'q'. return data frame many rows supplied vector orders (e.g. 1:5).","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/calculate_diversity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate TCR repertoire diversity metrics — calculate_diversity","text":"function calculates following diversity indices: simpson - Simpson diversity index (https://en.wikipedia.org/wiki/Diversity_index#Simpson_index). equals probability two entities taken random dataset represent type. inverse Hill number order 2. gini - Gini index/coefficient (https://en.wikipedia.org/wiki/Gini_coefficient). gini.simpson - Gini-Simpson index (https://en.wikipedia.org/wiki/Diversity_index#Gini%E2%80%93Simpson_index). Equal 1-Simpson_index. equals probability two entities taken random dataset represent different types. inv.simpson - Inverse-Simpson index - .e. reciprocal Simpson index, measures effective number types weighted arithmetic mean used calculate diversity. equivalent Hill number order 2. (https://en.wikipedia.org/wiki/Diversity_index#Inverse_Simpson_index) shannon - Shannon diversity index, also known Shannon-Wiener index Shannon entropy. equivalent Renyi entropy 'q' = 1. (https://en.wikipedia.org/wiki/Diversity_index#Shannon_index) berger.parker - Berger-Parker index, .e. proportion abundant type dataset. (https://en.wikipedia.org/wiki/Diversity_index#Berger%E2%80%93Parker_index) richness - species richness, .e. total number unique types observed data (https://en.wikipedia.org/wiki/Diversity_index#Richness). d50 - minimum number types (clones) needed comprise 50 percent data. dXX - minimum number types (clones) needed comprise XX percent data. renyi - Renyi entropy, generalization Shannon diversity/entropy values 'q' 1. formula Renyi entropy undefined q=1, defined limit, equals Shannon entropy. q=0, simply natural logarithm richness total number types. q=Inf, defined limit, equal negative natural logarithm proportion abundant type. (https://en.wikipedia.org/wiki/Diversity_index#R%C3%A9nyi_entropy) hill - Hill numbers order q, also known true diversity effective number types. number equally abundant types needed average proportional abundance types equal observed dataset. order 'q' defines exponent used formula define 'generalized mean' proportional abundances. q = 2 corresponds arithmetic mean (https://en.wikipedia.org/wiki/Arithmetic_mean). q = 1 corresponds geometric mean (https://en.wikipedia.org/wiki/Geometric_mean). q = 0 corresponds harmonic mean (https://en.wikipedia.org/wiki/Harmonic_mean). q = Inf, defined limit, inverse proportion abundant type. general, q increases, less weight given rarer species. (https://en.wikipedia.org/wiki/Diversity_index#Effective_number_of_species_or_Hill_numbers)","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/calculate_diversity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate TCR repertoire diversity metrics — calculate_diversity","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\",   package = \"TIRTLtools\") sjtrc = load_tirtlseq(folder,   meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\",   verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 17.6 seconds  div = calculate_diversity(sjtrc, chain = \"beta\", metrics = \"d50\") #>  #> -- Calculating diversity indices for sample 1 of 6. #> -- Calculating diversity indices for sample 2 of 6. #> -- Calculating diversity indices for sample 3 of 6. #> -- Calculating diversity indices for sample 4 of 6. #> -- Calculating diversity indices for sample 5 of 6. #> -- Calculating diversity indices for sample 6 of 6. plot_diversity(div, metric = \"d50\")"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/clean_pairs.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove excess pairs for individual single chains — clean_pairs","title":"Remove excess pairs for individual single chains — clean_pairs","text":"function filters paired TCR data, keeping one beta-chain partner individual alpha-chain two alpha-chain partners individual beta-chain.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/clean_pairs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove excess pairs for individual single chains — clean_pairs","text":"","code":"clean_pairs(   data,   n_max_alpha = 2,   n_max_beta = 1,   prefer_functional = TRUE,   verbose = TRUE )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/clean_pairs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove excess pairs for individual single chains — clean_pairs","text":"data TIRTLseqDataSet object n_max_alpha (optional) maximum number alpha chains allowed paired individual beta chain (default 2) n_max_beta (optional) maximum number beta chains allowed paired individual alpha chain (default 1) prefer_functional (optional) TRUE, prefer functional non-functional chains even less frequent verbose (optional) whether print progress function (default TRUE).","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/clean_pairs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove excess pairs for individual single chains — clean_pairs","text":"Returns TIRTLseqDataSet object excess pairs removed.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/clean_pairs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Remove excess pairs for individual single chains — clean_pairs","text":"Excess partners individual chain often sequencing errors true partner. sequencing error-derived chains often share V/J segment true partner, found much lower read fractions. heuristic, mitigate phenomenon, unique beta chain group partner alpha chains V/J segments keep alpha chains highest read fraction group. remaining alpha chain partners, keep two chains (can changed n_max_alpha) highest read fractions. go similar process unique alpha chain, grouping partner beta chains V/J segments. However, keep one beta chain (can changed n_max_beta).","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/cluster_tcrs.html","id":null,"dir":"Reference","previous_headings":"","what":"Cluster TCRs (using the Leiden algorithm) based on their pairwise TCRdist values — cluster_tcrs","title":"Cluster TCRs (using the Leiden algorithm) based on their pairwise TCRdist values — cluster_tcrs","text":"cluster_tcrs() function aggregates paired TCRs found data, calculates pairwise similarity using va, vb, cdr3a, cdr3b regions (via TCRdist), clusters results using Leiden algorithm.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/cluster_tcrs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cluster TCRs (using the Leiden algorithm) based on their pairwise TCRdist values — cluster_tcrs","text":"","code":"cluster_tcrs(   data,   tcrdist_cutoff = 90,   resolution = 0.1,   with_db = TRUE,   db = TIRTLtools::vdj_db,   allow_self_edges = TRUE,   remove_MAIT = TRUE )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/cluster_tcrs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cluster TCRs (using the Leiden algorithm) based on their pairwise TCRdist values — cluster_tcrs","text":"data list TIRTLseq TCR data samples created load_tirtlseq() tcrdist_cutoff TCRdist() function record TCRdist values less equal cutoff. Default 90. Note: Higher cutoffs return data, NxN N number unique TCRs. resolution \"resolution\" parameter Leiden algorithm. lower value produce larger clusters higher value produce smaller clusters. Typical values 0.1 - 2.0 range. higher value may better densely connected data lower value may better moderately connected data. Default 0.1. with_db TRUE, observed clones compared clustered dataframe annotated clones. default, dataframe VDJ-db annotations used. db data frame annotated TCRs. default VDJ-db database. allow_self_edges FALSE, calculate TCRdist input data TCRs TCR annotation database (db). TRUE, calculate pairwise TCRdist data including input annotated TCRs. remove_MAIT remove MAIT TCRs clustering (default TRUE)","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/cluster_tcrs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cluster TCRs (using the Leiden algorithm) based on their pairwise TCRdist values — cluster_tcrs","text":"Returns list following elements: $df - data frame unique TCRs along cluster annotations $dist_df - data frame distances (TCRdist) TCR pairs long format $sparse_adj_mat - adjacency matrix (sparse format) marking TCR pairs TCRdist <= tcrdist_cutoff $graph_adj - igraph object created adjacency matrix $tcrdist_cutoff - cutoff used TCRdist $resolution - resolution parameter used Leiden algorithm","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/cluster_tcrs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cluster TCRs (using the Leiden algorithm) based on their pairwise TCRdist values — cluster_tcrs","text":"function also filters dataset TCRs valid TCRdist. following TCRs removed: TCRs contain stop codons (*) frame shifts (_) cdr3a cdr3b regions TCRs contain cdr3 region 5 less amino acids TCRs contain v segment allele found parameter table V-segments specify allele (e.g. \"TRAV1-2\" instead \"TRAV1-2*01\") assigned \"*01\" allele.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/cluster_tcrs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cluster TCRs (using the Leiden algorithm) based on their pairwise TCRdist values — cluster_tcrs","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTLseq_minimal\",   package = \"TIRTLtools\") sjtrc = load_tirtlseq(folder,   meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\",   chain = \"paired\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTLseq_minimal... #> Found 2 beta chain pseudo-bulk files. #> Found 2 paired chain files. #> Loaded 2 files from 2 samples. #> 0.1 seconds df = get_all_tcrs(sjtrc, chain=\"paired\", remove_duplicates = TRUE)  result = cluster_tcrs(df) #> Removed 1,470 MAIT TCRs (2.5%) from a total of 58,377 TCRs. #> Removed 999 MAIT TCRs (3.1%) from a total of 32,164 TCRs. #> Removed 384 TCRs with unknown V-segments (0.67%) from a total of 56,907 TCRs. #> Removed 12 TCRs with short CDR3 segments (0.021%) from a total of 56,523 TCRs. #> Removed 13,137 TCRs with non-functional CDR3 amino acid sequences (23%) from a total of 56,511 TCRs. #> Filtered data frame contains 43,374 TCRs (76%) of original 56,907 TCRs. #> Out of 43374 valid TCRs, 4914 clusters detected and 28631 singleton TCRs. #> 94 clusters of size >= 10, 7 clusters of size >= 50, 3 clusters of size >=100."},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/create_thimble_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert paired TCRs to a ","title":"Convert paired TCRs to a ","text":"function creates \"thimble\" data frame use Stitchr Python package (https://jamieheather.github.io/stitchr/) stitch together TCR nucleotide coding sequences. resulting data frame can written .tsv write_stitchr_tsv().","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/create_thimble_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert paired TCRs to a ","text":"","code":"create_thimble_df(   df,   preset = c(\"default\", \"none\"),   TCR_names = \"TCR\",   exclude_non_functional = TRUE,   remove_duplicates = TRUE,   verbose = TRUE,   Linker = NULL,   Link_order = NULL,   TRAC = NULL,   TRBC = NULL,   TRA_leader = NULL,   TRB_leader = NULL,   TRA_5_prime_seq = NULL,   TRA_3_prime_seq = NULL,   TRB_5_prime_seq = NULL,   TRB_3_prime_seq = NULL )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/create_thimble_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert paired TCRs to a ","text":"df dataframe paired TCRs. preset preset linker, link order, TRAC/TRBC settings. default (\"default\") setting uses \"T2A\" linker, \"BA\" link order, \"mTRAC\\*01\" TRAC, \"mTRBC2\\*01\" TRBC. TCR_names vector names TCRs. vector length one, TCR names \"<TCR_names>_1\", \"<TCR_names>_2\", ... , \"<TCR_names>_N\". exclude_non_functional whether exclude TCRs non-functional CDR3 sequences (default TRUE). remove_duplicates whether remove duplicate TCRs (default TRUE). verbose whether print messages Linker linker TCRs (default \"T2A\") Link_order link order TCRs (default \"BA\") TRAC TCR alpha chain constant region (default \"mTRAC*01\") TRBC TCR beta chain constant region (default \"mTRBC2*01\") TRA_leader (optional) alternative leader sequence alpha chain. can either specified gene entry pre-programmed IMGT data alternatively simple DNA string can entered (e.g. ‘ATG’ minimal start codon absence leader sequence). TRB_leader (optional) alternative leader sequence beta chain. can either specified gene entry pre-programmed IMGT data alternatively simple DNA string can entered (e.g. ‘ATG’ minimal start codon absence leader sequence). TRA_5_prime_seq Optional arbitrary sequence appended 5’ alpha chain. TRA_3_prime_seq Optional arbitrary sequence appended 3’ alpha chain. TRB_5_prime_seq Optional arbitrary sequence appended 5’ beta chain. TRB_3_prime_seq Optional arbitrary sequence appended 3’ beta chain.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/create_thimble_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert paired TCRs to a ","text":"data frame TCRs properly formatted use Stitchr.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_dataset.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset a TIRTLseqDataSet object — filter_dataset","title":"Subset a TIRTLseqDataSet object — filter_dataset","text":"filter_dataset() function used select subset samples loaded TIRTLseq dataset create new dataset object.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_dataset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset a TIRTLseqDataSet object — filter_dataset","text":"","code":"filter_dataset(data, samples)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_dataset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset a TIRTLseqDataSet object — filter_dataset","text":"data TIRTLseqDataSet object created load_tirtlseq() samples selected samples. Either 1) numeric vector indices, 2) character vector sample names, 3) character vector metadata conditions entry form \"column==value\".","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_dataset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subset a TIRTLseqDataSet object — filter_dataset","text":"dataset object similar created load_tirtlseq(), selected samples.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_dataset.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Subset a TIRTLseqDataSet object — filter_dataset","text":"function accepts 1) numeric vector indices, 2) character vector sample names, 3) character vector metadata conditions entry form \"column==value\". third case, c(\"cell_type==cd4\", \"timepoint==tp2\") , example, select samples whose cell_type cd4 whose timepoint tp2 sample metadata.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_dataset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Subset a TIRTLseqDataSet object — filter_dataset","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\",   package = \"TIRTLtools\") sjtrc = load_tirtlseq(folder,   meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\",   chain = \"paired\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 6 files from 6 samples. #> 0.5 seconds p2 = filter_dataset(sjtrc, 1:3) ### by indices p3 = filter_dataset(sjtrc, c(\"cd8_tp1_v2\", \"cd8_tp2_v2\", \"cd8_tp3_v2\")) ### by sample names p4 = filter_dataset(sjtrc, \"marker==cd4\") ### by sample metadata condition p5 = filter_dataset(sjtrc, c(\"marker==cd4\", \"timepoint==tp2\")) ### by multiple sample metadata conditions"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_duplicate_tcrs.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove duplicate TCRs from a data frame — filter_duplicate_tcrs","title":"Remove duplicate TCRs from a data frame — filter_duplicate_tcrs","text":"default, TIRTLseq pairing scripts write \"paired\" data table one row per pair per pairing algorithm (MAD-HYPE T-SHELL). Thus, pairs identified methods found two rows. function removes duplicates.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_duplicate_tcrs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove duplicate TCRs from a data frame — filter_duplicate_tcrs","text":"","code":"filter_duplicate_tcrs(df, verbose = TRUE)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_duplicate_tcrs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove duplicate TCRs from a data frame — filter_duplicate_tcrs","text":"df data frame paired TCRs verbose whether print number TCRs removed","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_mait.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove MAIT (Mucosal-Associated Invariant T cells) TCRs — filter_mait","title":"Remove MAIT (Mucosal-Associated Invariant T cells) TCRs — filter_mait","text":"function uses heuristic remove TCRs associated MAIT cells, may desired applications. example, creating network related TCRs TCRdist, TCRs often form highly dense sub-network inflates output file size.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_mait.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove MAIT (Mucosal-Associated Invariant T cells) TCRs — filter_mait","text":"","code":"filter_mait(df, verbose = TRUE)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_mait.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove MAIT (Mucosal-Associated Invariant T cells) TCRs — filter_mait","text":"df data frame paired TCRs verbose whether print number MAIT TCRs removed","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_mait.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove MAIT (Mucosal-Associated Invariant T cells) TCRs — filter_mait","text":"data frame MAIT TCRs removed","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_mait.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Remove MAIT (Mucosal-Associated Invariant T cells) TCRs — filter_mait","text":"use heiristic remove TCRs V-alpha TRAV1-2 either J-alpha segment TRAJ33, TRAJ12, TRAJ20 (see Garner et al. 2023 - https://www.nature.com/articles/s41590-023-01575-1).","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_nonfunctional_TCRs.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove TCRs with nonfunctional CDR3 amino acid sequences — filter_nonfunctional_TCRs","title":"Remove TCRs with nonfunctional CDR3 amino acid sequences — filter_nonfunctional_TCRs","text":"function removes TCR pairs CDR3-alpha beta segment make functional protein, .e. amino acid sequence contains stop codon (*) frameshift (_).","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_nonfunctional_TCRs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove TCRs with nonfunctional CDR3 amino acid sequences — filter_nonfunctional_TCRs","text":"","code":"filter_nonfunctional_TCRs(data, verbose = TRUE)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_nonfunctional_TCRs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove TCRs with nonfunctional CDR3 amino acid sequences — filter_nonfunctional_TCRs","text":"data TIRTLseqDataSet object verbose whether print number TCRs removed","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_nonfunctional_TCRs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove TCRs with nonfunctional CDR3 amino acid sequences — filter_nonfunctional_TCRs","text":"Returns TIRTLseqDataSet object nonfunctional TCRs removed.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_short_cdr3s.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove TCRs with short CDR3 loops — filter_short_cdr3s","title":"Remove TCRs with short CDR3 loops — filter_short_cdr3s","text":"function removes TCR pairs CDR3 amino acid segment short. defualt, removes TCRs CDR3-alpha CDR3-beta less 6 amino acids long.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_short_cdr3s.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove TCRs with short CDR3 loops — filter_short_cdr3s","text":"","code":"filter_short_cdr3s(df, verbose = TRUE, min_aa = 6)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_short_cdr3s.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove TCRs with short CDR3 loops — filter_short_cdr3s","text":"df data frame paired TCRs verbose whether print number TCRs removed min_aa minimum number amino acids allowed CDR3 sequence","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_v_alleles.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove TCRs with unknown V-segments — filter_v_alleles","title":"Remove TCRs with unknown V-segments — filter_v_alleles","text":"function removes TCR pairs V-segments found params. needed pre-processing TCRdist() part prep_for_tcrdist(), automatically run TCRdist().","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_v_alleles.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove TCRs with unknown V-segments — filter_v_alleles","text":"","code":"filter_v_alleles(df, params = NULL, verbose = TRUE)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_v_alleles.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove TCRs with unknown V-segments — filter_v_alleles","text":"df data frame paired TCRs params table acceptable V-segments (default TIRTLtools::params) verbose whether print number TCRs removed","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/filter_v_alleles.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove TCRs with unknown V-segments — filter_v_alleles","text":"paired TCR data frame TCRs unknown V-segments removed.","code":""},{"path":[]},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_all_div_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Returns all diversity metric options for calculate_diversity() — get_all_div_metrics","text":"","code":"get_all_div_metrics()"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_all_div_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Returns all diversity metric options for calculate_diversity() — get_all_div_metrics","text":"vector available diversity metrics calculate_diversity() function.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_all_div_metrics.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Returns all diversity metric options for calculate_diversity() — get_all_div_metrics","text":"","code":"# example code get_all_div_metrics() #>  [1] \"simpson\"        \"gini\"           \"gini.simpson\"   \"inv.simpson\"    #>  [5] \"shannon\"        \"berger.parker\"  \"richness\"       \"d50\"            #>  [9] \"dXX\"            \"renyi\"          \"hill\"           \"top10fraction\"  #> [13] \"top100fraction\" \"topNfraction\""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_all_tcrs.html","id":null,"dir":"Reference","previous_headings":"","what":"Returns all of the paired TCRs from all samples in a dataset — get_all_tcrs","title":"Returns all of the paired TCRs from all samples in a dataset — get_all_tcrs","text":"get_all_tcrs() function aggregates TCRs samples dataset puts one table.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_all_tcrs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Returns all of the paired TCRs from all samples in a dataset — get_all_tcrs","text":"","code":"get_all_tcrs(   data,   chain = c(\"paired\", \"alpha\", \"beta\"),   remove_duplicates = TRUE )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_all_tcrs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Returns all of the paired TCRs from all samples in a dataset — get_all_tcrs","text":"data TIRTLseqDataSet object created load_tirtlseq() chain TCR chain, \"alpha\", \"beta\", \"paired\" (default paired) remove_duplicates return one TCR TCRs paired T-SHELL MAD-HYPE algorithms (default TRUE).","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_all_tcrs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Returns all of the paired TCRs from all samples in a dataset — get_all_tcrs","text":"dataframe including TCRs dataset.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_all_tcrs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Returns all of the paired TCRs from all samples in a dataset — get_all_tcrs","text":"pair TCRs included twice TIRTLseq data recognized T-SHELL MAD-HYPE algorithms. remove_duplicates TRUE (default) function return one pairs TCRs.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_all_tcrs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Returns all of the paired TCRs from all samples in a dataset — get_all_tcrs","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\", package = \"TIRTLtools\") ts_data = load_tirtlseq(folder, meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 15.9 seconds  get_all_tcrs(ts_data, chain = \"paired\") #>            wi    wj   wij                                        alpha_nuc #>         <int> <int> <int>                                           <char> #>      1:     0     0     3          TGTGCCGTGAACGGAGGTAACGACTACAAGCTCAGCTTT #>      2:     0     0     3       TGTGCTCTTCAAACTTCTGGTGGCTACAATAAGCTGATTTTT #>      3:     0     0     3             TGTGCTCCCCGGTACACCGGTAACCAGTTCTATTTT #>      4:     0     0     3 TGTGCAATGAGAGAGGTCGCTTCTGGTGGCTACAATAAGCTGATTTTT #>      5:     0     0     3             TGTGCTGCCAGCGGGGGCTTTCAGAAACTTGTATTT #>     ---                                                                    #> 165667:    94     0    37    TGTGCCGTGGAGGGGGAGTCTGGTGGCTACAATAAGCTGATTTTT #> 165668:    96     0    50             TGTGCCCCCATGGATAGCAACTATCAGTTAATCTGG #> 165669:    97     0    36    TGCGCTGTGAGAGATAGGGACACCAATGCAGGCAAATCAACCTTT #> 165670:   101     0    36                TGTGCAGACGGCCCCCAAGGAAATCTCATCTTT #> 165671:   103     0    46       TGCGGCACAGAGAGTGGAGGTAGCAACTATAAACTGACATTT #>                                                 beta_nuc    wa    wb #>                                                   <char> <int> <int> #>      1:          TGTGCCAGCTCACCAGAGCAGGGTCTGGCCCAGCATTTT     3     3 #>      2:                TGTGCCAGCAGCTATCAGGGCCAGCAGTTCTTC     3     3 #>      3:       TGTGCCATCAGTCGGGGACAGGGGGCAGGTGAGCAGTTCTTC     3     3 #>      4: TGTGCCAGCTCGACAGGGGGACAGCGACCTAATGAAAAACTGTTTTTT     3     3 #>      5:    TGCGCCAGCAGCCCAACAGGGGGGCAGGACTATGGCTACACCTTC     3     3 #>     ---                                                              #> 165667:   TGTGCCAGCAGCGCCCACGGGGAAGGGAACGAAAAACTGTTTTTTT   131    37 #> 165668:      TGCAGTGCTAAATTAGCGGGCGACACCGGGGAGCTGTTTTTTT   146    50 #> 165669:      TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC   133    36 #> 165670:      TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC   137    36 #> 165671:          TGTGCCAGCAGCTGGGACAAAACCTACGAGCAGTACTTC   149    46 #>                                                                                                alpha_beta #>                                                                                                    <char> #>      1:                   TGTGCCGTGAACGGAGGTAACGACTACAAGCTCAGCTTT_TGTGCCAGCTCACCAGAGCAGGGTCTGGCCCAGCATTTT #>      2:                      TGTGCTCTTCAAACTTCTGGTGGCTACAATAAGCTGATTTTT_TGTGCCAGCAGCTATCAGGGCCAGCAGTTCTTC #>      3:                   TGTGCTCCCCGGTACACCGGTAACCAGTTCTATTTT_TGTGCCATCAGTCGGGGACAGGGGGCAGGTGAGCAGTTCTTC #>      4: TGTGCAATGAGAGAGGTCGCTTCTGGTGGCTACAATAAGCTGATTTTT_TGTGCCAGCTCGACAGGGGGACAGCGACCTAATGAAAAACTGTTTTTT #>      5:                TGTGCTGCCAGCGGGGGCTTTCAGAAACTTGTATTT_TGCGCCAGCAGCCCAACAGGGGGGCAGGACTATGGCTACACCTTC #>     ---                                                                                                   #> 165667:      TGTGCCGTGGAGGGGGAGTCTGGTGGCTACAATAAGCTGATTTTT_TGTGCCAGCAGCGCCCACGGGGAAGGGAACGAAAAACTGTTTTTTT #> 165668:                  TGTGCCCCCATGGATAGCAACTATCAGTTAATCTGG_TGCAGTGCTAAATTAGCGGGCGACACCGGGGAGCTGTTTTTTT #> 165669:         TGCGCTGTGAGAGATAGGGACACCAATGCAGGCAAATCAACCTTT_TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC #> 165670:                     TGTGCAGACGGCCCCCAAGGAAATCTCATCTTT_TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC #> 165671:                TGCGGCACAGAGAGTGGAGGTAGCAACTATAAACTGACATTT_TGTGCCAGCAGCTGGGACAAAACCTACGAGCAGTACTTC #>          method     r    ts  pval pval_adj loss_a_frac loss_b_frac     score #>          <char> <num> <num> <num>    <num>       <num>       <num>     <num> #>      1: madhype    NA    NA    NA       NA           0   0.0000000 0.2011610 #>      2: madhype    NA    NA    NA       NA           0   0.0000000 0.2011610 #>      3: madhype    NA    NA    NA       NA           0   0.0000000 0.2011610 #>      4: madhype    NA    NA    NA       NA           0   0.0000000 0.2011610 #>      5: madhype    NA    NA    NA       NA           0   0.0000000 0.2011610 #>     ---                                                                      #> 165667: madhype    NA    NA    NA       NA           0   0.7175573 1.5618088 #> 165668: madhype    NA    NA    NA       NA           0   0.6575342 1.6288014 #> 165669: madhype    NA    NA    NA       NA           0   0.7293233 1.0688280 #> 165670: madhype    NA    NA    NA       NA           0   0.7372263 0.5297975 #> 165671: madhype    NA    NA    NA       NA           0   0.6912752 0.4727439 #>                    cdr3a         va     ja            cdr3b       vb      jb #>                   <char>     <char> <char>           <char>   <char>  <char> #>      1:    CAVNGGNDYKLSF   TRAV12-2 TRAJ20    CASSPEQGLAQHF   TRBV18 TRBJ1-5 #>      2:   CALQTSGGYNKLIF    TRAV9-2  TRAJ4      CASSYQGQQFF  TRBV7-6 TRBJ2-1 #>      3:     CAPRYTGNQFYF     TRAV41 TRAJ49   CAISRGQGAGEQFF TRBV10-3 TRBJ2-1 #>      4: CAMREVASGGYNKLIF TRAV14/DV4  TRAJ4 CASSTGGQRPNEKLFF  TRBV6-1 TRBJ1-4 #>      5:     CAASGGFQKLVF      TRAV2  TRAJ8  CASSPTGGQDYGYTF  TRBV5-1 TRBJ1-2 #>     ---                                                                      #> 165667:  CAVEGESGGYNKLIF   TRAV12-2  TRAJ4 CASSAHGE_GTKNCFF    TRBV9 TRBJ1-4 #> 165668:     CAPMDSNYQLIW    TRAV1-2 TRAJ33  CSAKLAG_TPGSCFF TRBV20-1 TRBJ2-2 #> 165669:  CAVRDRDTNAGKSTF    TRAV1-1 TRAJ27  CASSFCG_AGYEQYF   TRBV28 TRBJ2-7 #> 165670:      CADGPQGNLIF   TRAV13-2 TRAJ42  CASSFCG_AGYEQYF   TRBV28 TRBJ2-7 #> 165671:   CGTESGGSNYKLTF     TRAV30 TRAJ53    CASSWDKTYEQYF  TRBV5-1 TRBJ2-7 #>          sample_id marker timepoint version #>             <char> <char>    <char>  <char> #>      1: cd4_tp1_v2    cd4       tp1      v2 #>      2: cd4_tp1_v2    cd4       tp1      v2 #>      3: cd4_tp1_v2    cd4       tp1      v2 #>      4: cd4_tp1_v2    cd4       tp1      v2 #>      5: cd4_tp1_v2    cd4       tp1      v2 #>     ---                                     #> 165667: cd8_tp3_v2    cd8       tp3      v2 #> 165668: cd8_tp3_v2    cd8       tp3      v2 #> 165669: cd8_tp3_v2    cd8       tp3      v2 #> 165670: cd8_tp3_v2    cd8       tp3      v2 #> 165671: cd8_tp3_v2    cd8       tp3      v2 #>                                              label #>                                             <char> #>      1: marker: cd4 | timepoint: tp1 | version: v2 #>      2: marker: cd4 | timepoint: tp1 | version: v2 #>      3: marker: cd4 | timepoint: tp1 | version: v2 #>      4: marker: cd4 | timepoint: tp1 | version: v2 #>      5: marker: cd4 | timepoint: tp1 | version: v2 #>     ---                                            #> 165667: marker: cd8 | timepoint: tp3 | version: v2 #> 165668: marker: cd8 | timepoint: tp3 | version: v2 #> 165669: marker: cd8 | timepoint: tp3 | version: v2 #> 165670: marker: cd8 | timepoint: tp3 | version: v2 #> 165671: marker: cd8 | timepoint: tp3 | version: v2"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_pair_stats.html","id":null,"dir":"Reference","previous_headings":"","what":"Count the number of pairs called by each algorithm — get_pair_stats","title":"Count the number of pairs called by each algorithm — get_pair_stats","text":"function tabulates number TCR pairs called sample MAD-HYPE algorithm, T-SHELL algorithm, . used plot_paired() function.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_pair_stats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count the number of pairs called by each algorithm — get_pair_stats","text":"","code":"get_pair_stats(data, verbose = TRUE)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_pair_stats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count the number of pairs called by each algorithm — get_pair_stats","text":"data TIRTLseqDataSet object verbose (optional) whether print progress function (default TRUE).","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_pair_stats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count the number of pairs called by each algorithm — get_pair_stats","text":"data frame number pairs called algorithm sample.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_pair_stats.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Count the number of pairs called by each algorithm — get_pair_stats","text":"function can count number alpha chains paired, beta chains, number pairs overall. default, counts number pairs overall.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_pair_stats.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Count the number of pairs called by each algorithm — get_pair_stats","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\", package = \"TIRTLtools\") ts_data = load_tirtlseq(folder, meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 19.8 seconds  get_pair_stats(ts_data) #> Calculating pairing stats for sample 1 #> Calculating pairing stats for sample 2 #> Calculating pairing stats for sample 3 #> Calculating pairing stats for sample 4 #> Calculating pairing stats for sample 5 #> Calculating pairing stats for sample 6 #> # A tibble: 66 × 8 #>    category         Freq chain  sample_id  marker timepoint version label        #>    <fct>           <int> <chr>  <chr>      <chr>  <chr>     <chr>   <chr>        #>  1 MAD-HYPE only   25327 paired cd4_tp1_v2 cd4    tp1       v2      marker: cd4… #>  2 T-SHELL only     2498 paired cd4_tp1_v2 cd4    tp1       v2      marker: cd4… #>  3 both            20003 paired cd4_tp1_v2 cd4    tp1       v2      marker: cd4… #>  4 MAD-HYPE only   14343 alpha  cd4_tp1_v2 cd4    tp1       v2      marker: cd4… #>  5 T-SHELL only     1991 alpha  cd4_tp1_v2 cd4    tp1       v2      marker: cd4… #>  6 both            19137 alpha  cd4_tp1_v2 cd4    tp1       v2      marker: cd4… #>  7 neither       1936905 alpha  cd4_tp1_v2 cd4    tp1       v2      marker: cd4… #>  8 MAD-HYPE only   11058 beta   cd4_tp1_v2 cd4    tp1       v2      marker: cd4… #>  9 T-SHELL only     1633 beta   cd4_tp1_v2 cd4    tp1       v2      marker: cd4… #> 10 both            16254 beta   cd4_tp1_v2 cd4    tp1       v2      marker: cd4… #> # ℹ 56 more rows"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_paired_by_read_fraction_range.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the number and fraction of single chains that were paired by frequency — get_paired_by_read_fraction_range","title":"Calculate the number and fraction of single chains that were paired by frequency — get_paired_by_read_fraction_range","text":"function returns number fraction single-chains (alpha beta, default beta) paired within different frequency ranges (default [10^-1, 10^-2], [10^-2, 10^-3], ... , [10^-5,10^-6], [10^-6, 0]) sample. can use function get data used plot plot_paired_by_read_fraction_range().","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_paired_by_read_fraction_range.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the number and fraction of single chains that were paired by frequency — get_paired_by_read_fraction_range","text":"","code":"get_paired_by_read_fraction_range(   data,   chain = c(\"beta\", \"alpha\"),   cutoffs = 10^(-6:-1) )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_paired_by_read_fraction_range.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the number and fraction of single chains that were paired by frequency — get_paired_by_read_fraction_range","text":"data TIRTLseqDataSet object chain TCR chain use read fraction (default \"beta\") cutoffs vector cutoffs read fraction ranges","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_paired_by_read_fraction_range.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the number and fraction of single chains that were paired by frequency — get_paired_by_read_fraction_range","text":"data frame number fraction chains paired read fraction range sample.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_paired_by_read_fraction_range.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the number and fraction of single chains that were paired by frequency — get_paired_by_read_fraction_range","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\", package = \"TIRTLtools\") ts_data = load_tirtlseq(folder, meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 14.2 seconds  get_paired_by_read_fraction_range(ts_data, chain = \"beta\") #> # A tibble: 33 × 13 #>    range          n_paired_sum n_paired_sum_tshell n_paired_sum_madhype n_total #>    <fct>                 <int>               <int>                <int>   <int> #>  1 [0,1e-06)              6325                2114                 5361 1584466 #>  2 [1e-06,1e-05)         16357               10807                15716  276468 #>  3 [1e-05,0.0001)         6038                4774                 6014    6725 #>  4 [0.0001,0.001)          224                 191                  221     231 #>  5 [0.001,0.01)              1                   1                    0       1 #>  6 [0,1e-06)              4258                1789                 3392 1482037 #>  7 [1e-06,1e-05)         11577                8386                10988  288341 #>  8 [1e-05,0.0001)         4846                3529                 4819    6227 #>  9 [0.0001,0.001)          167                 131                  155     176 #> 10 [0.001,0.01)              1                   1                    0       1 #> # ℹ 23 more rows #> # ℹ 8 more variables: fraction_paired <dbl>, fraction_paired_tshell <dbl>, #> #   fraction_paired_madhype <dbl>, sample_id <chr>, marker <chr>, #> #   timepoint <chr>, version <chr>, label <chr>"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_well_subset.html","id":null,"dir":"Reference","previous_headings":"","what":"Get well names from numerical rows and columns — get_well_subset","title":"Get well names from numerical rows and columns — get_well_subset","text":"function returns vector well names specified rows columns.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_well_subset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get well names from numerical rows and columns — get_well_subset","text":"","code":"get_well_subset(row_range = 1:16, col_range = 1:24)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_well_subset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get well names from numerical rows and columns — get_well_subset","text":"row_range vector row indices, 1 () 16 (P) col_range vector column indices, 1 24","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_well_subset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get well names from numerical rows and columns — get_well_subset","text":"vector well names covering specified rows columns (e.g. \"A1\", \"A2\", ... \"P24\")","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/get_well_subset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get well names from numerical rows and columns — get_well_subset","text":"","code":"get_well_subset(1:16, 1:12) ## left half of plate #>   [1] \"A1\"  \"A2\"  \"A3\"  \"A4\"  \"A5\"  \"A6\"  \"A7\"  \"A8\"  \"A9\"  \"A10\" \"A11\" \"A12\" #>  [13] \"B1\"  \"B2\"  \"B3\"  \"B4\"  \"B5\"  \"B6\"  \"B7\"  \"B8\"  \"B9\"  \"B10\" \"B11\" \"B12\" #>  [25] \"C1\"  \"C2\"  \"C3\"  \"C4\"  \"C5\"  \"C6\"  \"C7\"  \"C8\"  \"C9\"  \"C10\" \"C11\" \"C12\" #>  [37] \"D1\"  \"D2\"  \"D3\"  \"D4\"  \"D5\"  \"D6\"  \"D7\"  \"D8\"  \"D9\"  \"D10\" \"D11\" \"D12\" #>  [49] \"E1\"  \"E2\"  \"E3\"  \"E4\"  \"E5\"  \"E6\"  \"E7\"  \"E8\"  \"E9\"  \"E10\" \"E11\" \"E12\" #>  [61] \"F1\"  \"F2\"  \"F3\"  \"F4\"  \"F5\"  \"F6\"  \"F7\"  \"F8\"  \"F9\"  \"F10\" \"F11\" \"F12\" #>  [73] \"G1\"  \"G2\"  \"G3\"  \"G4\"  \"G5\"  \"G6\"  \"G7\"  \"G8\"  \"G9\"  \"G10\" \"G11\" \"G12\" #>  [85] \"H1\"  \"H2\"  \"H3\"  \"H4\"  \"H5\"  \"H6\"  \"H7\"  \"H8\"  \"H9\"  \"H10\" \"H11\" \"H12\" #>  [97] \"I1\"  \"I2\"  \"I3\"  \"I4\"  \"I5\"  \"I6\"  \"I7\"  \"I8\"  \"I9\"  \"I10\" \"I11\" \"I12\" #> [109] \"J1\"  \"J2\"  \"J3\"  \"J4\"  \"J5\"  \"J6\"  \"J7\"  \"J8\"  \"J9\"  \"J10\" \"J11\" \"J12\" #> [121] \"K1\"  \"K2\"  \"K3\"  \"K4\"  \"K5\"  \"K6\"  \"K7\"  \"K8\"  \"K9\"  \"K10\" \"K11\" \"K12\" #> [133] \"L1\"  \"L2\"  \"L3\"  \"L4\"  \"L5\"  \"L6\"  \"L7\"  \"L8\"  \"L9\"  \"L10\" \"L11\" \"L12\" #> [145] \"M1\"  \"M2\"  \"M3\"  \"M4\"  \"M5\"  \"M6\"  \"M7\"  \"M8\"  \"M9\"  \"M10\" \"M11\" \"M12\" #> [157] \"N1\"  \"N2\"  \"N3\"  \"N4\"  \"N5\"  \"N6\"  \"N7\"  \"N8\"  \"N9\"  \"N10\" \"N11\" \"N12\" #> [169] \"O1\"  \"O2\"  \"O3\"  \"O4\"  \"O5\"  \"O6\"  \"O7\"  \"O8\"  \"O9\"  \"O10\" \"O11\" \"O12\" #> [181] \"P1\"  \"P2\"  \"P3\"  \"P4\"  \"P5\"  \"P6\"  \"P7\"  \"P8\"  \"P9\"  \"P10\" \"P11\" \"P12\"  get_well_subset(1:16, 13:24) ## right half of plate #>   [1] \"A13\" \"A14\" \"A15\" \"A16\" \"A17\" \"A18\" \"A19\" \"A20\" \"A21\" \"A22\" \"A23\" \"A24\" #>  [13] \"B13\" \"B14\" \"B15\" \"B16\" \"B17\" \"B18\" \"B19\" \"B20\" \"B21\" \"B22\" \"B23\" \"B24\" #>  [25] \"C13\" \"C14\" \"C15\" \"C16\" \"C17\" \"C18\" \"C19\" \"C20\" \"C21\" \"C22\" \"C23\" \"C24\" #>  [37] \"D13\" \"D14\" \"D15\" \"D16\" \"D17\" \"D18\" \"D19\" \"D20\" \"D21\" \"D22\" \"D23\" \"D24\" #>  [49] \"E13\" \"E14\" \"E15\" \"E16\" \"E17\" \"E18\" \"E19\" \"E20\" \"E21\" \"E22\" \"E23\" \"E24\" #>  [61] \"F13\" \"F14\" \"F15\" \"F16\" \"F17\" \"F18\" \"F19\" \"F20\" \"F21\" \"F22\" \"F23\" \"F24\" #>  [73] \"G13\" \"G14\" \"G15\" \"G16\" \"G17\" \"G18\" \"G19\" \"G20\" \"G21\" \"G22\" \"G23\" \"G24\" #>  [85] \"H13\" \"H14\" \"H15\" \"H16\" \"H17\" \"H18\" \"H19\" \"H20\" \"H21\" \"H22\" \"H23\" \"H24\" #>  [97] \"I13\" \"I14\" \"I15\" \"I16\" \"I17\" \"I18\" \"I19\" \"I20\" \"I21\" \"I22\" \"I23\" \"I24\" #> [109] \"J13\" \"J14\" \"J15\" \"J16\" \"J17\" \"J18\" \"J19\" \"J20\" \"J21\" \"J22\" \"J23\" \"J24\" #> [121] \"K13\" \"K14\" \"K15\" \"K16\" \"K17\" \"K18\" \"K19\" \"K20\" \"K21\" \"K22\" \"K23\" \"K24\" #> [133] \"L13\" \"L14\" \"L15\" \"L16\" \"L17\" \"L18\" \"L19\" \"L20\" \"L21\" \"L22\" \"L23\" \"L24\" #> [145] \"M13\" \"M14\" \"M15\" \"M16\" \"M17\" \"M18\" \"M19\" \"M20\" \"M21\" \"M22\" \"M23\" \"M24\" #> [157] \"N13\" \"N14\" \"N15\" \"N16\" \"N17\" \"N18\" \"N19\" \"N20\" \"N21\" \"N22\" \"N23\" \"N24\" #> [169] \"O13\" \"O14\" \"O15\" \"O16\" \"O17\" \"O18\" \"O19\" \"O20\" \"O21\" \"O22\" \"O23\" \"O24\" #> [181] \"P13\" \"P14\" \"P15\" \"P16\" \"P17\" \"P18\" \"P19\" \"P20\" \"P21\" \"P22\" \"P23\" \"P24\""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/identify_non_functional_seqs.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify TCRs that contain non-functional CDR3 sequences — identify_non_functional_seqs","title":"Identify TCRs that contain non-functional CDR3 sequences — identify_non_functional_seqs","text":"identify_non_functional_seqs() identifies CDR3 nucleotide sequences data contain either stop codons (*) frame shifts (_) indicate non-functional protein product.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/identify_non_functional_seqs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify TCRs that contain non-functional CDR3 sequences — identify_non_functional_seqs","text":"","code":"identify_non_functional_seqs(data)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/identify_non_functional_seqs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify TCRs that contain non-functional CDR3 sequences — identify_non_functional_seqs","text":"data TIRTLseqDataSet object","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/identify_non_functional_seqs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify TCRs that contain non-functional CDR3 sequences — identify_non_functional_seqs","text":"TIRTLseqDataSet object modified pseudobulk paired data frames sample. dataframe ouptut object added columns identify whether CDR3 alpha beta nucleotide sequences contain stop codons (*) frame shifts (_) indicate non-functional chain. Column is_functional TRUE neither chain stop codon frame shift. columns has_stop_codon has_frameshift similar, specific kind coding error. columns identify alpha chain beta chain stop codon frameshift, functional.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/identify_non_functional_seqs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify TCRs that contain non-functional CDR3 sequences — identify_non_functional_seqs","text":"","code":"# example code"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/identify_paired.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify which single chains were paired — identify_paired","title":"Identify which single chains were paired — identify_paired","text":"sample dataset, identify_paired() annotates alpha beta pseudobulk data number distinct pairs chain part paired data well TRUE/FALSE column indicating whether chain paired partners.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/identify_paired.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify which single chains were paired — identify_paired","text":"","code":"identify_paired(data, verbose = TRUE)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/identify_paired.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify which single chains were paired — identify_paired","text":"data TIRTLseq dataset created load_tirtlseq() verbose (optional) whether print progress function (default TRUE).","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/identify_paired.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify which single chains were paired — identify_paired","text":"dataset similar created load_tirtlseq(), added columns is_paired n_paired alpha beta pseudobulk data frames. is_paired TRUE chain found paired data. n_paired number distinct chains particular chain paired .","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/identify_paired.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify which single chains were paired — identify_paired","text":"","code":"# example code # paired = load_tirtlseq(\"path_to/your_directory\", sep = \"_\", meta_columns = c(\"cell_type\", \"timepoint\")) # paired = identify_paired(paired)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/install_python_env.html","id":null,"dir":"Reference","previous_headings":"","what":"Install python environment — install_python_env","title":"Install python environment — install_python_env","text":"function install python environment via basilisk package needed functions: TCRdist(), cluster_tcrs(), run_pairing(). run automatically needed, available user needed.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/install_python_env.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Install python environment — install_python_env","text":"","code":"install_python_env(force = FALSE)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/install_python_env.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Install python environment — install_python_env","text":"force whether force installation (default FALSE)","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/install_python_env.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Install python environment — install_python_env","text":"returns NULL","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/load_tirtlseq.html","id":null,"dir":"Reference","previous_headings":"","what":"Load data from TIRTLseq experiments — load_tirtlseq","title":"Load data from TIRTLseq experiments — load_tirtlseq","text":"load_tirtlseq() loads paired-TCR pseudo-bulk data TIRTLseq experiments given directory. can also automatically assemble metadata filenames.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/load_tirtlseq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load data from TIRTLseq experiments — load_tirtlseq","text":"","code":"load_tirtlseq(   directory,   chain = c(\"all\", \"paired\", \"alpha\", \"beta\"),   sep = \"_\",   meta_columns = NULL,   samples = NULL,   pseudobulk_columns = \"auto\",   paired_columns = \"auto\",   n_threads = data.table::getDTthreads(),   verbose = TRUE,   stringsAsFactors = FALSE,   n_max = Inf )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/load_tirtlseq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load data from TIRTLseq experiments — load_tirtlseq","text":"directory directory look \".tsv\" \".tsv.gz\" files TIRTLseq data chain TCR chain data load data – \"\" chains (alpha, beta, paired) default. sep (optional) separator filename metadata information (\"_\" default) meta_columns (optional) vector names identifying metadata contained filenames, example c(\"marker\", \"timepoint\", \"donor\") files named something like \"cd8_timepoint2_donor1 ... .tsv\". samples (optional) specific sample ids (part filename \"_pseudobulk\" \"_TIRTLoutput\") load. Default NULL (loads samples directory). pseudobulk_columns (optional) columns pseudobulk .tsv(.gz) read. Either list columns one \"auto\", \"\", \"minimal\". \"auto\" (default) loads columns except redundant ones. \"\" loads columns. \"minimal\" loads small number important columns. paired_columns (optional) columns paired .tsv(.gz) read. Either list columns one \"auto\", \"\", \"minimal\". \"auto\" (default) loads columns except redundant ones. \"\" loads columns. \"minimal\" loads small number important columns. n_threads (optional) number CPU threads use reading .tsv(.gz) files verbose (optional) whether print name file loaded (default TRUE). stringsAsFactors (optional) read character strings factors n_max (optional) maximum number files read – used mostly testing purposes (default Inf, .e. read files).","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/load_tirtlseq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load data from TIRTLseq experiments — load_tirtlseq","text":"function returns list following structure, containing data sample sample metadata.","code":"your_data_object (list) ├───meta (metadata dataframe) └───data (list)     └───sample_1 (list)         ├───alpha (alpha pseudobulk dataframe)         ├───beta (beta pseudobulk dataframe)         └───paired (paired pseudobulk dataframe)     ...     └───sample_n (list)         ├───alpha (alpha pseudobulk dataframe)         ├───beta (beta pseudobulk dataframe)         └───paired (paired pseudobulk dataframe)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/load_tirtlseq.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Load data from TIRTLseq experiments — load_tirtlseq","text":"function expects \".tsv\" (\".tsv.gz\") files. looks files ending \"_pseudobulk_TRA.tsv\" (alpha-chain pseudo-bulk), \"_pseudobulk_TRB.tsv\" (beta-chain pseudo-bulk), \"_TIRTLoutput.tsv\" (paired alpha beta chains). default, function construct metadata table row sample, based unique strings beginning filenames (\"_TIRTLoutput.tsv\" similar). filename contains sample metadata, can add multiple columns metadata table information. example, typical file looks like \"cd8_timepoint2_donor1_TIRTLoutput.tsv\" user supplies c(\"cell_type\", \"timepoint\", \"donor\") meta_columns \"_\" sep, metadata table look like something like :","code":"sample_id             cell_type   timepoint       donor     label      <chr>               <chr>         <chr>         <chr>     <chr> 1 cd8_timepoint2_donor1    cd8       timepoint2      donor1    cell_type: cd8 | timepoint: timepoint2 | donor: donor1 2 ... 3 cd4_timepoint1_donor3    cd4       timepoint1      donor3    cell_type: cd4 | timepoint: timepoint1 | donor: donor3"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/load_tirtlseq.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load data from TIRTLseq experiments — load_tirtlseq","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\",   package = \"TIRTLtools\") ts_data = load_tirtlseq(folder,   meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\") #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 alpha chain pseudo-bulk files. #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> -- Loading files for sample: cd4_tp1_v2... #> ---- Loading file -- Pseudobulk (alpha chain) -- cd4_tp1_v2_pseudobulk_TRA.tsv... #> ---- Loading file -- Pseudobulk (beta chain)  -- cd4_tp1_v2_pseudobulk_TRB.tsv... #> ---- Loading file -- TIRTLseq (paired chain)  -- cd4_tp1_v2_TIRTLoutput.tsv... #> -- Loading files for sample: cd4_tp2_v2... #> ---- Loading file -- Pseudobulk (alpha chain) -- cd4_tp2_v2_pseudobulk_TRA.tsv... #> ---- Loading file -- Pseudobulk (beta chain)  -- cd4_tp2_v2_pseudobulk_TRB.tsv... #> ---- Loading file -- TIRTLseq (paired chain)  -- cd4_tp2_v2_TIRTLoutput.tsv... #> -- Loading files for sample: cd4_tp3_v2... #> ---- Loading file -- Pseudobulk (alpha chain) -- cd4_tp3_v2_pseudobulk_TRA.tsv... #> ---- Loading file -- Pseudobulk (beta chain)  -- cd4_tp3_v2_pseudobulk_TRB.tsv... #> ---- Loading file -- TIRTLseq (paired chain)  -- cd4_tp3_v2_TIRTLoutput.tsv... #> -- Loading files for sample: cd8_tp1_v2... #> ---- Loading file -- Pseudobulk (alpha chain) -- cd8_tp1_v2_pseudobulk_TRA.tsv... #> ---- Loading file -- Pseudobulk (beta chain)  -- cd8_tp1_v2_pseudobulk_TRB.tsv... #> ---- Loading file -- TIRTLseq (paired chain)  -- cd8_tp1_v2_TIRTLoutput.tsv... #> -- Loading files for sample: cd8_tp2_v2... #> ---- Loading file -- Pseudobulk (alpha chain) -- cd8_tp2_v2_pseudobulk_TRA.tsv... #> ---- Loading file -- Pseudobulk (beta chain)  -- cd8_tp2_v2_pseudobulk_TRB.tsv... #> ---- Loading file -- TIRTLseq (paired chain)  -- cd8_tp2_v2_TIRTLoutput.tsv... #> -- Loading files for sample: cd8_tp3_v2... #> ---- Loading file -- Pseudobulk (alpha chain) -- cd8_tp3_v2_pseudobulk_TRA.tsv... #> ---- Loading file -- Pseudobulk (beta chain)  -- cd8_tp3_v2_pseudobulk_TRB.tsv... #> ---- Loading file -- TIRTLseq (paired chain)  -- cd8_tp3_v2_TIRTLoutput.tsv... #> Loaded 18 files from 6 samples. #> 17 seconds"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/params.html","id":null,"dir":"Reference","previous_headings":"","what":"Table of permissible amino acids and V-segments for TCRdist — params","title":"Table of permissible amino acids and V-segments for TCRdist — params","text":"Table permissible amino acids V-segments TCRdist","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Table of permissible amino acids and V-segments for TCRdist — params","text":"","code":"params"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/params.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Table of permissible amino acids and V-segments for TCRdist — params","text":"data frame two columns. data frame contains 266 features, mapping 161 row/column indices. first column called \"feature\" contains TCR V-segments (e.g. \"TRAV12-1*02\") one-letter abbreviations amino acids. second column called \"value\" contains row/column index substitution matrix corresponding amino acid V-segment. Note first row/column 0 (instead 1) TCRdist code Python, 0-indexed.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/params.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Table of permissible amino acids and V-segments for TCRdist — params","text":"","code":"params #> # A tibble: 266 × 2 #>    feature value #>    <chr>   <dbl> #>  1 _           0 #>  2 A           1 #>  3 C           2 #>  4 D           3 #>  5 E           4 #>  6 F           5 #>  7 G           6 #>  8 H           7 #>  9 I           8 #> 10 K           9 #> # ℹ 256 more rows"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clone_size_across_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Line plot of clone read fraction across multiple samples — plot_clone_size_across_samples","title":"Line plot of clone read fraction across multiple samples — plot_clone_size_across_samples","text":"function creates line plot clone read fraction specified clones across multiple samples. function can color lines groups clones. sum_readFraction TRUE, read fraction group summed presented one line.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clone_size_across_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Line plot of clone read fraction across multiple samples — plot_clone_size_across_samples","text":"","code":"plot_clone_size_across_samples(   data,   clones,   chain = c(\"beta\", \"alpha\"),   pseudo = 1e-06,   group_vec = NULL,   sum_readFraction = TRUE,   samples = NULL,   return_data = FALSE,   label_zero = FALSE,   show_legend = TRUE,   log_scale = TRUE,   x_var = NULL )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clone_size_across_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Line plot of clone read fraction across multiple samples — plot_clone_size_across_samples","text":"data TIRTLseqDataSet object clones list nucleotide sequences TCR clones chain TCR chain used (default \"beta\") pseudo value pseudocount added read fractions (default 10^-6) group_vec (optional) vector \"groups\" clones sum_readFraction TRUE, plot sum read fractions clones group. FALSE, plot clone separate line. samples (optional) samples use plot (default samples) return_data whether return data used plotting (default FALSE) label_zero whether label zero y-axis (default FALSE) show_legend whether show legend (default TRUE) log_scale (optional) TRUE, use log-scale y-axis (default FALSE) x_var column metadata grouping samples plot. default NULL, considers sample group.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clone_size_across_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Line plot of clone read fraction across multiple samples — plot_clone_size_across_samples","text":"ggplot object line plot clone read fractions across samples.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clone_size_across_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Line plot of clone read fraction across multiple samples — plot_clone_size_across_samples","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\",   package = \"TIRTLtools\") sjtrc = load_tirtlseq(folder,   meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\",   verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 21.6 seconds  top_clones1 = sjtrc$data$cd8_tp1_v2$beta %>%   dplyr::arrange(desc(readFraction)) %>%   head(5) %>%   magrittr::extract2(\"targetSequences\") %>% as.character() top_clones2 = sjtrc$data$cd8_tp2_v2$beta %>%   dplyr::arrange(desc(readFraction)) %>%   head(5) %>%   magrittr::extract2(\"targetSequences\") %>% as.character()  plot_clone_size_across_samples(sjtrc,   clones = c(top_clones1, top_clones2), chain = \"beta\")"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clonotype_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Stacked bar chart with fractions of reads attributed to the most frequent clonotypes — plot_clonotype_indices","title":"Stacked bar chart with fractions of reads attributed to the most frequent clonotypes — plot_clonotype_indices","text":"plot_clonotype_indices() creates stacked bar chart containing fraction reads top 10 frequent clonotypes, 11th 100th frequent clonotypes, 101st 1000th frequent, , sample dataset.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clonotype_indices.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stacked bar chart with fractions of reads attributed to the most frequent clonotypes — plot_clonotype_indices","text":"","code":"plot_clonotype_indices(   data,   chain = c(\"beta\", \"alpha\"),   cutoffs = 10^(1:5),   group_col = NULL,   label_col = \"Sample\",   flip = FALSE,   return_data = FALSE,   color_scheme = NULL )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clonotype_indices.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Stacked bar chart with fractions of reads attributed to the most frequent clonotypes — plot_clonotype_indices","text":"data TIRTLseqDataSet object chain TCR chain use (default \"beta\") cutoffs indices used end group bar chart. default 10^(1:5), .e. 10th -frequent clone, 100th -frequent clone, 1,000th, 10,000th, 100,000th. group_col (optional) supplied, column metadata used group samples label_col (optional) labels samples flip (optional) TRUE, flip x y-axes (default FALSE) return_data (optional) TRUE, return data used make plot (default FALSE) color_scheme (optional) color scheme use","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clonotype_indices.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Stacked bar chart with fractions of reads attributed to the most frequent clonotypes — plot_clonotype_indices","text":"Returns stacked bar chart relative frequencies -frequent clonotypes. return_data TRUE, data frame used create plot returned instead.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clonotype_indices.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Stacked bar chart with fractions of reads attributed to the most frequent clonotypes — plot_clonotype_indices","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\",   package = \"TIRTLtools\") data = load_tirtlseq(folder,   meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\",   verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 18 seconds  plot_clonotype_indices(data, chain = \"beta\")"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clusters.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot clusters of similar TCRs — plot_clusters","title":"Plot clusters of similar TCRs — plot_clusters","text":"plot_clusters() plots TCRs previously clustered cluster_tcrs() function.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot clusters of similar TCRs — plot_clusters","text":"","code":"plot_clusters(   obj,   n_clusters = 10,   seed = 1234,   annotation_cols = c(\"cluster\", \"source\"),   color_col = \"cluster\" )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot clusters of similar TCRs — plot_clusters","text":"obj object returned cluster_tcrs() function n_clusters number clusters plot (default 10) seed number use seed. Using number across multiple runs allows reproducible results. annotation_cols columns use heatmap annotations (default cluster source, .e. data vdj-db) color_col column use color nodes network visualization (default \"cluster\")","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clusters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot clusters of similar TCRs — plot_clusters","text":"Currently returns list three items: $umap - umap visualization TCRs top clusters $graph - graph/network visualization TCRs top clusters $heatmap - heatmap visualization TCRs top clusters","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clusters.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot clusters of similar TCRs — plot_clusters","text":"function currently returns list UMAP plot, graph/network plot, heatmap.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_clusters.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot clusters of similar TCRs — plot_clusters","text":"","code":"# example code # paired = load_tirtlseq(\"your_directory/\") # obj = cluster_tcrs(paired) # plot_clusters(obj)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_diversity.html","id":null,"dir":"Reference","previous_headings":"","what":"Bar plot of clonal diversity metrics — plot_diversity","title":"Bar plot of clonal diversity metrics — plot_diversity","text":"plot_diversity() plots requested clonal diversity metric function can plot variety clonal diversity metrics dataset (richness, Simpson diversity index, Shannon-Wiener index, etc.). See get_all_div_metrics() available options. default return barplot one bar sample dataset. grouping column (metadata) supplied, samples grouped bar heights reflect average diversity metric across group, error bars showing standard deviation.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_diversity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bar plot of clonal diversity metrics — plot_diversity","text":"","code":"plot_diversity(   div,   metric = get_all_div_metrics(),   q = 2,   percent = 90,   group_col = NULL,   label_col = \"Sample\",   flip = FALSE,   facet = FALSE,   log_scale = FALSE,   samples = NULL,   return_data = FALSE,   color_scheme = NULL,   x_var = NULL )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_diversity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bar plot of clonal diversity metrics — plot_diversity","text":"div list created diversity() function diversity metrics sample metric diversity metric use (e.g. shannon, simpson, etc.) q (optional) 'renyi' 'hill' metrics, order q diversity index percent (optional) 'dXX' metric, percentage 'XX' 0 100 group_col (optional) supplied, column metadata used group samples label_col (optional) labels samples flip (optional) TRUE, flip x y-axes (default FALSE) facet (optional) TRUE, plot separate facets, sub-plots group (default FALSE) log_scale (optional) TRUE, use log-scale y-axis (default FALSE) samples (optional) samples include plot (default samples) return_data (optional) TRUE, return data used make plot (default FALSE) color_scheme (optional) color scheme plot x_var (optional) variable show x-axis, \"sample_id\"","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_diversity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bar plot of clonal diversity metrics — plot_diversity","text":"list two objects: $plot - ggplot object plot requested diversity metric $data - return_data TRUE, data frame used make plot","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_diversity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bar plot of clonal diversity metrics — plot_diversity","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\",   package = \"TIRTLtools\") sjtrc = load_tirtlseq(folder,   meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\",   verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 15.2 seconds  div = calculate_diversity(sjtrc, chain = \"beta\", metrics = \"d50\") #>  #> -- Calculating diversity indices for sample 1 of 6. #> -- Calculating diversity indices for sample 2 of 6. #> -- Calculating diversity indices for sample 3 of 6. #> -- Calculating diversity indices for sample 4 of 6. #> -- Calculating diversity indices for sample 5 of 6. #> -- Calculating diversity indices for sample 6 of 6. plot_diversity(div, metric = \"d50\")"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_n_reads.html","id":null,"dir":"Reference","previous_headings":"","what":"Bar plot of the number of single-chain reads for each sample — plot_n_reads","title":"Bar plot of the number of single-chain reads for each sample — plot_n_reads","text":"function plots total number alpha /beta reads (default ) sample.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_n_reads.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bar plot of the number of single-chain reads for each sample — plot_n_reads","text":"","code":"plot_n_reads(   data,   chain = c(\"both\", \"beta\", \"alpha\"),   samples = NULL,   color_scheme = NULL )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_n_reads.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bar plot of the number of single-chain reads for each sample — plot_n_reads","text":"data TIRTLseqDataSet object chain TCR chain plot (default \"alpha\" \"beta\") samples (optional) samples plot (default samples) color_scheme color scheme plot","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_n_reads.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bar plot of the number of single-chain reads for each sample — plot_n_reads","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\", package = \"TIRTLtools\") ts_data = load_tirtlseq(folder, meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 16.8 seconds  plot_n_reads(ts_data)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_num_partners.html","id":null,"dir":"Reference","previous_headings":"","what":"Stacked bar plot of the fraction of alpha/beta chains with different numbers of partners — plot_num_partners","title":"Stacked bar plot of the fraction of alpha/beta chains with different numbers of partners — plot_num_partners","text":"plot_num_partners() creates bar plots alpha beta chains showing many partners paired MAD-HYPE /T-shell algorithms.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_num_partners.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stacked bar plot of the fraction of alpha/beta chains with different numbers of partners — plot_num_partners","text":"","code":"plot_num_partners(   data,   group_col = NULL,   fraction = TRUE,   include_non_functional = FALSE,   max_partners = 5,   samples = NULL,   return_data = FALSE,   color_scheme = NULL )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_num_partners.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Stacked bar plot of the fraction of alpha/beta chains with different numbers of partners — plot_num_partners","text":"data TIRTLseqDataSet object group_col column metadata use group multiple samples one bar plot default NULL, uses sample id. fraction whether plot fraction chains total number chains (default TRUE, .e. plot fractions) include_non_functional whether include chains non-functional cdr3 sequences tabulating output. max_partners maximum number partners, N, include plots. chains N partners grouped together \">N\" category. samples (optional) samples plot return_data TRUE, return data used make plots color_scheme color scheme use plot","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_num_partners.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Stacked bar plot of the fraction of alpha/beta chains with different numbers of partners — plot_num_partners","text":"bar chart (ggplot object) facets (sub-plots) sample. return_data TRUE, data frame used create plot returned instead.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_num_partners.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Stacked bar plot of the fraction of alpha/beta chains with different numbers of partners — plot_num_partners","text":"sample, function creates stacked bar charts alpha beta chains, showing proportion (among called pairs) paired 1 chain, 2 chains, 3 chains, etc.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_num_partners.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Stacked bar plot of the fraction of alpha/beta chains with different numbers of partners — plot_num_partners","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\",   package = \"TIRTLtools\") ts_data = load_tirtlseq(folder,   meta_columns = c(\"marker\",\"timepoint\", \"version\"),   sep = \"_\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 12.8 seconds  plot_num_partners(ts_data)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_paired.html","id":null,"dir":"Reference","previous_headings":"","what":"Stacked bar plot of the number of TCRs paired by each algorithm — plot_paired","title":"Stacked bar plot of the number of TCRs paired by each algorithm — plot_paired","text":"function plots number TCRs paired algorithm. can also plot number single-chains (alpha beta) paired algorithms.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_paired.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stacked bar plot of the number of TCRs paired by each algorithm — plot_paired","text":"","code":"plot_paired(   data,   chain = c(\"paired\", \"alpha\", \"beta\"),   samples = NULL,   color_scheme = NULL )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_paired.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Stacked bar plot of the number of TCRs paired by each algorithm — plot_paired","text":"data TIRTLseqDataSet object data frame created using get_pair_stats() chain TCR chain plot (default \"paired\") samples (optional) samples include plot (default ) color_scheme (optional) color scheme plot","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_paired.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Stacked bar plot of the number of TCRs paired by each algorithm — plot_paired","text":"ggplot object stacked bar chart number pairs called sample algorithm.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_paired.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Stacked bar plot of the number of TCRs paired by each algorithm — plot_paired","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\", package = \"TIRTLtools\") ts_data = load_tirtlseq(folder, meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 14.4 seconds  plot_paired(ts_data)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_paired_by_read_fraction_range.html","id":null,"dir":"Reference","previous_headings":"","what":"Bar plot of the fraction of paired single chains by frequency — plot_paired_by_read_fraction_range","title":"Bar plot of the fraction of paired single chains by frequency — plot_paired_by_read_fraction_range","text":"function returns bar plot fraction single-chains (alpha beta, default beta) paired within different frequency ranges (default [10^-1, 10^-2], [10^-2, 10^-3], ... , [10^-5,10^-6], [10^-6, 0]) sample.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_paired_by_read_fraction_range.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bar plot of the fraction of paired single chains by frequency — plot_paired_by_read_fraction_range","text":"","code":"plot_paired_by_read_fraction_range(   data,   chain = c(\"beta\", \"alpha\"),   cutoffs = 10^(-6:-1),   freq = FALSE,   samples = NULL,   color_scheme = NULL )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_paired_by_read_fraction_range.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bar plot of the fraction of paired single chains by frequency — plot_paired_by_read_fraction_range","text":"data TIRTLseqDataSet object data frame created using get_paired_by_read_fraction_range() chain TCR chain plot (default \"beta\") cutoffs vector cutoffs read fraction ranges freq TRUE, plot number pairs, FALSE plot fraction paired (default FALSE, plot fraction paired) samples (optional) samples include plot color_scheme (optional) color scheme use plot","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_paired_by_read_fraction_range.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bar plot of the fraction of paired single chains by frequency — plot_paired_by_read_fraction_range","text":"ggplot object bar plot fraction paired chains frequency","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_paired_by_read_fraction_range.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bar plot of the fraction of paired single chains by frequency — plot_paired_by_read_fraction_range","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\", package = \"TIRTLtools\") ts_data = load_tirtlseq(folder, meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 13.6 seconds  plot_paired_by_read_fraction_range(ts_data, chain = \"beta\")"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_paired_vs_rank.html","id":null,"dir":"Reference","previous_headings":"","what":"A step plot of the cumulative number of paired/unpaired alpha/beta chains among the most frequent chains — plot_paired_vs_rank","title":"A step plot of the cumulative number of paired/unpaired alpha/beta chains among the most frequent chains — plot_paired_vs_rank","text":"function creates stepped line plot cumulative number paired/unpaired alpha beta chains (default ) among n_max frequent chains.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_paired_vs_rank.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A step plot of the cumulative number of paired/unpaired alpha/beta chains among the most frequent chains — plot_paired_vs_rank","text":"","code":"plot_paired_vs_rank(   data,   sample,   y_axis = c(\"n_not_paired\", \"n_paired\"),   chain = c(\"both\", \"beta\", \"alpha\"),   n_max = 100,   color_scheme = NULL )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_paired_vs_rank.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A step plot of the cumulative number of paired/unpaired alpha/beta chains among the most frequent chains — plot_paired_vs_rank","text":"data TIRTLseqDataSet object sample sample plot (either number sample id) y_axis whether plot cumulative number paired un-paired single-chains (default \"n_not_paired\") chain TCR chain plot (default alpha beta) n_max number frequent single-chains plot color_scheme (optional) color scheme plot","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_paired_vs_rank.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A step plot of the cumulative number of paired/unpaired alpha/beta chains among the most frequent chains — plot_paired_vs_rank","text":"ggplot object plot","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_paired_vs_rank.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A step plot of the cumulative number of paired/unpaired alpha/beta chains among the most frequent chains — plot_paired_vs_rank","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\", package = \"TIRTLtools\") ts_data = load_tirtlseq(folder, meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 13.8 seconds  plot_paired_vs_rank(ts_data, sample = 1, y_axis = \"n_not_paired\", chain = \"both\", n_max = 100)   plot_paired_vs_rank(ts_data, sample = 1, y_axis = \"n_paired\", chain = \"both\", n_max = 100)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_pairs_with_eachother.html","id":null,"dir":"Reference","previous_headings":"","what":"A connected point plot of read fraction vs. rank for the most frequent alpha/beta chains — plot_pairs_with_eachother","title":"A connected point plot of read fraction vs. rank for the most frequent alpha/beta chains — plot_pairs_with_eachother","text":"function creates point plot read fraction vs. rank N frequent alpha (left, mirrored) beta (right) chains lines alpha beta chains indicating pair cross indicating unpaired single-chain.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_pairs_with_eachother.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A connected point plot of read fraction vs. rank for the most frequent alpha/beta chains — plot_pairs_with_eachother","text":"","code":"plot_pairs_with_eachother(   data,   sample,   n_max = 100,   show_num_partners = FALSE,   color_scheme = NULL )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_pairs_with_eachother.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A connected point plot of read fraction vs. rank for the most frequent alpha/beta chains — plot_pairs_with_eachother","text":"data TIRTLseqDataSet object sample sample plot (either number sample id) n_max number frequent single-chains plot show_num_partners whether show number partners single-chain (default FALSE) color_scheme (optional) color scheme plot","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_pairs_with_eachother.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A connected point plot of read fraction vs. rank for the most frequent alpha/beta chains — plot_pairs_with_eachother","text":"ggplot object plot","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_pairs_with_eachother.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A connected point plot of read fraction vs. rank for the most frequent alpha/beta chains — plot_pairs_with_eachother","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\", package = \"TIRTLtools\") ts_data = load_tirtlseq(folder, meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 14.4 seconds  plot_pairs_with_eachother(ts_data, sample = 1, n_max = 100)   plot_pairs_with_eachother(ts_data, sample = 1, n_max = 100, show_num_partners = TRUE)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_ranks.html","id":null,"dir":"Reference","previous_headings":"","what":"Line plot of clonotype rank vs. read fraction for each sample — plot_ranks","title":"Line plot of clonotype rank vs. read fraction for each sample — plot_ranks","text":"plot_ranks() returns line plot TCR rank vs. read fraction given sample.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_ranks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Line plot of clonotype rank vs. read fraction for each sample — plot_ranks","text":"","code":"plot_ranks(   data,   chain = c(\"beta\", \"alpha\"),   column = \"readFraction\",   color_scheme = NULL )  rank_plot(...)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_ranks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Line plot of clonotype rank vs. read fraction for each sample — plot_ranks","text":"data TIRTLseqDataSet object chain chain plot, \"alpha\" \"beta\" (default \"beta\") column variable plot (default \"readFraction\") color_scheme (optional) color scheme plot","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_ranks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Line plot of clonotype rank vs. read fraction for each sample — plot_ranks","text":"ggplot object rank plot","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_ranks.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Line plot of clonotype rank vs. read fraction for each sample — plot_ranks","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\", package = \"TIRTLtools\") ts_data = load_tirtlseq(folder, meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 15.9 seconds  plot_ranks(ts_data, chain = \"beta\")"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_read_fraction_vs_pair_status.html","id":null,"dir":"Reference","previous_headings":"","what":"A point plot of read fraction vs. rank for the most frequent alpha/beta chains — plot_read_fraction_vs_pair_status","title":"A point plot of read fraction vs. rank for the most frequent alpha/beta chains — plot_read_fraction_vs_pair_status","text":"function creates two point plots (alpha left, beta right) n_max frequent single-chains found sample. function creates plot similar plot_pairs_with_eachother(), mirror alpha chains plot add connections paired alpha beta chains.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_read_fraction_vs_pair_status.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A point plot of read fraction vs. rank for the most frequent alpha/beta chains — plot_read_fraction_vs_pair_status","text":"","code":"plot_read_fraction_vs_pair_status(   data,   sample,   chain = c(\"both\", \"beta\", \"alpha\"),   n_max = 100,   show_num_partners = F,   color_scheme = NULL )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_read_fraction_vs_pair_status.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A point plot of read fraction vs. rank for the most frequent alpha/beta chains — plot_read_fraction_vs_pair_status","text":"data TIRTLseqDataSet object sample sample plot (either number sample id) chain chain plot, \"alpha\", \"beta\", \"\" (default \"\") n_max number frequent single-chains plot show_num_partners whether show number partners single-chain (default FALSE) color_scheme (optional) color scheme plot","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_read_fraction_vs_pair_status.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A point plot of read fraction vs. rank for the most frequent alpha/beta chains — plot_read_fraction_vs_pair_status","text":"ggplot object point plot","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_read_fraction_vs_pair_status.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A point plot of read fraction vs. rank for the most frequent alpha/beta chains — plot_read_fraction_vs_pair_status","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\", package = \"TIRTLtools\") ts_data = load_tirtlseq(folder, meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 12.6 seconds  plot_read_fraction_vs_pair_status(ts_data, sample = 1, n_max = 100)   plot_read_fraction_vs_pair_status(ts_data, sample = 1, n_max = 100, show_num_partners = TRUE)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_sample_overlap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the overlap/agreement between samples (in terms of most frequent clones) — plot_sample_overlap","title":"Plot the overlap/agreement between samples (in terms of most frequent clones) — plot_sample_overlap","text":"function returns heatmap showing overlap among frequent n_seq TCRs (default n_seq=200) among pairs samples dataset.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_sample_overlap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the overlap/agreement between samples (in terms of most frequent clones) — plot_sample_overlap","text":"","code":"plot_sample_overlap(   data,   chain = c(\"paired\", \"alpha\", \"beta\"),   n_seq = 200,   show_row_names = FALSE,   show_column_names = FALSE,   label_col = \"Sample\",   title = \"\",   return_data = FALSE,   cluster_rows = TRUE,   cluster_cols = TRUE )  sample_overlap(...)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_sample_overlap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the overlap/agreement between samples (in terms of most frequent clones) — plot_sample_overlap","text":"data dataset, object loaded using load_tirtlseq() function chain chain plot: either paired alpha-/beta-pseudobulk. (default \"paired\") n_seq number frequent TCR sequences use (default 200) show_row_names whether show row names heatmap (default FALSE) show_column_names whether show column names heatmap (default FALSE) label_col column metadata use labels rows columns (default \"Sample\", uses sample_id) title title heatmap return_data whether return data used plotting (matrix overlap values) instead heatmap (default FALSE) cluster_rows whether cluster rows heatmap (default TRUE) cluster_cols whether cluster columns heatmap (default TRUE)","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_sample_overlap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the overlap/agreement between samples (in terms of most frequent clones) — plot_sample_overlap","text":"heatmap hierarchically clustered rows columns showing number TCRs shared pair samples, among top N frequent TCRs. return_data TRUE, matrix overlap values returned instead.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_sample_overlap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the overlap/agreement between samples (in terms of most frequent clones) — plot_sample_overlap","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\", package = \"TIRTLtools\") ts_data = load_tirtlseq(folder, meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 12.6 seconds  plot_sample_overlap(ts_data, chain = \"beta\")  plot_sample_overlap(ts_data, chain = \"alpha\")  plot_sample_overlap(ts_data, chain = \"paired\")"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_sample_vs_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"Scatterplot of TCR clone read fraction of clones between two samples — plot_sample_vs_sample","title":"Scatterplot of TCR clone read fraction of clones between two samples — plot_sample_vs_sample","text":"plot_sample_vs_sample() returns scatterplot read frequencies TCRs two samples. function labels TCR -regulated, -regulated, stable, based log2 fold-change cutoff supplied (default 1.5).","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_sample_vs_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scatterplot of TCR clone read fraction of clones between two samples — plot_sample_vs_sample","text":"","code":"plot_sample_vs_sample(   data1,   data2,   chain = c(\"beta\", \"alpha\"),   log2fc_cutoff = 3,   sem_cutoff = 2.5,   pseudo1 = 1e-06,   pseudo2 = 1e-06,   labelx = \"Frequency on timepoint 1\",   labely = \"Frequency on timepoint 2\",   return_data = FALSE,   smooth_sem = c(\"window\", \"none\"),   window_size = 30,   end_window_size = 5 )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_sample_vs_sample.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scatterplot of TCR clone read fraction of clones between two samples — plot_sample_vs_sample","text":"data1 list three data frames (alpha, beta, paired) one sample data2 list three data frames (alpha, beta, paired) one sample chain chain plot, alpha beta (default beta) log2fc_cutoff log2 fold-change cutoff call TCR - -regulated (default 1.5) sem_cutoff standard-error mean (SEM) use cutoff calling clones expanded contracted (default 2.5) pseudo1 pseudocount add read frequency first sample (default 10^-6). pseudo2 pseudocount add read frequency second sample (default 10^-6). labelx label x-axis labely label y-axis return_data TRUE, return data frame used make plot rather plot . smooth_sem \"window\", SEM values clones smoothed comparing clones within window similar frequencies. Otherwise, smoothing. (default \"window\") window_size number similar clones include within window. end_window_size number clones include window ends (least frequent)","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_sample_vs_sample.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scatterplot of TCR clone read fraction of clones between two samples — plot_sample_vs_sample","text":"scatterplot (ggplot object) read frequencies (proportions), colored whether TCR -regulated, -regulated, neither, given log2 fold-change cutoff. return_data TRUE, data frame used make plot returned instead plot.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/plot_sample_vs_sample.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scatterplot of TCR clone read fraction of clones between two samples — plot_sample_vs_sample","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\",   package = \"TIRTLtools\") sjtrc = load_tirtlseq(folder,   meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\",   verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 13.3 seconds  plot_sample_vs_sample(sjtrc$data$cd8_tp1_v2, sjtrc$data$cd8_tp2_v2, chain = \"beta\")"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/prep_for_tcrdist.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare paired TCRs for TCRdist calculation — prep_for_tcrdist","title":"Prepare paired TCRs for TCRdist calculation — prep_for_tcrdist","text":"function prepares paired TCR data frame running TCRdist, adding alleles V-segments (.e. \"*01\") missing removing TCRs unrecognized V-segments non-functional CDR3 sequences.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/prep_for_tcrdist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare paired TCRs for TCRdist calculation — prep_for_tcrdist","text":"","code":"prep_for_tcrdist(   df,   params = NULL,   remove_duplicate_tcrs = FALSE,   remove_MAIT = TRUE,   verbose = TRUE )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/prep_for_tcrdist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare paired TCRs for TCRdist calculation — prep_for_tcrdist","text":"df data frame paired TCRs params (optional) data frame permissible amino acids V-segments. default, params data frame used. remove_duplicate_tcrs (optional) whether remove duplicate TCRs (default FALSE, remove duplicates). remove_MAIT (optional) whether remove MAIT cells data frame (default TRUE). verbose (optional) whether print progress function (default TRUE).","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/prep_for_tcrdist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare paired TCRs for TCRdist calculation — prep_for_tcrdist","text":"Returns paired TCR data frame compatible TCRdist python scripts.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/remove_duplicates.html","id":null,"dir":"Reference","previous_headings":"","what":"Removes duplicate paired TCRs — remove_duplicates","title":"Removes duplicate paired TCRs — remove_duplicates","text":"default, paired TCRs listed one row paired chain data pairing algorithm called (either T-SHELL MAD-HYPE). means TCRs present two rows, algorithm. function removes duplicate TCRs returns data frame TCR pair found one row.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/remove_duplicates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Removes duplicate paired TCRs — remove_duplicates","text":"","code":"remove_duplicates(data)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/remove_duplicates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Removes duplicate paired TCRs — remove_duplicates","text":"data either single data frame (paired chain) list data frames","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/remove_duplicates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Removes duplicate paired TCRs — remove_duplicates","text":"Returns data frame (list data frames, depending input) paired TCRs TCR listed .","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/reorder_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Re-order samples in a TIRTLseqDataSet object — reorder_samples","title":"Re-order samples in a TIRTLseqDataSet object — reorder_samples","text":"function changes order samples TIRTLseqDataSet object order user specifies.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/reorder_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Re-order samples in a TIRTLseqDataSet object — reorder_samples","text":"","code":"reorder_samples(data, samples)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/reorder_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Re-order samples in a TIRTLseqDataSet object — reorder_samples","text":"data TIRTLseqDataSet object samples samples 'data', desired order. Either: numeric vector indices character vector sample names character vector metadata conditions entry form \"column==value\"","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/reorder_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Re-order samples in a TIRTLseqDataSet object — reorder_samples","text":"TIRTLseqDataSet object re-ordered samples.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/reorder_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Re-order samples in a TIRTLseqDataSet object — reorder_samples","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\",   package = \"TIRTLtools\") sjtrc = load_tirtlseq(folder,   meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\",   chain = \"paired\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 6 files from 6 samples. #> 0.6 seconds print(sjtrc$meta) #> # A tibble: 6 × 5 #>   sample_id  marker timepoint version label                                      #>   <chr>      <chr>  <chr>     <chr>   <chr>                                      #> 1 cd4_tp1_v2 cd4    tp1       v2      marker: cd4 | timepoint: tp1 | version: v2 #> 2 cd4_tp2_v2 cd4    tp2       v2      marker: cd4 | timepoint: tp2 | version: v2 #> 3 cd4_tp3_v2 cd4    tp3       v2      marker: cd4 | timepoint: tp3 | version: v2 #> 4 cd8_tp1_v2 cd8    tp1       v2      marker: cd8 | timepoint: tp1 | version: v2 #> 5 cd8_tp2_v2 cd8    tp2       v2      marker: cd8 | timepoint: tp2 | version: v2 #> 6 cd8_tp3_v2 cd8    tp3       v2      marker: cd8 | timepoint: tp3 | version: v2 new_order = names(sjtrc$data) %>% rev() print(new_order) #> [1] \"cd8_tp3_v2\" \"cd8_tp2_v2\" \"cd8_tp1_v2\" \"cd4_tp3_v2\" \"cd4_tp2_v2\" #> [6] \"cd4_tp1_v2\" sjtrc = reorder_samples(sjtrc, new_order) print(sjtrc$meta) #> # A tibble: 6 × 5 #>   sample_id  marker timepoint version label                                      #>   <chr>      <chr>  <chr>     <chr>   <chr>                                      #> 1 cd8_tp3_v2 cd8    tp3       v2      marker: cd8 | timepoint: tp3 | version: v2 #> 2 cd8_tp2_v2 cd8    tp2       v2      marker: cd8 | timepoint: tp2 | version: v2 #> 3 cd8_tp1_v2 cd8    tp1       v2      marker: cd8 | timepoint: tp1 | version: v2 #> 4 cd4_tp3_v2 cd4    tp3       v2      marker: cd4 | timepoint: tp3 | version: v2 #> 5 cd4_tp2_v2 cd4    tp2       v2      marker: cd4 | timepoint: tp2 | version: v2 #> 6 cd4_tp1_v2 cd4    tp1       v2      marker: cd4 | timepoint: tp1 | version: v2"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/run_pairing.html","id":null,"dir":"Reference","previous_headings":"","what":"Find TCRalpha/beta pairs from individual well read counts — run_pairing","title":"Find TCRalpha/beta pairs from individual well read counts — run_pairing","text":"runs MAD-HYPE T-SHELL algorithms find TCRalpha-beta pairs originating clone.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/run_pairing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find TCRalpha/beta pairs from individual well read counts — run_pairing","text":"","code":"run_pairing(   folder_path,   folder_out,   prefix,   well_filter_thres = 0.5,   min_reads = 0,   min_wells = 2,   well_pos = 3,   wellset1 = get_well_subset(1:16, 1:24),   compute = TRUE,   backend = c(\"auto\", \"cpu\", \"cupy\", \"mlx\"),   pval_thres_tshell = 1e-10,   wij_thres_tshell = 2,   verbose = TRUE,   write_extra_files = FALSE,   filter_before_top3 = FALSE,   fork = NULL,   shared = NULL )"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/run_pairing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find TCRalpha/beta pairs from individual well read counts — run_pairing","text":"folder_path path folder well-level data folder_out path folder write results . function create folder exist. prefix prefix output file names well_filter_thres wells removed fewer unique clones : wellfilter_thres*(Avg. # unique clones per well). default value 0.5 min_reads minimum number reads chain must well considered observed (note: actual minimum min_reads+1. Default value 0, .e. chain must >= 1 read well) min_wells minimum number wells chain must observed paired. well_pos position well ID (e.g. \"B5\") file names. example, files named \"<well_id>_TCRalpha.tsv\" use well_pos=3. (default 3) wellset1 vector wells use pairing compute whether run pairing algorithms tabulating writing pseudobulk data (default TRUE) backend computing backend use. function looks GPU automatically chooses appropriate backend default. pval_thres_tshell adjusted p-value threshold T-SHELL significance (default 1e-10) wij_thres_tshell threshold number wells containing chains T-SHELL significance (default >2 wells) verbose whether print messages (default TRUE) write_extra_files whether write un-necessary intermediate files (default FALSE) filter_before_top3 whether filter loss fraction extracting top 3 correlation values T-SHELL (default FALSE) fork whether \"fork\" python process basilisk (default NULL, automatically chooses appropriate option) shared whether use \"shared\" python process basilisk (default NULL, automatically chooses appropriate option)","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/run_pairing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find TCRalpha/beta pairs from individual well read counts — run_pairing","text":"data frame TCR-alpha/TCR-beta pairs. function also writes three files \"folder_out\": data frame (\"_pseudobulk_TRA.tsv\") pseudobulk counts TCRalpha chains data frame (\"_pseudobulk_TRB.tsv\") pseudobulk counts TCRbeta chains data frame (\"_TIRTLoutput.tsv\") TCR-alpha/TCR-beta pairs.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/submat.html","id":null,"dir":"Reference","previous_headings":"","what":"Substitution penalty matrix for TCRdist amino acids and V-segments — submat","title":"Substitution penalty matrix for TCRdist amino acids and V-segments — submat","text":"Substitution penalty matrix TCRdist amino acids V-segments","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/submat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Substitution penalty matrix for TCRdist amino acids and V-segments — submat","text":"","code":"submat"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/submat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Substitution penalty matrix for TCRdist amino acids and V-segments — submat","text":"symmetric matrix (161 x 161) substitution penalties pairs amino acids V-segments TCRdist calculation. amino acids/V-segments corresponding row/column listed \"params\" table.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/submat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Substitution penalty matrix for TCRdist amino acids and V-segments — submat","text":"","code":"dim(submat) #> [1] 161 161 submat[1:5,1:5] #>      V1 V2 V3 V4 V5 #> [1,]  0 12 12 12 12 #> [2,] 12  0 12 12 12 #> [3,] 12 12  0 12 12 #> [4,] 12 12 12  0  6 #> [5,] 12 12 12  6  0 ## to find the amino acid or v-segment(s) that map to a specific row/column index = 106 ## 106th row/column of matrix params[params$value == index-1,] ## need to subtract 1 because values in params are 0-indexed #> # A tibble: 6 × 2 #>   feature     value #>   <chr>       <dbl> #> 1 TRBV20-1*01   105 #> 2 TRBV20-1*02   105 #> 3 TRBV20-1*04   105 #> 4 TRBV20-1*05   105 #> 5 TRBV20-1*06   105 #> 6 TRBV20-1*07   105"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/summarize_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a summary table with number of reads and unique alpha/beta chains — summarize_data","title":"Create a summary table with number of reads and unique alpha/beta chains — summarize_data","text":"function creates summary table number reads unique alpha/beta chains observed sample.","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/summarize_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a summary table with number of reads and unique alpha/beta chains — summarize_data","text":"","code":"summarize_data(data)"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/summarize_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a summary table with number of reads and unique alpha/beta chains — summarize_data","text":"data TIRTLseqDataSet object","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/summarize_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a summary table with number of reads and unique alpha/beta chains — summarize_data","text":"data frame number reads unique chains observed sample.","code":""},{"path":[]},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/summarize_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a summary table with number of reads and unique alpha/beta chains — summarize_data","text":"","code":"folder = system.file(\"extdata/SJTRC_TIRTL_seq_longitudinal\", package = \"TIRTLtools\") ts_data = load_tirtlseq(folder, meta_columns = c(\"marker\", \"timepoint\", \"version\"), sep = \"_\", verbose = FALSE) #> Loading files from: /Users/nclark52/git/TIRTLtools/inst/extdata/SJTRC_TIRTL_seq_longitudinal... #> Found 6 beta chain pseudo-bulk files. #> Found 6 paired chain files. #> Loaded 18 files from 6 samples. #> 13.4 seconds  summarize_data(ts_data) #> # A tibble: 6 × 6 #>   sample_id  n_alpha_clones n_beta_clones n_clone_pairs n_reads_alpha #>   <chr>               <int>         <int>         <int>         <int> #> 1 cd4_tp1_v2        1972376       1867891         47828      76225265 #> 2 cd4_tp2_v2        1966962       1776782         32672      74060977 #> 3 cd4_tp3_v2        2062013       1930208         39012      66235760 #> 4 cd8_tp1_v2         937875        928777         14273      68573045 #> 5 cd8_tp2_v2         980522        895688         17891      68560963 #> 6 cd8_tp3_v2         850578        830552         13995      58978542 #> # ℹ 1 more variable: n_reads_beta <int>"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/write_stitchr_tsv.html","id":null,"dir":"Reference","previous_headings":"","what":"Write a tab-separated ","title":"Write a tab-separated ","text":"function takes data frame created create_thimble_df() writes .tsv file use Stitchr (https://jamieheather.github.io/stitchr/).","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/write_stitchr_tsv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write a tab-separated ","text":"","code":"write_stitchr_tsv(df, output_name, output_folder = \"\")"},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/write_stitchr_tsv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write a tab-separated ","text":"df data frame properly formatted TCRs created create_thimble_df() output_name output name .tsv file (\".tsv\" appended) output_folder folder write .tsv file ","code":""},{"path":"https://nicholasclark.github.io/TIRTLtools/reference/write_stitchr_tsv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write a tab-separated ","text":"function returns NULL writes .tsv specified folder.","code":""},{"path":[]}]
