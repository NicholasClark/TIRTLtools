<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>TCR-alpha/beta pairing for COVID-19 related TCRs • TIRTLtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="TCR-alpha/beta pairing for COVID-19 related TCRs">
</head>
<body>
<p>








  pkgdown/extra.css

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TIRTLtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.13</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/TIRTLtools.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/data_loading.html">Loading Paired TCR TIRTLseq data in R</a></li>
    <li><a class="dropdown-item" href="../articles/plot_examples.html">Plot examples with SJTRC COVID-19 data</a></li>
    <li><a class="dropdown-item" href="../articles/pairing_zenodo_data.html">TCR-alpha/beta pairing for COVID-19 related TCRs</a></li>
    <li><a class="dropdown-item" href="../articles/TCRdist.html">Fast TCR similarity calculation with TCRdist GPU</a></li>
    <li><a class="dropdown-item" href="../articles/structure_in_R.html">(coming soon) The structure of TIRTLseq data in R</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_tirtlseq_data_in_R.html">(coming soon) Working with TIRTLseq data in R</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Basic TIRTLseq data analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/summarizing_diversity.html">Estimating TCR Repertoire diversity</a></li>
    <li><a class="dropdown-item" href="../articles/SJTRC_identifying_covid_epitopes.html">(coming soon) Identifying SARS-CoV-2 epitopes from TIRTLseq data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Constructing full TCR nucleotide sequences</h6></li>
    <li><a class="dropdown-item" href="../articles/stitchr.html">(coming soon) Create output for Stitchr</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Single-cell TIRTLseq analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/scTIRTLseq_data.html">(coming soon) Working with single-cell TIRTLseq data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Well-level TIRTLseq analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/well_level_data.html">(coming soon) Working with well-level TIRTLseq data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NicholasClark/TIRTLtools"><span class="fa fa-github fa-lg"></span> Github</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>TCR-alpha/beta pairing for COVID-19 related TCRs</h1>
            
            <h4 data-toc-skip class="date">2025-11-24</h4>
      

      <div class="d-none name"><code>pairing_zenodo_data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="tutorial-overview">Tutorial overview<a class="anchor" aria-label="anchor" href="#tutorial-overview"></a>
</h2>
<p>This vignette shows how to generate paired TCR and single-chain
“pseudo-bulk” data using raw TIRTLseq TCR-alpha/beta read counts from
half of a 384-well plate. We find TCR pairs for CD8+ T-cells isolated
from patient samples before and after naturally acquired SARS-CoV-2
infection and re-create a figure from the <a href="http://doi.org/10.1038/s41592-025-02907-9" class="external-link">TIRTLseq paper</a>
showing changes in the patient’s TCR repertoire over time.</p>
</div>
<div class="section level2">
<h2 id="study-details">Study details<a class="anchor" aria-label="anchor" href="#study-details"></a>
</h2>
<p>For this example, we use data from the St. Jude Tracking Study of
Immune Responses Associated with COVID-19 (SJTRC), a clinical trial
launched in 2020 to study the T-cell receptor repertoires of adults with
naturally acquired COVID-19. This was a prospective, longitudinal cohort
study involving adult employees (18 years and older) at St. Jude
Children’s Research Hospital in Memphis, TN, USA.</p>
<p>Participants underwent weekly PCR screening for SARS-CoV-2 infection
while on the St. Jude campus. Blood samples were collected in 8-ml cell
preparation tubes, processed within 24 h into cellular and plasma
components, aliquoted and then frozen for future analysis.</p>
<p>Here, we use samples from a healthy 33-year-old female donor with
naturally acquired mild SARS-CoV-2 infection and no prior history of
SARS-CoV-2 infection or vaccination. Samples were collected 143 days
before this donor’s first positive SARS-CoV-2 PCR test
(<code>baseline</code> sample), 6 days after (<code>acute</code> sample)
and 29 days after (<code>convalescent</code> sample).</p>
</div>
<div class="section level2">
<h2 id="instructions">Instructions<a class="anchor" aria-label="anchor" href="#instructions"></a>
</h2>
<div class="section level3">
<h3 id="download-data">Download data<a class="anchor" aria-label="anchor" href="#download-data"></a>
</h3>
<p>You will need to download the data from <a href="https://zenodo.org/records/14010377" class="external-link">Zenodo</a> before running
this code. The data we are using is <code>exp3_clones.tar.gz</code>,
which includes well-level TIRTLseq data from three 384-well plates. You
will need to unzip the tar.gz file as well as the data for each
plate.</p>
<p>Note: These are large files. The tar.gz file is 1.4 GB and the
uncompressed data is 7.8 GB.</p>
</div>
<div class="section level3">
<h3 id="set-up-inputoutput-directories">Set up input/output directories<a class="anchor" aria-label="anchor" href="#set-up-inputoutput-directories"></a>
</h3>
<p>Change the folder locations in the following code block to the
directory with your downloaded and unzipped data (<code>folder</code>)
and the directory you would like to save the paired TCR output to
(<code>save_folder</code>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">folder</span> <span class="op">=</span> <span class="st">"~/Downloads/zenodo/exp3_clones/"</span> <span class="co">### change this to the directory with your downloaded data!</span></span>
<span><span class="va">save_folder</span> <span class="op">=</span> <span class="st">"~/git/TIRTLtools/extra/exp3_cd8"</span> <span class="co">### change this to the folder you would like to save paired output in (if the folder does not exist it will be created)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="select-plate-rows-and-columns">Select plate rows and columns<a class="anchor" aria-label="anchor" href="#select-plate-rows-and-columns"></a>
</h3>
<p>CD4+ and CD8+ T-cells were isolated from peripheral blood mononuclear
cells (PBMCs) in each sample. For each timepoint, CD8+ cells were plated
on the left half of wells in a 384-well plate and CD4+ cells were plated
on the right half.</p>
<p>In this case, we will pair the CD8+ cells, so we select columns 1
through 12 (the left half of the plate) and rows 1 through 16 (or A
through P, all rows).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nicholasclark.github.io/TIRTLtools/">TIRTLtools</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: ggplot2</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tp1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">folder</span>, <span class="st">"TCR_clones_ID02"</span><span class="op">)</span> <span class="co">## baseline (pre-infection)</span></span>
<span><span class="va">tp2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">folder</span>, <span class="st">"TCR_clones_ID03"</span><span class="op">)</span> <span class="co">## acute (6 days after infection)</span></span>
<span><span class="va">tp3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">folder</span>, <span class="st">"TCR_clones_ID04"</span><span class="op">)</span> <span class="co">## convalescent (29 days after infection)</span></span>
<span></span>
<span><span class="va">cd8_wells</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_well_subset.html">get_well_subset</a></span><span class="op">(</span>row_range <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">16</span>, col_range <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="co">## left half of the plate (CD8+)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-pairing-algorithms">Run pairing algorithms<a class="anchor" aria-label="anchor" href="#run-pairing-algorithms"></a>
</h3>
<p>The <code><a href="../reference/run_pairing.html">run_pairing()</a></code> function will run the pairing scripts,
which implement the MAD-HYPE and T-SHELL algorithms. These algorithms
are implemented in Python using GPU-accelerated packages (with numpy as
a CPU-only backup) for fast calculation. The package should
automatically install a python environment with the necessary packages
and detect the GPU type (NVIDIA or Apple Silicon) of your machine, if it
has one available.</p>
<p>Each function call may take a few minutes to run.</p>
<p>The main arguments of the function are:</p>
<ul>
<li>
<code>folder_path</code> - the path of the folder with well-level
data</li>
<li>
<code>folder_out</code> - the path of the folder to write results to
(the function will create the folder if it does not exist)</li>
<li>
<code>prefix</code> - a prefix (e.g. the sample name) for the output
file names</li>
<li>
<code>well_filter_thres</code> - a threshold on the number of unique
clones found in a well, for quality control</li>
<li>
<code>well_pos</code> - the position of the well ID (e.g. “B5”) in
the file names.</li>
<li>
<code>wellset1</code> - a vector of wells to use for the
pairing.</li>
</ul>
<p>For more information, check the documentation with
<code><a href="../reference/run_pairing.html">?run_pairing</a></code>.</p>
<p>The well-level data files in each folder are named something like
<code>MVP113_TIRTLseq_P12_S263.TCRa_ID02.clones_TRA.tsv</code>, so the
well ID (<code>P12</code> in this case) is in the third position
(separate by underscores) so we use <code>well_pos=3</code>. We use the
<code><a href="../reference/get_well_subset.html">get_well_subset()</a></code> function above to generate the vector of
wells for the left side of the plate. With this, we run the
<code><a href="../reference/run_pairing.html">run_pairing()</a></code> function, saving the output from CD8+ cells
in each plate to the same folder, with a different prefix for each:
<code>&lt;experiment&gt;_&lt;timepoint&gt;_&lt;marker&gt;</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### This function will attempt to automatically install a Python environment with necessary packages for GPU computation</span></span>
<span><span class="fu"><a href="../reference/run_pairing.html">run_pairing</a></span><span class="op">(</span>folder_path <span class="op">=</span> <span class="va">tp1</span>, folder_out <span class="op">=</span> <span class="va">save_folder</span>, prefix <span class="op">=</span> <span class="st">"exp3_tp1_cd8"</span>, well_filter_thres <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>          well_pos <span class="op">=</span> <span class="fl">3</span>, wellset1 <span class="op">=</span> <span class="va">cd8_wells</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "start"</span></span>
<span><span class="co">## [1] "2026-02-23 14:28:46 CST"</span></span>
<span><span class="co">## [1] "Folder already exists: ~/git/TIRTLtools/extra/exp3_cd8"</span></span>
<span><span class="co">## [1] "384 TCRalpha well files loaded"</span></span>
<span><span class="co">## [1] "384 TCRalpha well files loaded"</span></span>
<span><span class="co">## [1] "2026-02-23 14:29:16 CST"</span></span>
<span><span class="co">## [1] "Clone threshold for QC:"</span></span>
<span><span class="co">## [1] 3210</span></span>
<span><span class="co">## [1] "Alpha wells passing QC:"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## FALSE  TRUE </span></span>
<span><span class="co">##   193   191 </span></span>
<span><span class="co">## [1] "Beta wells passing QC:"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## FALSE  TRUE </span></span>
<span><span class="co">##   193   191 </span></span>
<span><span class="co">## [1] "Tabulating TCRalpha pseudobulk counts"</span></span>
<span><span class="co">## [1] "2026-02-23 14:29:16 CST"</span></span>
<span><span class="co">## [1] "Tabulating TCRbeta pseudobulk counts"</span></span>
<span><span class="co">## [1] "2026-02-23 14:29:39 CST"</span></span>
<span><span class="co">## [1] "Pseudobulk done."</span></span>
<span><span class="co">## [1] "2026-02-23 14:30:00 CST"</span></span>
<span><span class="co">## [1] "Merging alpha clonesets..."</span></span>
<span><span class="co">## [1] "Done! Unique alpha clones and wells after filtering:"</span></span>
<span><span class="co">## [1] 937875    191</span></span>
<span><span class="co">## [1] "2026-02-23 14:30:01 CST"</span></span>
<span><span class="co">## [1] "Unique alpha clones and wells in more than: 2 wells"</span></span>
<span><span class="co">## [1] 36679   191</span></span>
<span><span class="co">## [1] "Done! beta clones and wells after filtering:"</span></span>
<span><span class="co">## [1] 928777    191</span></span>
<span><span class="co">## [1] "2026-02-23 14:30:02 CST"</span></span>
<span><span class="co">## [1] "Unique beta clones and wells in more than: 2 wells"</span></span>
<span><span class="co">## [1] 36080   191</span></span>
<span><span class="co">## [1] "2026-02-23 14:30:02 CST"</span></span>
<span><span class="co">## [1] "Pre-computing look-up table:"</span></span>
<span><span class="co">##   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">## [1] "2026-02-23 14:30:06 CST"</span></span>
<span><span class="co">## [1] "Filtering results, adding amino acid and V segment information"</span></span>
<span><span class="co">## [1] "Scoring unique pairs..."</span></span>
<span><span class="co">## [1] "2026-02-23 14:30:35 CST"</span></span>
<span><span class="co">## [1] "All is done! Number of paired clones:"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## madhype  tshell </span></span>
<span><span class="co">##   13379    7311</span></span></code></pre>
<pre><code><span><span class="co">## Key: &lt;wi, wj, wij&gt;</span></span>
<span><span class="co">##           wi    wj   wij                                     alpha_nuc</span></span>
<span><span class="co">##        &lt;num&gt; &lt;num&gt; &lt;num&gt;                                        &lt;char&gt;</span></span>
<span><span class="co">##     1:     0     0     3             TGTGTGAGAGCCGGAGGCTTCAAAACTATCTTT</span></span>
<span><span class="co">##     2:     0     0     3             TGTGTGAGAGCCGGAGGCTTCAAAACTATCTTT</span></span>
<span><span class="co">##     3:     0     0     3    TGTGCAATGAGAAATCGTAGTTCCGGGTATGCACTCAACTTC</span></span>
<span><span class="co">##     4:     0     0     3       TGTGCTCTGAGCCATACTGGAGGCTTCAAAACTATCTTT</span></span>
<span><span class="co">##     5:     0     0     3    TGTGCTCTAATCCGCAATTCAGGAAACACACCTCTTGTCTTT</span></span>
<span><span class="co">##    ---                                                                </span></span>
<span><span class="co">## 20686:    92     0    38                   TGTGGGGGTTACCAGAAAGTTACCTTT</span></span>
<span><span class="co">## 20687:    94     0    42 TGTGCTCTTGGGGAAAGGATGGACAGCTGGGGGAAATTGCAGTTT</span></span>
<span><span class="co">## 20688:    97     0    56       TGTGCTCTAGAACCTGGTGGCTACAATAAGCTGATTTTT</span></span>
<span><span class="co">## 20689:    98     0    49    TGTGCAATGAGTGCATCAGGAGGAAGCTACATACCTACATTT</span></span>
<span><span class="co">## 20690:   101     0    53          TGTGCTCTTTACAGCAGTGCTTCCAAGATAATCTTT</span></span>
<span><span class="co">##                                                    beta_nuc    wa    wb</span></span>
<span><span class="co">##                                                      &lt;char&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">##     1:           TGCAGTGCTACATCTCGGAGAGAGCCCTACGAGCAGTACTTC     3     3</span></span>
<span><span class="co">##     2:        TGCGCCAGCAGCCCCGTCTGACGAATTGGAAACACCATATATTTT     3     3</span></span>
<span><span class="co">##     3:           TGTGCCAGCAGTGAGACAGGGCTCTCCTACGAGCAGTACTTC     3     3</span></span>
<span><span class="co">##     4:              TGTGCCAGCAGCCATGATGGCTCCTACGAGCAGTACTTC     3     3</span></span>
<span><span class="co">##     5:     TGTGCCAGCAGCTCCGGCGAAAGAAGGTCCTACAATGAGCAGTTCTTC     3     3</span></span>
<span><span class="co">##    ---                                                                 </span></span>
<span><span class="co">## 20686:       TGTGCCAGTAGTATCAACGGTTACTCCCCCGGGGAGCTGTTTTTTT   130    38</span></span>
<span><span class="co">## 20687: TGTGCCAGCAGTTACACGTCCGTGGGGCGCAGCGGTGAAAAACTGTTTTTTT   136    42</span></span>
<span><span class="co">## 20688:         TGTGCCATCAGTGACGATGCCACCCCCAAGAGACCCAGTACTTC   153    56</span></span>
<span><span class="co">## 20689:           TGTGCAAGTCGCCTAGGACTAGCGGGAGAGACCCAGTACTTC   147    49</span></span>
<span><span class="co">## 20690:  TGCGCCAGCAGCTTGGTTCCCTCGGACAGGGCCAATCAGCCCCAGCACTTT   154    53</span></span>
<span><span class="co">##                                        alpha_nuc_seq</span></span>
<span><span class="co">##                                               &lt;char&gt;</span></span>
<span><span class="co">##     1:             TGTGTGAGAGCCGGAGGCTTCAAAACTATCTTT</span></span>
<span><span class="co">##     2:             TGTGTGAGAGCCGGAGGCTTCAAAACTATCTTT</span></span>
<span><span class="co">##     3:    TGTGCAATGAGAAATCGTAGTTCCGGGTATGCACTCAACTTC</span></span>
<span><span class="co">##     4:       TGTGCTCTGAGCCATACTGGAGGCTTCAAAACTATCTTT</span></span>
<span><span class="co">##     5:    TGTGCTCTAATCCGCAATTCAGGAAACACACCTCTTGTCTTT</span></span>
<span><span class="co">##    ---                                              </span></span>
<span><span class="co">## 20686:                   TGTGGGGGTTACCAGAAAGTTACCTTT</span></span>
<span><span class="co">## 20687: TGTGCTCTTGGGGAAAGGATGGACAGCTGGGGGAAATTGCAGTTT</span></span>
<span><span class="co">## 20688:       TGTGCTCTAGAACCTGGTGGCTACAATAAGCTGATTTTT</span></span>
<span><span class="co">## 20689:    TGTGCAATGAGTGCATCAGGAGGAAGCTACATACCTACATTT</span></span>
<span><span class="co">## 20690:          TGTGCTCTTTACAGCAGTGCTTCCAAGATAATCTTT</span></span>
<span><span class="co">##                                                beta_nuc_seq</span></span>
<span><span class="co">##                                                      &lt;char&gt;</span></span>
<span><span class="co">##     1:           TGCAGTGCTACATCTCGGAGAGAGCCCTACGAGCAGTACTTC</span></span>
<span><span class="co">##     2:        TGCGCCAGCAGCCCCGTCTGACGAATTGGAAACACCATATATTTT</span></span>
<span><span class="co">##     3:           TGTGCCAGCAGTGAGACAGGGCTCTCCTACGAGCAGTACTTC</span></span>
<span><span class="co">##     4:              TGTGCCAGCAGCCATGATGGCTCCTACGAGCAGTACTTC</span></span>
<span><span class="co">##     5:     TGTGCCAGCAGCTCCGGCGAAAGAAGGTCCTACAATGAGCAGTTCTTC</span></span>
<span><span class="co">##    ---                                                     </span></span>
<span><span class="co">## 20686:       TGTGCCAGTAGTATCAACGGTTACTCCCCCGGGGAGCTGTTTTTTT</span></span>
<span><span class="co">## 20687: TGTGCCAGCAGTTACACGTCCGTGGGGCGCAGCGGTGAAAAACTGTTTTTTT</span></span>
<span><span class="co">## 20688:         TGTGCCATCAGTGACGATGCCACCCCCAAGAGACCCAGTACTTC</span></span>
<span><span class="co">## 20689:           TGTGCAAGTCGCCTAGGACTAGCGGGAGAGACCCAGTACTTC</span></span>
<span><span class="co">## 20690:  TGCGCCAGCAGCTTGGTTCCCTCGGACAGGGCCAATCAGCCCCAGCACTTT</span></span>
<span><span class="co">##                                                                                                alpha_beta</span></span>
<span><span class="co">##                                                                                                    &lt;char&gt;</span></span>
<span><span class="co">##     1:                       TGTGTGAGAGCCGGAGGCTTCAAAACTATCTTT_TGCAGTGCTACATCTCGGAGAGAGCCCTACGAGCAGTACTTC</span></span>
<span><span class="co">##     2:                    TGTGTGAGAGCCGGAGGCTTCAAAACTATCTTT_TGCGCCAGCAGCCCCGTCTGACGAATTGGAAACACCATATATTTT</span></span>
<span><span class="co">##     3:              TGTGCAATGAGAAATCGTAGTTCCGGGTATGCACTCAACTTC_TGTGCCAGCAGTGAGACAGGGCTCTCCTACGAGCAGTACTTC</span></span>
<span><span class="co">##     4:                    TGTGCTCTGAGCCATACTGGAGGCTTCAAAACTATCTTT_TGTGCCAGCAGCCATGATGGCTCCTACGAGCAGTACTTC</span></span>
<span><span class="co">##     5:        TGTGCTCTAATCCGCAATTCAGGAAACACACCTCTTGTCTTT_TGTGCCAGCAGCTCCGGCGAAAGAAGGTCCTACAATGAGCAGTTCTTC</span></span>
<span><span class="co">##    ---                                                                                                   </span></span>
<span><span class="co">## 20686:                         TGTGGGGGTTACCAGAAAGTTACCTTT_TGTGCCAGTAGTATCAACGGTTACTCCCCCGGGGAGCTGTTTTTTT</span></span>
<span><span class="co">## 20687: TGTGCTCTTGGGGAAAGGATGGACAGCTGGGGGAAATTGCAGTTT_TGTGCCAGCAGTTACACGTCCGTGGGGCGCAGCGGTGAAAAACTGTTTTTTT</span></span>
<span><span class="co">## 20688:               TGTGCTCTAGAACCTGGTGGCTACAATAAGCTGATTTTT_TGTGCCATCAGTGACGATGCCACCCCCAAGAGACCCAGTACTTC</span></span>
<span><span class="co">## 20689:              TGTGCAATGAGTGCATCAGGAGGAAGCTACATACCTACATTT_TGTGCAAGTCGCCTAGGACTAGCGGGAGAGACCCAGTACTTC</span></span>
<span><span class="co">## 20690:           TGTGCTCTTTACAGCAGTGCTTCCAAGATAATCTTT_TGCGCCAGCAGCTTGGTTCCCTCGGACAGGGCCAATCAGCCCCAGCACTTT</span></span>
<span><span class="co">##         method     r    ts  pval pval_adj loss_a_frac loss_b_frac     score</span></span>
<span><span class="co">##         &lt;char&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt;    &lt;num&gt;       &lt;num&gt;       &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">##     1: madhype    NA    NA    NA       NA           0   0.0000000 0.6184880</span></span>
<span><span class="co">##     2: madhype    NA    NA    NA       NA           0   0.0000000 0.6184880</span></span>
<span><span class="co">##     3: madhype    NA    NA    NA       NA           0   0.0000000 0.6184880</span></span>
<span><span class="co">##     4: madhype    NA    NA    NA       NA           0   0.0000000 0.6184880</span></span>
<span><span class="co">##     5: madhype    NA    NA    NA       NA           0   0.0000000 0.6184880</span></span>
<span><span class="co">##    ---                                                                     </span></span>
<span><span class="co">## 20686: madhype    NA    NA    NA       NA           0   0.7076923 1.8528944</span></span>
<span><span class="co">## 20687: madhype    NA    NA    NA       NA           0   0.6911765 1.7626683</span></span>
<span><span class="co">## 20688: madhype    NA    NA    NA       NA           0   0.6339869 1.1176341</span></span>
<span><span class="co">## 20689: madhype    NA    NA    NA       NA           0   0.6666667 1.1736806</span></span>
<span><span class="co">## 20690: madhype    NA    NA    NA       NA           0   0.6558442 0.5082625</span></span>
<span><span class="co">##                  cdr3a         va     ja              cdr3b       vb      jb</span></span>
<span><span class="co">##                 &lt;char&gt;     &lt;char&gt; &lt;char&gt;             &lt;char&gt;   &lt;char&gt;  &lt;char&gt;</span></span>
<span><span class="co">##     1:     CVRAGGFKTIF   TRAV12-1  TRAJ9     CSATSRREPYEQYF TRBV20-1 TRBJ2-7</span></span>
<span><span class="co">##     2:     CVRAGGFKTIF   TRAV12-1  TRAJ9    CASSPV*RIGNTIYF  TRBV5-1 TRBJ1-3</span></span>
<span><span class="co">##     3:  CAMRNRSSGYALNF TRAV14/DV4 TRAJ41     CASSETGLSYEQYF TRBV25-1 TRBJ2-7</span></span>
<span><span class="co">##     4:   CALSHTGGFKTIF    TRAV9-2  TRAJ9      CASSHDGSYEQYF  TRBV3-1 TRBJ2-7</span></span>
<span><span class="co">##     5:  CALIRNSGNTPLVF     TRAV16 TRAJ29   CASSSGERRSYNEQFF  TRBV5-4 TRBJ2-1</span></span>
<span><span class="co">##    ---                                                                      </span></span>
<span><span class="co">## 20686:       CGGYQKVTF   TRAV12-3 TRAJ13   CASSINGY_PPGSCFF   TRBV19 TRBJ2-2</span></span>
<span><span class="co">## 20687: CALGERMDSWGKLQF      TRDV1 TRAJ24 CASSYTSVG_AAVKNCFF  TRBV6-6 TRBJ1-4</span></span>
<span><span class="co">## 20688:   CALEPGGYNKLIF      TRAV6  TRAJ4    CAISDDA_PQETQYF TRBV10-3 TRBJ2-5</span></span>
<span><span class="co">## 20689:  CAMSASGGSYIPTF TRAV14/DV4  TRAJ6     CASRLGLAGETQYF TRBV12-2 TRBJ2-5</span></span>
<span><span class="co">## 20690:    CALYSSASKIIF      TRAV6  TRAJ3  CASSLVPSDRANQPQHF  TRBV5-1 TRBJ1-5</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/run_pairing.html">run_pairing</a></span><span class="op">(</span>folder_path <span class="op">=</span> <span class="va">tp2</span>, folder_out <span class="op">=</span> <span class="va">save_folder</span>, prefix <span class="op">=</span> <span class="st">"exp3_tp2_cd8"</span>, well_filter_thres <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>            well_pos <span class="op">=</span> <span class="fl">3</span>, wellset1 <span class="op">=</span> <span class="va">cd8_wells</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "start"</span></span>
<span><span class="co">## [1] "2026-02-23 14:30:35 CST"</span></span>
<span><span class="co">## [1] "Folder already exists: ~/git/TIRTLtools/extra/exp3_cd8"</span></span>
<span><span class="co">## [1] "384 TCRalpha well files loaded"</span></span>
<span><span class="co">## [1] "384 TCRalpha well files loaded"</span></span>
<span><span class="co">## [1] "2026-02-23 14:30:57 CST"</span></span>
<span><span class="co">## [1] "Clone threshold for QC:"</span></span>
<span><span class="co">## [1] 3844</span></span>
<span><span class="co">## [1] "Alpha wells passing QC:"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## FALSE  TRUE </span></span>
<span><span class="co">##   193   191 </span></span>
<span><span class="co">## [1] "Beta wells passing QC:"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## FALSE  TRUE </span></span>
<span><span class="co">##   193   191 </span></span>
<span><span class="co">## [1] "Tabulating TCRalpha pseudobulk counts"</span></span>
<span><span class="co">## [1] "2026-02-23 14:30:57 CST"</span></span>
<span><span class="co">## [1] "Tabulating TCRbeta pseudobulk counts"</span></span>
<span><span class="co">## [1] "2026-02-23 14:31:22 CST"</span></span>
<span><span class="co">## [1] "Pseudobulk done."</span></span>
<span><span class="co">## [1] "2026-02-23 14:31:43 CST"</span></span>
<span><span class="co">## [1] "Merging alpha clonesets..."</span></span>
<span><span class="co">## [1] "Done! Unique alpha clones and wells after filtering:"</span></span>
<span><span class="co">## [1] 980522    191</span></span>
<span><span class="co">## [1] "2026-02-23 14:31:44 CST"</span></span>
<span><span class="co">## [1] "Unique alpha clones and wells in more than: 2 wells"</span></span>
<span><span class="co">## [1] 58954   191</span></span>
<span><span class="co">## [1] "Done! beta clones and wells after filtering:"</span></span>
<span><span class="co">## [1] 895688    191</span></span>
<span><span class="co">## [1] "2026-02-23 14:31:45 CST"</span></span>
<span><span class="co">## [1] "Unique beta clones and wells in more than: 2 wells"</span></span>
<span><span class="co">## [1] 56637   191</span></span>
<span><span class="co">## [1] "2026-02-23 14:31:45 CST"</span></span>
<span><span class="co">## [1] "Pre-computing look-up table:"</span></span>
<span><span class="co">##   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">## [1] "2026-02-23 14:31:49 CST"</span></span>
<span><span class="co">## [1] "Filtering results, adding amino acid and V segment information"</span></span>
<span><span class="co">## [1] "Scoring unique pairs..."</span></span>
<span><span class="co">## [1] "2026-02-23 14:32:32 CST"</span></span>
<span><span class="co">## [1] "All is done! Number of paired clones:"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## madhype  tshell </span></span>
<span><span class="co">##   16369    9891</span></span></code></pre>
<pre><code><span><span class="co">## Key: &lt;wi, wj, wij&gt;</span></span>
<span><span class="co">##           wi    wj   wij                                           alpha_nuc</span></span>
<span><span class="co">##        &lt;num&gt; &lt;num&gt; &lt;num&gt;                                              &lt;char&gt;</span></span>
<span><span class="co">##     1:     0     0     3       TGTGCTACGGACGCGGAAACCGGCACTGCCAGTAAACTCACCTTT</span></span>
<span><span class="co">##     2:     0     0     3          TGTGCTGTCTTCCTCAAAGCTGCAGGCAACAAGCTAACTTTT</span></span>
<span><span class="co">##     3:     0     0     3             TGTGCTCTCCAGGGGAATAACAATGCCAGACTCATGTTT</span></span>
<span><span class="co">##     4:     0     0     3          TGTGCTCTCCTCCTTGTTTCAGATGGCCAGAAGCTGCTCTTT</span></span>
<span><span class="co">##     5:     0     0     3          TGTGCTGTGAGTCAGAAGAACAGAGATGACAAGATCATCTTT</span></span>
<span><span class="co">##    ---                                                                      </span></span>
<span><span class="co">## 26256:    95     0    36                TGCATCCTGAGAGAAGGGGGGAGTGACATGCGCTTT</span></span>
<span><span class="co">## 26257:    97     0    31       TGTGCCGTCCTCTGGGGGGTTTCAGGAAACACACCTCTTGTCTTT</span></span>
<span><span class="co">## 26258:    97     0    51                TGTGCAGAGAGGGGTGGAGGCTTCAAAACTATCTTT</span></span>
<span><span class="co">## 26259:    97     0    53 TGTGTTGTGAGTGGCTTTATACTCACGGGAGGAGGAAACAAACTCACCTTT</span></span>
<span><span class="co">## 26260:    98     0    46       TGTGCTCTGAGTGAGGCGAATTCAGATGGCCAGAAGCTGCTCTTT</span></span>
<span><span class="co">##                                                        beta_nuc    wa    wb</span></span>
<span><span class="co">##                                                          &lt;char&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">##     1:         TGTGCCAGCAGCGTAGCTCTGTCAGGGGGCTTCTATGGCTACACCTTC     3     3</span></span>
<span><span class="co">##     2:           TGTGCCAGCAGCTTAGACGTCAGGGGCAGACACTGAAGCTTTCTTT     3     3</span></span>
<span><span class="co">##     3:      TGCGCCAGCAGCTTGGCCGGAGTTCACAGGACCACAGATACGCAGTATTTT     3     3</span></span>
<span><span class="co">##     4:      TGCGCCAGCAGCTTGGCCGGAGTTCACAGGACCACAGATACGCAGTATTTT     3     3</span></span>
<span><span class="co">##     5:                  TGCAGCGTCCGACTAGCGGGAGAAACCGAGCAGTACTTC     3     3</span></span>
<span><span class="co">##    ---                                                                     </span></span>
<span><span class="co">## 26256:            TGTGCCAGCAGCTTATGGGGGGGGGGGGACACTGAAGCTTTCTTT   131    36</span></span>
<span><span class="co">## 26257:       TGTGCCAGCAGTCCCCTCCCATGGGGGATGACACAGATACGCAGTATTTT   128    31</span></span>
<span><span class="co">## 26258:            TGCGCCAGCAGCTTGCGGGACCAGCCCTACAACGAGCAGTTCTTC   148    51</span></span>
<span><span class="co">## 26259: TGTGCCAGCAGCCAAGAAGGACTAGCGGGGGGGCCTACACCGGGGAGCTGTTTTTT   150    53</span></span>
<span><span class="co">## 26260:                 TGTGCCAGCAGTTTTTTGGGAGAACAATGAGCAGTTCTTC   144    46</span></span>
<span><span class="co">##                                              alpha_nuc_seq</span></span>
<span><span class="co">##                                                     &lt;char&gt;</span></span>
<span><span class="co">##     1:       TGTGCTACGGACGCGGAAACCGGCACTGCCAGTAAACTCACCTTT</span></span>
<span><span class="co">##     2:          TGTGCTGTCTTCCTCAAAGCTGCAGGCAACAAGCTAACTTTT</span></span>
<span><span class="co">##     3:             TGTGCTCTCCAGGGGAATAACAATGCCAGACTCATGTTT</span></span>
<span><span class="co">##     4:          TGTGCTCTCCTCCTTGTTTCAGATGGCCAGAAGCTGCTCTTT</span></span>
<span><span class="co">##     5:          TGTGCTGTGAGTCAGAAGAACAGAGATGACAAGATCATCTTT</span></span>
<span><span class="co">##    ---                                                    </span></span>
<span><span class="co">## 26256:                TGCATCCTGAGAGAAGGGGGGAGTGACATGCGCTTT</span></span>
<span><span class="co">## 26257:       TGTGCCGTCCTCTGGGGGGTTTCAGGAAACACACCTCTTGTCTTT</span></span>
<span><span class="co">## 26258:                TGTGCAGAGAGGGGTGGAGGCTTCAAAACTATCTTT</span></span>
<span><span class="co">## 26259: TGTGTTGTGAGTGGCTTTATACTCACGGGAGGAGGAAACAAACTCACCTTT</span></span>
<span><span class="co">## 26260:       TGTGCTCTGAGTGAGGCGAATTCAGATGGCCAGAAGCTGCTCTTT</span></span>
<span><span class="co">##                                                    beta_nuc_seq</span></span>
<span><span class="co">##                                                          &lt;char&gt;</span></span>
<span><span class="co">##     1:         TGTGCCAGCAGCGTAGCTCTGTCAGGGGGCTTCTATGGCTACACCTTC</span></span>
<span><span class="co">##     2:           TGTGCCAGCAGCTTAGACGTCAGGGGCAGACACTGAAGCTTTCTTT</span></span>
<span><span class="co">##     3:      TGCGCCAGCAGCTTGGCCGGAGTTCACAGGACCACAGATACGCAGTATTTT</span></span>
<span><span class="co">##     4:      TGCGCCAGCAGCTTGGCCGGAGTTCACAGGACCACAGATACGCAGTATTTT</span></span>
<span><span class="co">##     5:                  TGCAGCGTCCGACTAGCGGGAGAAACCGAGCAGTACTTC</span></span>
<span><span class="co">##    ---                                                         </span></span>
<span><span class="co">## 26256:            TGTGCCAGCAGCTTATGGGGGGGGGGGGACACTGAAGCTTTCTTT</span></span>
<span><span class="co">## 26257:       TGTGCCAGCAGTCCCCTCCCATGGGGGATGACACAGATACGCAGTATTTT</span></span>
<span><span class="co">## 26258:            TGCGCCAGCAGCTTGCGGGACCAGCCCTACAACGAGCAGTTCTTC</span></span>
<span><span class="co">## 26259: TGTGCCAGCAGCCAAGAAGGACTAGCGGGGGGGCCTACACCGGGGAGCTGTTTTTT</span></span>
<span><span class="co">## 26260:                 TGTGCCAGCAGTTTTTTGGGAGAACAATGAGCAGTTCTTC</span></span>
<span><span class="co">##                                                                                                          alpha_beta</span></span>
<span><span class="co">##                                                                                                              &lt;char&gt;</span></span>
<span><span class="co">##     1:               TGTGCTACGGACGCGGAAACCGGCACTGCCAGTAAACTCACCTTT_TGTGCCAGCAGCGTAGCTCTGTCAGGGGGCTTCTATGGCTACACCTTC</span></span>
<span><span class="co">##     2:                    TGTGCTGTCTTCCTCAAAGCTGCAGGCAACAAGCTAACTTTT_TGTGCCAGCAGCTTAGACGTCAGGGGCAGACACTGAAGCTTTCTTT</span></span>
<span><span class="co">##     3:                  TGTGCTCTCCAGGGGAATAACAATGCCAGACTCATGTTT_TGCGCCAGCAGCTTGGCCGGAGTTCACAGGACCACAGATACGCAGTATTTT</span></span>
<span><span class="co">##     4:               TGTGCTCTCCTCCTTGTTTCAGATGGCCAGAAGCTGCTCTTT_TGCGCCAGCAGCTTGGCCGGAGTTCACAGGACCACAGATACGCAGTATTTT</span></span>
<span><span class="co">##     5:                           TGTGCTGTGAGTCAGAAGAACAGAGATGACAAGATCATCTTT_TGCAGCGTCCGACTAGCGGGAGAAACCGAGCAGTACTTC</span></span>
<span><span class="co">##    ---                                                                                                             </span></span>
<span><span class="co">## 26256:                           TGCATCCTGAGAGAAGGGGGGAGTGACATGCGCTTT_TGTGCCAGCAGCTTATGGGGGGGGGGGGACACTGAAGCTTTCTTT</span></span>
<span><span class="co">## 26257:             TGTGCCGTCCTCTGGGGGGTTTCAGGAAACACACCTCTTGTCTTT_TGTGCCAGCAGTCCCCTCCCATGGGGGATGACACAGATACGCAGTATTTT</span></span>
<span><span class="co">## 26258:                           TGTGCAGAGAGGGGTGGAGGCTTCAAAACTATCTTT_TGCGCCAGCAGCTTGCGGGACCAGCCCTACAACGAGCAGTTCTTC</span></span>
<span><span class="co">## 26259: TGTGTTGTGAGTGGCTTTATACTCACGGGAGGAGGAAACAAACTCACCTTT_TGTGCCAGCAGCCAAGAAGGACTAGCGGGGGGGCCTACACCGGGGAGCTGTTTTTT</span></span>
<span><span class="co">## 26260:                       TGTGCTCTGAGTGAGGCGAATTCAGATGGCCAGAAGCTGCTCTTT_TGTGCCAGCAGTTTTTTGGGAGAACAATGAGCAGTTCTTC</span></span>
<span><span class="co">##         method     r    ts  pval pval_adj loss_a_frac loss_b_frac    score</span></span>
<span><span class="co">##         &lt;char&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt;    &lt;num&gt;       &lt;num&gt;       &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">##     1: madhype    NA    NA    NA       NA           0   0.0000000 0.417523</span></span>
<span><span class="co">##     2: madhype    NA    NA    NA       NA           0   0.0000000 0.417523</span></span>
<span><span class="co">##     3: madhype    NA    NA    NA       NA           0   0.0000000 0.417523</span></span>
<span><span class="co">##     4: madhype    NA    NA    NA       NA           0   0.0000000 0.417523</span></span>
<span><span class="co">##     5: madhype    NA    NA    NA       NA           0   0.0000000 0.417523</span></span>
<span><span class="co">##    ---                                                                    </span></span>
<span><span class="co">## 26256: madhype    NA    NA    NA       NA           0   0.7251908 1.073628</span></span>
<span><span class="co">## 26257: madhype    NA    NA    NA       NA           0   0.7578125 0.388667</span></span>
<span><span class="co">## 26258: madhype    NA    NA    NA       NA           0   0.6554054 1.113315</span></span>
<span><span class="co">## 26259: madhype    NA    NA    NA       NA           0   0.6466667 1.052812</span></span>
<span><span class="co">## 26260: madhype    NA    NA    NA       NA           0   0.6805556 0.990934</span></span>
<span><span class="co">##                    cdr3a       va     ja               cdr3b       vb      jb</span></span>
<span><span class="co">##                   &lt;char&gt;   &lt;char&gt; &lt;char&gt;              &lt;char&gt;   &lt;char&gt;  &lt;char&gt;</span></span>
<span><span class="co">##     1:   CATDAETGTASKLTF   TRAV17 TRAJ44    CASSVALSGGFYGYTF    TRBV9 TRBJ1-2</span></span>
<span><span class="co">##     2:    CAVFLKAAGNKLTF    TRAV3 TRAJ17    CASSLDVR_ADTEAFF TRBV11-2 TRBJ1-1</span></span>
<span><span class="co">##     3:     CALQGNNNARLMF   TRAV21 TRAJ31   CASSLAGVHRTTDTQYF  TRBV5-1 TRBJ2-3</span></span>
<span><span class="co">##     4:    CALLLVSDGQKLLF    TRAV6 TRAJ16   CASSLAGVHRTTDTQYF  TRBV5-1 TRBJ2-3</span></span>
<span><span class="co">##     5:    CAVSQKNRDDKIIF  TRAV8-6 TRAJ30       CSVRLAGETEQYF TRBV29-1 TRBJ2-7</span></span>
<span><span class="co">##    ---                                                                       </span></span>
<span><span class="co">## 26256:      CILREGGSDMRF TRAV26-2 TRAJ43     CASSLWGGGDTEAFF  TRBV7-2 TRBJ1-1</span></span>
<span><span class="co">## 26257:   CAVLWGVSGNTPLVF TRAV12-2 TRAJ29   CASSPLPW_DDTDTQYF TRBV12-3 TRBJ2-3</span></span>
<span><span class="co">## 26258:      CAERGGGFKTIF    TRAV5  TRAJ9     CASSLRDQPYNEQFF  TRBV5-1 TRBJ2-1</span></span>
<span><span class="co">## 26259: CVVSGFILTGGGNKLTF  TRAV8-2 TRAJ10 CASSQEGLA_GAYTGELFF  TRBV3-1 TRBJ2-2</span></span>
<span><span class="co">## 26260:   CALSEANSDGQKLLF   TRAV19 TRAJ16      CASSFLG_NNEQFF   TRBV28 TRBJ2-1</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/run_pairing.html">run_pairing</a></span><span class="op">(</span>folder_path <span class="op">=</span> <span class="va">tp3</span>, folder_out <span class="op">=</span> <span class="va">save_folder</span>, prefix <span class="op">=</span> <span class="st">"exp3_tp3_cd8"</span>, well_filter_thres <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>            well_pos <span class="op">=</span> <span class="fl">3</span>, wellset1 <span class="op">=</span> <span class="va">cd8_wells</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "start"</span></span>
<span><span class="co">## [1] "2026-02-23 14:32:32 CST"</span></span>
<span><span class="co">## [1] "Folder already exists: ~/git/TIRTLtools/extra/exp3_cd8"</span></span>
<span><span class="co">## [1] "384 TCRalpha well files loaded"</span></span>
<span><span class="co">## [1] "384 TCRalpha well files loaded"</span></span>
<span><span class="co">## [1] "2026-02-23 14:32:54 CST"</span></span>
<span><span class="co">## [1] "Clone threshold for QC:"</span></span>
<span><span class="co">## [1] 3036</span></span>
<span><span class="co">## [1] "Alpha wells passing QC:"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## FALSE  TRUE </span></span>
<span><span class="co">##   192   192 </span></span>
<span><span class="co">## [1] "Beta wells passing QC:"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## FALSE  TRUE </span></span>
<span><span class="co">##   192   192 </span></span>
<span><span class="co">## [1] "Tabulating TCRalpha pseudobulk counts"</span></span>
<span><span class="co">## [1] "2026-02-23 14:32:54 CST"</span></span>
<span><span class="co">## [1] "Tabulating TCRbeta pseudobulk counts"</span></span>
<span><span class="co">## [1] "2026-02-23 14:33:17 CST"</span></span>
<span><span class="co">## [1] "Pseudobulk done."</span></span>
<span><span class="co">## [1] "2026-02-23 14:33:36 CST"</span></span>
<span><span class="co">## [1] "Merging alpha clonesets..."</span></span>
<span><span class="co">## [1] "Done! Unique alpha clones and wells after filtering:"</span></span>
<span><span class="co">## [1] 850578    192</span></span>
<span><span class="co">## [1] "2026-02-23 14:33:37 CST"</span></span>
<span><span class="co">## [1] "Unique alpha clones and wells in more than: 2 wells"</span></span>
<span><span class="co">## [1] 37721   192</span></span>
<span><span class="co">## [1] "Done! beta clones and wells after filtering:"</span></span>
<span><span class="co">## [1] 830552    192</span></span>
<span><span class="co">## [1] "2026-02-23 14:33:38 CST"</span></span>
<span><span class="co">## [1] "Unique beta clones and wells in more than: 2 wells"</span></span>
<span><span class="co">## [1] 38382   192</span></span>
<span><span class="co">## [1] "2026-02-23 14:33:38 CST"</span></span>
<span><span class="co">## [1] "Pre-computing look-up table:"</span></span>
<span><span class="co">##   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">## [1] "2026-02-23 14:33:42 CST"</span></span>
<span><span class="co">## [1] "Filtering results, adding amino acid and V segment information"</span></span>
<span><span class="co">## [1] "Scoring unique pairs..."</span></span>
<span><span class="co">## [1] "2026-02-23 14:34:09 CST"</span></span>
<span><span class="co">## [1] "All is done! Number of paired clones:"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## madhype  tshell </span></span>
<span><span class="co">##   13076    7474</span></span></code></pre>
<pre><code><span><span class="co">## Key: &lt;wi, wj, wij&gt;</span></span>
<span><span class="co">##           wi    wj   wij                                     alpha_nuc</span></span>
<span><span class="co">##        &lt;num&gt; &lt;num&gt; &lt;num&gt;                                        &lt;char&gt;</span></span>
<span><span class="co">##     1:     0     0     3    TGTGCCGTGGGCCTTACCGGCACTGCCAGTAAACTCACCTTT</span></span>
<span><span class="co">##     2:     0     0     3                            TTCGACAGACTCATGTTT</span></span>
<span><span class="co">##     3:     0     0     3          TGTGCTGTGACCAATGGGGCAGGCAAATCAACCTTT</span></span>
<span><span class="co">##     4:     0     0     3          TGTGCTGTGACCAATGGGGCAGGCAAATCAACCTTT</span></span>
<span><span class="co">##     5:     0     0     3                TGTGCCGCTGTTAACAATGACATGCGCTTT</span></span>
<span><span class="co">##    ---                                                                </span></span>
<span><span class="co">## 20546:    94     0    37 TGTGCCGTGGAGGGGGAGTCTGGTGGCTACAATAAGCTGATTTTT</span></span>
<span><span class="co">## 20547:    96     0    50          TGTGCCCCCATGGATAGCAACTATCAGTTAATCTGG</span></span>
<span><span class="co">## 20548:    97     0    36 TGCGCTGTGAGAGATAGGGACACCAATGCAGGCAAATCAACCTTT</span></span>
<span><span class="co">## 20549:   101     0    36             TGTGCAGACGGCCCCCAAGGAAATCTCATCTTT</span></span>
<span><span class="co">## 20550:   103     0    46    TGCGGCACAGAGAGTGGAGGTAGCAACTATAAACTGACATTT</span></span>
<span><span class="co">##                                                beta_nuc    wa    wb</span></span>
<span><span class="co">##                                                  &lt;char&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">##     1:             TGTGCCAGCAGGGGAAACAATCAGCCCCAGCATTTT     3     3</span></span>
<span><span class="co">##     2:       TGTGCCAGCAGTGCCGCACCAGCAAACACTGAAGCTTTCTTT     3     3</span></span>
<span><span class="co">##     3: TGCGCCAGCAGCCAAGGGGGGGGGGGGGACCAAGAGACCCAGTACTTC     3     3</span></span>
<span><span class="co">##     4:  TGCGCCAGCAGCCAAGGGGGGGGGGGGACCAAGAGACCCAGTACTTC     3     3</span></span>
<span><span class="co">##     5:             TGTGCCAGCAGTGAAAACTCCTACGAGCAGTACTTC     3     3</span></span>
<span><span class="co">##    ---                                                             </span></span>
<span><span class="co">## 20546:   TGTGCCAGCAGCGCCCACGGGGAAGGGAACGAAAAACTGTTTTTTT   131    37</span></span>
<span><span class="co">## 20547:      TGCAGTGCTAAATTAGCGGGCGACACCGGGGAGCTGTTTTTTT   146    50</span></span>
<span><span class="co">## 20548:      TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC   133    36</span></span>
<span><span class="co">## 20549:      TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC   137    36</span></span>
<span><span class="co">## 20550:          TGTGCCAGCAGCTGGGACAAAACCTACGAGCAGTACTTC   149    46</span></span>
<span><span class="co">##                                        alpha_nuc_seq</span></span>
<span><span class="co">##                                               &lt;char&gt;</span></span>
<span><span class="co">##     1:    TGTGCCGTGGGCCTTACCGGCACTGCCAGTAAACTCACCTTT</span></span>
<span><span class="co">##     2:                            TTCGACAGACTCATGTTT</span></span>
<span><span class="co">##     3:          TGTGCTGTGACCAATGGGGCAGGCAAATCAACCTTT</span></span>
<span><span class="co">##     4:          TGTGCTGTGACCAATGGGGCAGGCAAATCAACCTTT</span></span>
<span><span class="co">##     5:                TGTGCCGCTGTTAACAATGACATGCGCTTT</span></span>
<span><span class="co">##    ---                                              </span></span>
<span><span class="co">## 20546: TGTGCCGTGGAGGGGGAGTCTGGTGGCTACAATAAGCTGATTTTT</span></span>
<span><span class="co">## 20547:          TGTGCCCCCATGGATAGCAACTATCAGTTAATCTGG</span></span>
<span><span class="co">## 20548: TGCGCTGTGAGAGATAGGGACACCAATGCAGGCAAATCAACCTTT</span></span>
<span><span class="co">## 20549:             TGTGCAGACGGCCCCCAAGGAAATCTCATCTTT</span></span>
<span><span class="co">## 20550:    TGCGGCACAGAGAGTGGAGGTAGCAACTATAAACTGACATTT</span></span>
<span><span class="co">##                                            beta_nuc_seq</span></span>
<span><span class="co">##                                                  &lt;char&gt;</span></span>
<span><span class="co">##     1:             TGTGCCAGCAGGGGAAACAATCAGCCCCAGCATTTT</span></span>
<span><span class="co">##     2:       TGTGCCAGCAGTGCCGCACCAGCAAACACTGAAGCTTTCTTT</span></span>
<span><span class="co">##     3: TGCGCCAGCAGCCAAGGGGGGGGGGGGGACCAAGAGACCCAGTACTTC</span></span>
<span><span class="co">##     4:  TGCGCCAGCAGCCAAGGGGGGGGGGGGACCAAGAGACCCAGTACTTC</span></span>
<span><span class="co">##     5:             TGTGCCAGCAGTGAAAACTCCTACGAGCAGTACTTC</span></span>
<span><span class="co">##    ---                                                 </span></span>
<span><span class="co">## 20546:   TGTGCCAGCAGCGCCCACGGGGAAGGGAACGAAAAACTGTTTTTTT</span></span>
<span><span class="co">## 20547:      TGCAGTGCTAAATTAGCGGGCGACACCGGGGAGCTGTTTTTTT</span></span>
<span><span class="co">## 20548:      TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC</span></span>
<span><span class="co">## 20549:      TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC</span></span>
<span><span class="co">## 20550:          TGTGCCAGCAGCTGGGACAAAACCTACGAGCAGTACTTC</span></span>
<span><span class="co">##                                                                                          alpha_beta</span></span>
<span><span class="co">##                                                                                              &lt;char&gt;</span></span>
<span><span class="co">##     1:              TGTGCCGTGGGCCTTACCGGCACTGCCAGTAAACTCACCTTT_TGTGCCAGCAGGGGAAACAATCAGCCCCAGCATTTT</span></span>
<span><span class="co">##     2:                                TTCGACAGACTCATGTTT_TGTGCCAGCAGTGCCGCACCAGCAAACACTGAAGCTTTCTTT</span></span>
<span><span class="co">##     3:        TGTGCTGTGACCAATGGGGCAGGCAAATCAACCTTT_TGCGCCAGCAGCCAAGGGGGGGGGGGGGACCAAGAGACCCAGTACTTC</span></span>
<span><span class="co">##     4:         TGTGCTGTGACCAATGGGGCAGGCAAATCAACCTTT_TGCGCCAGCAGCCAAGGGGGGGGGGGGACCAAGAGACCCAGTACTTC</span></span>
<span><span class="co">##     5:                          TGTGCCGCTGTTAACAATGACATGCGCTTT_TGTGCCAGCAGTGAAAACTCCTACGAGCAGTACTTC</span></span>
<span><span class="co">##    ---                                                                                             </span></span>
<span><span class="co">## 20546: TGTGCCGTGGAGGGGGAGTCTGGTGGCTACAATAAGCTGATTTTT_TGTGCCAGCAGCGCCCACGGGGAAGGGAACGAAAAACTGTTTTTTT</span></span>
<span><span class="co">## 20547:             TGTGCCCCCATGGATAGCAACTATCAGTTAATCTGG_TGCAGTGCTAAATTAGCGGGCGACACCGGGGAGCTGTTTTTTT</span></span>
<span><span class="co">## 20548:    TGCGCTGTGAGAGATAGGGACACCAATGCAGGCAAATCAACCTTT_TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC</span></span>
<span><span class="co">## 20549:                TGTGCAGACGGCCCCCAAGGAAATCTCATCTTT_TGTGCCAGCAGTTTTTGCGGGGGCGGGCTACGAGCAGTACTTC</span></span>
<span><span class="co">## 20550:           TGCGGCACAGAGAGTGGAGGTAGCAACTATAAACTGACATTT_TGTGCCAGCAGCTGGGACAAAACCTACGAGCAGTACTTC</span></span>
<span><span class="co">##         method     r    ts  pval pval_adj loss_a_frac loss_b_frac     score</span></span>
<span><span class="co">##         &lt;char&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt;    &lt;num&gt;       &lt;num&gt;       &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">##     1: madhype    NA    NA    NA       NA           0   0.0000000 0.6057843</span></span>
<span><span class="co">##     2: madhype    NA    NA    NA       NA           0   0.0000000 0.6057843</span></span>
<span><span class="co">##     3: madhype    NA    NA    NA       NA           0   0.0000000 0.6057843</span></span>
<span><span class="co">##     4: madhype    NA    NA    NA       NA           0   0.0000000 0.6057843</span></span>
<span><span class="co">##     5: madhype    NA    NA    NA       NA           0   0.0000000 0.6057843</span></span>
<span><span class="co">##    ---                                                                     </span></span>
<span><span class="co">## 20546: madhype    NA    NA    NA       NA           0   0.7175573 1.5618088</span></span>
<span><span class="co">## 20547: madhype    NA    NA    NA       NA           0   0.6575342 1.6288014</span></span>
<span><span class="co">## 20548: madhype    NA    NA    NA       NA           0   0.7293233 1.0688280</span></span>
<span><span class="co">## 20549: madhype    NA    NA    NA       NA           0   0.7372263 0.5297975</span></span>
<span><span class="co">## 20550: madhype    NA    NA    NA       NA           0   0.6912752 0.4727439</span></span>
<span><span class="co">##                  cdr3a       va     ja            cdr3b       vb      jb</span></span>
<span><span class="co">##                 &lt;char&gt;   &lt;char&gt; &lt;char&gt;           &lt;char&gt;   &lt;char&gt;  &lt;char&gt;</span></span>
<span><span class="co">##     1:  CAVGLTGTASKLTF   TRAV39 TRAJ44     CASRGNNQPQHF   TRBV27 TRBJ1-5</span></span>
<span><span class="co">##     2:          FDRLMF  TRAV1-1 TRAJ31   CASSAAPANTEAFF  TRBV6-4 TRBJ1-1</span></span>
<span><span class="co">##     3:    CAVTNGAGKSTF  TRAV8-4 TRAJ27 CASSQGGGGDQETQYF  TRBV4-1 TRBJ2-5</span></span>
<span><span class="co">##     4:    CAVTNGAGKSTF  TRAV8-4 TRAJ27 CASSQGGG_DQETQYF  TRBV4-1 TRBJ2-5</span></span>
<span><span class="co">##     5:      CAAVNNDMRF TRAV12-2 TRAJ43     CASSENSYEQYF  TRBV6-1 TRBJ2-7</span></span>
<span><span class="co">##    ---                                                                  </span></span>
<span><span class="co">## 20546: CAVEGESGGYNKLIF TRAV12-2  TRAJ4 CASSAHGE_GTKNCFF    TRBV9 TRBJ1-4</span></span>
<span><span class="co">## 20547:    CAPMDSNYQLIW  TRAV1-2 TRAJ33  CSAKLAG_TPGSCFF TRBV20-1 TRBJ2-2</span></span>
<span><span class="co">## 20548: CAVRDRDTNAGKSTF  TRAV1-1 TRAJ27  CASSFCG_AGYEQYF   TRBV28 TRBJ2-7</span></span>
<span><span class="co">## 20549:     CADGPQGNLIF TRAV13-2 TRAJ42  CASSFCG_AGYEQYF   TRBV28 TRBJ2-7</span></span>
<span><span class="co">## 20550:  CGTESGGSNYKLTF   TRAV30 TRAJ53    CASSWDKTYEQYF  TRBV5-1 TRBJ2-7</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="load-paired-tcr-data">Load paired TCR data<a class="anchor" aria-label="anchor" href="#load-paired-tcr-data"></a>
</h3>
<p>The output from each call to <code><a href="../reference/run_pairing.html">run_pairing()</a></code> is 3
tab-separated text files (.tsv):</p>
<ul>
<li>
<code>&lt;sample-name&gt;_TIRTLoutput.tsv(.gz)</code>– Paired TCRs –
a table of computationally paired alpha/beta TCRs</li>
<li>
<code>&lt;sample-name&gt;_pseudobulk_TRA.tsv(.gz)</code> – Alpha
chain “pseudo-bulk” data – a table of read count summary metrics for
alpha-chains across all wells on a plate</li>
<li>
<code>&lt;sample-name&gt;_pseudobulk_TRB.tsv(.gz)</code> – Beta
chain “pseudo-bulk” data – a table of read count summary metrics for
beta-chains across all wells on a plate</li>
</ul>
<p>The <code><a href="../reference/load_tirtlseq.html">load_tirtlseq()</a></code> function can be used to load all of
the data in the folder.</p>
<p>This function loads the data into a “list”, which can contain any
type of unstructured data, with the following structure:</p>
<pre><code>your_data_object (list)
├───meta (metadata dataframe)
└───data (list)
    └───sample_1 (list)
        ├───alpha (alpha pseudobulk dataframe)
        ├───beta (beta pseudobulk dataframe)
        └───paired (paired pseudobulk dataframe)
    ...
    └───sample_n (list)
        ├───alpha (alpha pseudobulk dataframe)
        ├───beta (beta pseudobulk dataframe)
        └───paired (paired pseudobulk dataframe)</code></pre>
<p>The list contains two slots.</p>
<ul>
<li>
<code>meta</code> - a data frame with sample metadata</li>
<li>
<code>data</code> - a list with data for each sample</li>
</ul>
<p>Since we used
<code>&lt;experiment&gt;_&lt;timepoint&gt;_&lt;marker&gt;</code> for the
<code>prefix</code> for each set of output files, we add this in the
<code>meta_columns</code> argument, so that the function creates a data
frame of sample metadata with this information.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="../reference/load_tirtlseq.html">load_tirtlseq</a></span><span class="op">(</span><span class="va">save_folder</span>, sep <span class="op">=</span> <span class="st">"_"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                     meta_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"experiment"</span>, <span class="st">"timepoint"</span>, <span class="st">"marker"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading files from: ~/git/TIRTLtools/extra/exp3_cd8...</span></span></code></pre>
<pre><code><span><span class="co">## Found 3 beta chain pseudo-bulk files.</span></span></code></pre>
<pre><code><span><span class="co">## Found 3 paired chain files.</span></span></code></pre>
<pre><code><span><span class="co">## Loaded 9 files from 3 samples.</span></span></code></pre>
<pre><code><span><span class="co">## 3.3 seconds</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="plot-changes-in-tcr-repertoire-over-time">Plot changes in TCR repertoire over time<a class="anchor" aria-label="anchor" href="#plot-changes-in-tcr-repertoire-over-time"></a>
</h3>
<p>After loading the data, we can use the
<code><a href="../reference/plot_sample_vs_sample.html">plot_sample_vs_sample()</a></code> function to make a scatter plot of
clone frequencies between two samples.</p>
<p>We can re-create the top half of Figure 3B from the <a href="http://doi.org/10.1038/s41592-025-02907-9" class="external-link">paper</a>, showing
clone comparisons from baseline (pre-infection) to acute (6 days
post-infection) and from acute to convalescent (29 days
post-infection)</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg1</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_sample_vs_sample.html">plot_sample_vs_sample</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">exp3_tp1_cd8</span>, <span class="va">data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">exp3_tp2_cd8</span>, </span>
<span>  labelx <span class="op">=</span> <span class="st">"Frequency at baseline"</span>, labely <span class="op">=</span> <span class="st">"Frequency at acute"</span>,</span>
<span>  log2fc_cutoff <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  sem_cutoff <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  smooth_sem <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">gg2</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_sample_vs_sample.html">plot_sample_vs_sample</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">exp3_tp2_cd8</span>, <span class="va">data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">exp3_tp3_cd8</span>, </span>
<span>  labelx <span class="op">=</span> <span class="st">"Frequency at acute"</span>, labely <span class="op">=</span> <span class="st">"Frequency at conv"</span>,</span>
<span>  log2fc_cutoff <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  sem_cutoff <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  smooth_sem <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">gg1</span> <span class="co">## baseline vs. acute (top left of Fig. 3B)</span></span></code></pre></div>
<p><img src="pairing_zenodo_data_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg2</span> <span class="co">## acute vs. convalescent (top right of Fig. 3B)</span></span></code></pre></div>
<p><img src="pairing_zenodo_data_files/figure-html/unnamed-chunk-5-2.png" class="r-plt" width="700"></p>
<p>Note that the objects returned by the plotting functions in the
package are almost all <code>ggplot</code> objects, so they can be
modified by any functions in the <code>ggplot2</code> package such as
the <code>theme()</code> function. <code>ggplot2</code> function are
loaded by default in <code>TIRTLtools</code>, so they are available to
the user without specifying <code>ggplot2::</code> before the function
name.</p>
<p>Since the figures are smaller in the paper and without a legend, we
can re-create that here.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg1</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="co">## baseline vs. acute (top left of Fig. 3B)</span></span></code></pre></div>
<p><img src="pairing_zenodo_data_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" width="288"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg2</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="co">## acute vs. convalescent (top right of Fig. 3B)</span></span></code></pre></div>
<p><img src="pairing_zenodo_data_files/figure-html/unnamed-chunk-6-2.png" class="r-plt" width="288"></p>
</div>
<div class="section level3">
<h3 id="find-the-number-of-expanded-and-contracted-clones">Find the number of expanded and contracted clones<a class="anchor" aria-label="anchor" href="#find-the-number-of-expanded-and-contracted-clones"></a>
</h3>
<p>We can also call the same function with
<code>return_data = TRUE</code> to get the data used to create the plot,
with read fractions, log2 fold-change, and labels for whether the clone
is expanded, contracted, or stable.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseline_to_acute_df</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_sample_vs_sample.html">plot_sample_vs_sample</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">exp3_tp1_cd8</span>, <span class="va">data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">exp3_tp2_cd8</span>, </span>
<span>                                             return_data <span class="op">=</span> <span class="cn">TRUE</span>, smooth_sem <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">acute_to_conv_df</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_sample_vs_sample.html">plot_sample_vs_sample</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">exp3_tp2_cd8</span>, <span class="va">data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">exp3_tp3_cd8</span>, </span>
<span>                                         return_data <span class="op">=</span> <span class="cn">TRUE</span>, smooth_sem <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">baseline_to_acute_df</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;targetSequences, aaSeqCDR3, v, j&gt;</span></span>
<span><span class="co">##                                                targetSequences</span></span>
<span><span class="co">##                                                         &lt;char&gt;</span></span>
<span><span class="co">##     1:                       CACAGCGCCGGGACACCTTATGGCTACACCTTC</span></span>
<span><span class="co">##     2:                    CCCGAGCGGCGAGAGATCGGGTTAGAGCAGTACTTC</span></span>
<span><span class="co">##     3:                      CCCTACTCACGGGGCTTACACTGAAGCTTTCTTT</span></span>
<span><span class="co">##     4:                          CGCAGCAGAGGCGCAGATACGCAGTATTTT</span></span>
<span><span class="co">##     5:                       CGCAGCGCCGGAGGGAACACTGAAGCTTTCTTT</span></span>
<span><span class="co">##    ---                                                        </span></span>
<span><span class="co">## 44269:                TTGTGCTAGTGGTTCTTGGACAGGCAATGAGCAGTTCTTC</span></span>
<span><span class="co">## 44270:          TTGTGCTAGTGGTTTGATAGGTCAAAACCCAAATGAGCAGTTCTTC</span></span>
<span><span class="co">## 44271: TTGTGCTAGTGGTTTGGTGACTAGCGGGAGGGCGGACACCGGGGAGCTGTTTTTT</span></span>
<span><span class="co">## 44272:                    TTTGCCAGTAGTGTTGGCAGAACTGGCTACACCTTC</span></span>
<span><span class="co">## 44273:                    TTTGCCGCGGGACTAGCGGGTCGGGAGCAGTACTTC</span></span>
<span><span class="co">##                  aaSeqCDR3        v       j readCount.x n_wells.x</span></span>
<span><span class="co">##                     &lt;char&gt;   &lt;char&gt;  &lt;char&gt;       &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">##     1:         HSAGTPYGYTF TRBV29-1 TRBJ1-2           0         0</span></span>
<span><span class="co">##     2:        PERREIGLEQYF   TRBV19 TRBJ2-7           0         0</span></span>
<span><span class="co">##     3:        PYSRGL_TEAFF   TRBV30 TRBJ1-1         258        11</span></span>
<span><span class="co">##     4:          RSRGADTQYF TRBV20-1 TRBJ2-3          18         5</span></span>
<span><span class="co">##     5:         RSAGGNTEAFF TRBV29-1 TRBJ1-1           0         0</span></span>
<span><span class="co">##    ---                                                           </span></span>
<span><span class="co">## 44269:      LC*WFLD_GNEQFF TRBV12-5 TRBJ2-1         148        16</span></span>
<span><span class="co">## 44270:    LC*WFDRS_NPNEQFF TRBV12-5 TRBJ2-1           0         0</span></span>
<span><span class="co">## 44271: LC*WFGD*R_RADTGELFF TRBV12-5 TRBJ2-2           0         0</span></span>
<span><span class="co">## 44272:        FASSVGRTGYTF   TRBV19 TRBJ1-2           0         0</span></span>
<span><span class="co">## 44273:        FAAGLAGREQYF  TRBV4-2 TRBJ2-7         144        13</span></span>
<span><span class="co">##        readCount_max.x readCount_median.x        sem.x readFraction.x</span></span>
<span><span class="co">##                  &lt;num&gt;              &lt;num&gt;        &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">##     1:               0                  0 5.627777e-06   0.000000e+00</span></span>
<span><span class="co">##     2:               0                  0 5.627777e-06   0.000000e+00</span></span>
<span><span class="co">##     3:              37                 24 8.155221e-07   2.623903e-06</span></span>
<span><span class="co">##     4:               7                  4 9.325517e-08   1.830630e-07</span></span>
<span><span class="co">##     5:               0                  0 5.627777e-06   0.000000e+00</span></span>
<span><span class="co">##    ---                                                               </span></span>
<span><span class="co">## 44269:              28                  9 3.981132e-07   1.505185e-06</span></span>
<span><span class="co">## 44270:               0                  0 5.627777e-06   0.000000e+00</span></span>
<span><span class="co">## 44271:               0                  0 5.627777e-06   0.000000e+00</span></span>
<span><span class="co">## 44272:               0                  0 5.627777e-06   0.000000e+00</span></span>
<span><span class="co">## 44273:              21                 11 3.998983e-07   1.464504e-06</span></span>
<span><span class="co">##        max_wells.x        avg.x readCount.y n_wells.y readCount_max.y</span></span>
<span><span class="co">##              &lt;num&gt;        &lt;num&gt;       &lt;num&gt;     &lt;num&gt;           &lt;num&gt;</span></span>
<span><span class="co">##     1:           0 0.000000e+00           8         6               2</span></span>
<span><span class="co">##     2:           0 0.000000e+00         159        17              20</span></span>
<span><span class="co">##     3:         191 2.623903e-06          48         6              11</span></span>
<span><span class="co">##     4:         191 1.830630e-07           4         1               4</span></span>
<span><span class="co">##     5:           0 0.000000e+00          36         6               9</span></span>
<span><span class="co">##    ---                                                               </span></span>
<span><span class="co">## 44269:         191 1.505185e-06          64        15               7</span></span>
<span><span class="co">## 44270:           0 0.000000e+00          23         5               7</span></span>
<span><span class="co">## 44271:           0 0.000000e+00         108        25              14</span></span>
<span><span class="co">## 44272:           0 0.000000e+00         288        13              31</span></span>
<span><span class="co">## 44273:         191 1.464504e-06          11         2               7</span></span>
<span><span class="co">##        readCount_median.y        sem.y readFraction.y max_wells.y        avg.y</span></span>
<span><span class="co">##                     &lt;num&gt;        &lt;num&gt;          &lt;num&gt;       &lt;num&gt;        &lt;num&gt;</span></span>
<span><span class="co">##     1:                1.0 3.870094e-08   1.000851e-07         191 1.000851e-07</span></span>
<span><span class="co">##     2:                9.0 5.352627e-07   1.989191e-06         191 1.989191e-06</span></span>
<span><span class="co">##     3:                9.0 2.728054e-07   6.005106e-07         191 6.005106e-07</span></span>
<span><span class="co">##     4:                4.0 2.211298e-06   5.004255e-08         191 5.004255e-08</span></span>
<span><span class="co">##     5:                7.0 2.013660e-07   4.503830e-07         191 4.503830e-07</span></span>
<span><span class="co">##    ---                                                                        </span></span>
<span><span class="co">## 44269:                5.0 2.237762e-07   8.006808e-07         191 8.006808e-07</span></span>
<span><span class="co">## 44270:                4.0 1.475716e-07   2.877447e-07         191 2.877447e-07</span></span>
<span><span class="co">## 44271:                4.0 2.984159e-07   1.351149e-06         191 1.351149e-06</span></span>
<span><span class="co">## 44272:               22.0 1.009929e-06   3.603064e-06         191 3.603064e-06</span></span>
<span><span class="co">## 44273:                5.5 2.211298e-06   1.376170e-07         191 1.376170e-07</span></span>
<span><span class="co">##            log2FC   sign</span></span>
<span><span class="co">##             &lt;num&gt; &lt;char&gt;</span></span>
<span><span class="co">##     1:  0.1376151 stable</span></span>
<span><span class="co">##     2:  1.5797553 stable</span></span>
<span><span class="co">##     3: -1.1790120 stable</span></span>
<span><span class="co">##     4: -0.1720791 stable</span></span>
<span><span class="co">##     5:  0.5364339 stable</span></span>
<span><span class="co">##    ---                  </span></span>
<span><span class="co">## 44269: -0.4763744 stable</span></span>
<span><span class="co">## 44270:  0.3648466 stable</span></span>
<span><span class="co">## 44271:  1.2333659 stable</span></span>
<span><span class="co">## 44272:  2.2025944 stable</span></span>
<span><span class="co">## 44273: -1.1152823 stable</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">acute_to_conv_df</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;targetSequences, aaSeqCDR3, v, j&gt;</span></span>
<span><span class="co">##                                                targetSequences</span></span>
<span><span class="co">##                                                         &lt;char&gt;</span></span>
<span><span class="co">##     1:                       CACAGCGCCGGGACACCTTATGGCTACACCTTC</span></span>
<span><span class="co">##     2:                    CCCGAGCGGCGAGAGATCGGGTTAGAGCAGTACTTC</span></span>
<span><span class="co">##     3:                      CCCTACTCACGGGGCTTACACTGAAGCTTTCTTT</span></span>
<span><span class="co">##     4:                    CGCAGCCCCCAGGAGGGAGGCTATGGCTACACCTTC</span></span>
<span><span class="co">##     5:                       CGCAGCGCCGGAGGGAACACTGAAGCTTTCTTT</span></span>
<span><span class="co">##    ---                                                        </span></span>
<span><span class="co">## 43622:                TTGTGCTAGTGGTTCTTGGACAGGCAATGAGCAGTTCTTC</span></span>
<span><span class="co">## 43623:          TTGTGCTAGTGGTTTGATAGGTCAAAACCCAAATGAGCAGTTCTTC</span></span>
<span><span class="co">## 43624: TTGTGCTAGTGGTTTGGTGACTAGCGGGAGGGCGGACACCGGGGAGCTGTTTTTT</span></span>
<span><span class="co">## 43625:                 TTTAGCGGCAAGGGATGGTGGAATCAGCCCCAGCATTTT</span></span>
<span><span class="co">## 43626:                    TTTGCCAGTAGTGTTGGCAGAACTGGCTACACCTTC</span></span>
<span><span class="co">##                  aaSeqCDR3        v       j readCount.x n_wells.x</span></span>
<span><span class="co">##                     &lt;char&gt;   &lt;char&gt;  &lt;char&gt;       &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">##     1:         HSAGTPYGYTF TRBV29-1 TRBJ1-2           8         6</span></span>
<span><span class="co">##     2:        PERREIGLEQYF   TRBV19 TRBJ2-7         159        17</span></span>
<span><span class="co">##     3:        PYSRGL_TEAFF   TRBV30 TRBJ1-1          48         6</span></span>
<span><span class="co">##     4:        RSPQEGGYGYTF TRBV29-1 TRBJ1-2           8         3</span></span>
<span><span class="co">##     5:         RSAGGNTEAFF TRBV29-1 TRBJ1-1          36         6</span></span>
<span><span class="co">##    ---                                                           </span></span>
<span><span class="co">## 43622:      LC*WFLD_GNEQFF TRBV12-5 TRBJ2-1          64        15</span></span>
<span><span class="co">## 43623:    LC*WFDRS_NPNEQFF TRBV12-5 TRBJ2-1          23         5</span></span>
<span><span class="co">## 43624: LC*WFGD*R_RADTGELFF TRBV12-5 TRBJ2-2         108        25</span></span>
<span><span class="co">## 43625:       FSGKGWWNQPQHF   TRBV14 TRBJ1-5           0         0</span></span>
<span><span class="co">## 43626:        FASSVGRTGYTF   TRBV19 TRBJ1-2         288        13</span></span>
<span><span class="co">##        readCount_max.x readCount_median.x        sem.x readFraction.x</span></span>
<span><span class="co">##                  &lt;num&gt;              &lt;num&gt;        &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">##     1:               2                  1 3.870094e-08   1.000851e-07</span></span>
<span><span class="co">##     2:              20                  9 5.352627e-07   1.989191e-06</span></span>
<span><span class="co">##     3:              11                  9 2.728054e-07   6.005106e-07</span></span>
<span><span class="co">##     4:               5                  2 8.333671e-08   1.000851e-07</span></span>
<span><span class="co">##     5:               9                  7 2.013660e-07   4.503830e-07</span></span>
<span><span class="co">##    ---                                                               </span></span>
<span><span class="co">## 43622:               7                  5 2.237762e-07   8.006808e-07</span></span>
<span><span class="co">## 43623:               7                  4 1.475716e-07   2.877447e-07</span></span>
<span><span class="co">## 43624:              14                  4 2.984159e-07   1.351149e-06</span></span>
<span><span class="co">## 43625:               0                  0 2.134084e-06   0.000000e+00</span></span>
<span><span class="co">## 43626:              31                 22 1.009929e-06   3.603064e-06</span></span>
<span><span class="co">##        max_wells.x        avg.x readCount.y n_wells.y readCount_max.y</span></span>
<span><span class="co">##              &lt;num&gt;        &lt;num&gt;       &lt;num&gt;     &lt;num&gt;           &lt;num&gt;</span></span>
<span><span class="co">##     1:         191 1.000851e-07           0         0               0</span></span>
<span><span class="co">##     2:         191 1.989191e-06           0         0               0</span></span>
<span><span class="co">##     3:         191 6.005106e-07          70         2              35</span></span>
<span><span class="co">##     4:         191 1.000851e-07          14         6               3</span></span>
<span><span class="co">##     5:         191 4.503830e-07          15         3              12</span></span>
<span><span class="co">##    ---                                                               </span></span>
<span><span class="co">## 43622:         191 8.006808e-07         146        19              16</span></span>
<span><span class="co">## 43623:         191 2.877447e-07          25         4              10</span></span>
<span><span class="co">## 43624:         191 1.351149e-06          79        14              10</span></span>
<span><span class="co">## 43625:           0 0.000000e+00          95         8              18</span></span>
<span><span class="co">## 43626:         191 3.603064e-06         290        14              32</span></span>
<span><span class="co">##        readCount_median.y        sem.y readFraction.y max_wells.y        avg.y</span></span>
<span><span class="co">##                     &lt;num&gt;        &lt;num&gt;          &lt;num&gt;       &lt;num&gt;        &lt;num&gt;</span></span>
<span><span class="co">##     1:                0.0 3.884462e-06   0.000000e+00           0 0.000000e+00</span></span>
<span><span class="co">##     2:                0.0 3.884462e-06   0.000000e+00           0 0.000000e+00</span></span>
<span><span class="co">##     3:               35.0 3.884462e-06   8.434052e-07         192 8.434052e-07</span></span>
<span><span class="co">##     4:                2.0 6.673244e-08   1.686810e-07         192 1.686810e-07</span></span>
<span><span class="co">##     5:                2.0 1.446004e-07   1.807297e-07         192 1.807297e-07</span></span>
<span><span class="co">##    ---                                                                        </span></span>
<span><span class="co">## 43622:                7.0 4.064522e-07   1.759102e-06         192 1.759102e-06</span></span>
<span><span class="co">## 43623:                5.0 1.979693e-07   3.012161e-07         192 3.012161e-07</span></span>
<span><span class="co">## 43624:                5.0 2.602906e-07   9.518430e-07         192 9.518430e-07</span></span>
<span><span class="co">## 43625:               11.5 3.799922e-07   1.144621e-06         192 1.144621e-06</span></span>
<span><span class="co">## 43626:               18.5 9.497320e-07   3.494107e-06         192 3.494107e-06</span></span>
<span><span class="co">##             log2FC   sign</span></span>
<span><span class="co">##              &lt;num&gt; &lt;char&gt;</span></span>
<span><span class="co">##     1: -0.13761513 stable</span></span>
<span><span class="co">##     2: -1.57975527 stable</span></span>
<span><span class="co">##     3:  0.20384100 stable</span></span>
<span><span class="co">##     4:  0.08726611 stable</span></span>
<span><span class="co">##     5: -0.29675516 stable</span></span>
<span><span class="co">##    ---                   </span></span>
<span><span class="co">## 43622:  0.61565649 stable</span></span>
<span><span class="co">## 43623:  0.01501407 stable</span></span>
<span><span class="co">## 43624: -0.26852885 stable</span></span>
<span><span class="co">## 43625:  1.10072296 stable</span></span>
<span><span class="co">## 43626: -0.03455981 stable</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">baseline_to_acute_df</span><span class="op">$</span><span class="va">sign</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   down stable     up </span></span>
<span><span class="co">##    113  43180    980</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">acute_to_conv_df</span><span class="op">$</span><span class="va">sign</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   down stable     up </span></span>
<span><span class="co">##    321  43197    108</span></span></code></pre>
<p>The numbers of expanded and contracted clones match the figures from
the paper, with small differences due to differing quality control
settings.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/NicholasClark/" class="external-link">Nicholas Clark</a>, <a href="https://scholar.google.com/citations?user=oiypK_UAAAAJ" class="external-link">Mikhail Pogorelyy</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  
</body>
</html>
