<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimating TCR Repertoire diversity • TIRTLtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Estimating TCR Repertoire diversity">
</head>
<body>
<p>








  pkgdown/extra.css

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TIRTLtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/TIRTLtools.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/data_loading.html">Loading TIRTLseq data in R</a></li>
    <li><a class="dropdown-item" href="../articles/plot_examples.html">Plot examples with SJTRC COVID-19 data</a></li>
    <li><a class="dropdown-item" href="../articles/TCRdist.html">Fast TCR similarity calculation with TCRdist GPU</a></li>
    <li><a class="dropdown-item" href="../articles/structure_in_R.html">(coming soon) The structure of TIRTLseq data in R</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_tirtlseq_data_in_R.html">(coming soon) Working with TIRTLseq data in R</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Basic TIRTLseq data analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/summarizing_diversity.html">Estimating TCR Repertoire diversity</a></li>
    <li><a class="dropdown-item" href="../articles/SJTRC_identifying_covid_epitopes.html">(coming soon) Identifying SARS-CoV-2 epitopes from TIRTLseq data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Constructing full TCR nucleotide sequences</h6></li>
    <li><a class="dropdown-item" href="../articles/stitchr.html">(coming soon) Create output for Stitchr</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Single-cell TIRTLseq analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/scTIRTLseq_data.html">(coming soon) Working with single-cell TIRTLseq data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Well-level TIRTLseq analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/well_level_data.html">(coming soon) Working with well-level TIRTLseq data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NicholasClark/TIRTLtools"><span class="fa fa-github fa-lg"></span> Github</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Estimating TCR Repertoire diversity</h1>
            
            <h4 data-toc-skip class="date">2025-10-31</h4>
      

      <div class="d-none name"><code>summarizing_diversity.Rmd</code></div>
    </div>

    
    
<p>TIRTLtools has a number of built-in metrics for repertoire diversity
estimation.</p>
<p>We start by loading an example TIRTLseq dataset of some
CD4/8-isolated samples from COVID-infected patients at a few
timepoints.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nicholasclark.github.io/TIRTLtools/">TIRTLtools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/rmarkdown" class="external-link">rmarkdown</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">folder</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/SJTRC_TIRTL_seq_longitudinal"</span>, package <span class="op">=</span> <span class="st">"TIRTLtools"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">folder</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "cd4_tp1_v2_pseudobulk_TRA.tsv.gz" "cd4_tp1_v2_pseudobulk_TRB.tsv.gz"</span></span>
<span><span class="co">##  [3] "cd4_tp1_v2_TIRTLoutput.tsv.gz"    "cd4_tp2_v2_pseudobulk_TRA.tsv.gz"</span></span>
<span><span class="co">##  [5] "cd4_tp2_v2_pseudobulk_TRB.tsv.gz" "cd4_tp2_v2_TIRTLoutput.tsv.gz"   </span></span>
<span><span class="co">##  [7] "cd4_tp3_v2_pseudobulk_TRA.tsv.gz" "cd4_tp3_v2_pseudobulk_TRB.tsv.gz"</span></span>
<span><span class="co">##  [9] "cd4_tp3_v2_TIRTLoutput.tsv.gz"    "cd8_tp1_v2_pseudobulk_TRA.tsv.gz"</span></span>
<span><span class="co">## [11] "cd8_tp1_v2_pseudobulk_TRB.tsv.gz" "cd8_tp1_v2_TIRTLoutput.tsv.gz"   </span></span>
<span><span class="co">## [13] "cd8_tp2_v2_pseudobulk_TRA.tsv.gz" "cd8_tp2_v2_pseudobulk_TRB.tsv.gz"</span></span>
<span><span class="co">## [15] "cd8_tp2_v2_TIRTLoutput.tsv.gz"    "cd8_tp3_v2_pseudobulk_TRA.tsv.gz"</span></span>
<span><span class="co">## [17] "cd8_tp3_v2_pseudobulk_TRB.tsv.gz" "cd8_tp3_v2_TIRTLoutput.tsv.gz"</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_data</span> <span class="op">=</span> <span class="fu"><a href="../reference/load_tirtlseq.html">load_tirtlseq</a></span><span class="op">(</span><span class="va">folder</span>, meta_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"marker"</span>, <span class="st">"timepoint"</span>, <span class="st">"version"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span><span class="co">## these files are named (marker)_(timepoint)_(version)_etc.tsv.gz</span></span></code></pre></div>
<p>We offer the following diversity metrics/indices:</p>
<ul>
<li>
<code>simpson</code> - The Simpson diversity index (<a href="https://en.wikipedia.org/wiki/Diversity_index#Simpson_index" class="external-link uri">https://en.wikipedia.org/wiki/Diversity_index#Simpson_index</a>).
This equals the probability that two entities taken at random from the
dataset represent the same type. It is the inverse of the Hill number of
order 2.</li>
<li>
<code>gini</code> - The Gini index/coefficient (<a href="https://en.wikipedia.org/wiki/Gini_coefficient" class="external-link uri">https://en.wikipedia.org/wiki/Gini_coefficient</a>).</li>
<li>
<code>gini.simpson</code> - The Gini-Simpson index (<a href="https://en.wikipedia.org/wiki/Diversity_index#Gini%E2%80%93Simpson_index" class="external-link uri">https://en.wikipedia.org/wiki/Diversity_index#Gini%E2%80%93Simpson_index</a>).
Equal to 1-Simpson_index. This equals the probability that two entities
taken at random from the dataset represent different types.</li>
<li>
<code>inv.simpson</code> - The Inverse-Simpson index - i.e. the
reciprocal of the Simpson index, which measures the effective number of
types when the weighted arithmetic mean is used to calculate diversity.
It is equivalent to the Hill number of order 2. (<a href="https://en.wikipedia.org/wiki/Diversity_index#Inverse_Simpson_index" class="external-link uri">https://en.wikipedia.org/wiki/Diversity_index#Inverse_Simpson_index</a>)</li>
<li>
<code>shannon</code> - The Shannon diversity index, also known as
the Shannon-Wiener index or Shannon entropy. It is equivalent to the
Renyi entropy when ‘q’ = 1. (<a href="https://en.wikipedia.org/wiki/Diversity_index#Shannon_index" class="external-link uri">https://en.wikipedia.org/wiki/Diversity_index#Shannon_index</a>)</li>
<li>
<code>berger.parker</code> - The Berger-Parker index, i.e. the
proportion of the most abundant type in the dataset. (<a href="https://en.wikipedia.org/wiki/Diversity_index#Berger%E2%80%93Parker_index" class="external-link uri">https://en.wikipedia.org/wiki/Diversity_index#Berger%E2%80%93Parker_index</a>)</li>
<li>
<code>richness</code> - The species richness, i.e. the total number
of unique types observed in the data (<a href="https://en.wikipedia.org/wiki/Diversity_index#Richness" class="external-link uri">https://en.wikipedia.org/wiki/Diversity_index#Richness</a>).</li>
<li>
<code>d50</code> - The minimum number of types (clones) needed to
comprise 50 percent of the data.</li>
<li>
<code>dXX</code> - The minimum number of types (clones) needed to
comprise XX percent of the data.</li>
<li>
<code>renyi</code> - The Renyi entropy, a generalization of Shannon
diversity/entropy for values of ‘q’ other than 1. The formula for Renyi
entropy is undefined at q=1, but it is defined as its limit, which
equals the Shannon entropy. When q=0, it is simply the natural logarithm
of the richness or total number of types. When q=Inf, it is defined by
its limit, which is equal to the negative of the natural logarithm of
the proportion of the most abundant type. (<a href="https://en.wikipedia.org/wiki/Diversity_index#R%C3%A9nyi_entropy" class="external-link uri">https://en.wikipedia.org/wiki/Diversity_index#R%C3%A9nyi_entropy</a>)</li>
<li>
<code>hill</code> - The Hill numbers of order q, also known as the
true diversity or the effective number of types. This is the number of
equally abundant types needed for the average proportional abundance of
types to equal that observed in the dataset. The order ‘q’ defines the
exponent used in the formula to define the ‘generalized mean’ of the
proportional abundances.
<ul>
<li>
<code>q = 2</code> corresponds to the arithmetic mean (<a href="https://en.wikipedia.org/wiki/Arithmetic_mean" class="external-link uri">https://en.wikipedia.org/wiki/Arithmetic_mean</a>).</li>
<li>
<code>q = 1</code> corresponds to the geometric mean (<a href="https://en.wikipedia.org/wiki/Geometric_mean" class="external-link uri">https://en.wikipedia.org/wiki/Geometric_mean</a>).</li>
<li>
<code>q = 0</code> corresponds to the harmonic mean (<a href="https://en.wikipedia.org/wiki/Harmonic_mean" class="external-link uri">https://en.wikipedia.org/wiki/Harmonic_mean</a>).</li>
<li>When <code>q = Inf</code>, it is defined by its limit, which is the
inverse of the proportion of the most abundant type.</li>
<li>In general, as <code>q</code> increases, less weight is given to
rarer species. (<a href="https://en.wikipedia.org/wiki/Diversity_index#Effective_number_of_species_or_Hill_numbers" class="external-link uri">https://en.wikipedia.org/wiki/Diversity_index#Effective_number_of_species_or_Hill_numbers</a>)</li>
</ul>
</li>
</ul>
<p>For a full list of the currently available metrics, run
<code><a href="../reference/get_all_div_metrics.html">get_all_div_metrics()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_all_div_metrics.html">get_all_div_metrics</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "simpson"        "gini"           "gini.simpson"   "inv.simpson"   </span></span>
<span><span class="co">##  [5] "shannon"        "berger.parker"  "richness"       "d50"           </span></span>
<span><span class="co">##  [9] "dXX"            "renyi"          "hill"           "top10fraction" </span></span>
<span><span class="co">## [13] "top100fraction" "topNfraction"</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">div</span> <span class="op">=</span> <span class="fu"><a href="../reference/calculate_diversity.html">calculate_diversity</a></span><span class="op">(</span><span class="va">ts_data</span>, chain <span class="op">=</span> <span class="st">"beta"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## -- Calculating diversity indices for sample 1 of 6.</span></span>
<span><span class="co">## -- Calculating diversity indices for sample 2 of 6.</span></span>
<span><span class="co">## -- Calculating diversity indices for sample 3 of 6.</span></span>
<span><span class="co">## -- Calculating diversity indices for sample 4 of 6.</span></span>
<span><span class="co">## -- Calculating diversity indices for sample 5 of 6.</span></span>
<span><span class="co">## -- Calculating diversity indices for sample 6 of 6.</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_diversity.html">plot_diversity</a></span><span class="op">(</span><span class="va">div</span>, metric <span class="op">=</span> <span class="st">"d50"</span><span class="op">)</span></span></code></pre></div>
<p><img src="summarizing_diversity_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" width="700"></p>
<p>The <code><a href="../reference/plot_diversity.html">plot_diversity()</a></code> function returns a ggplot object
that contains the sample metadata in <code>ts_data$meta</code>, so we
can use ggplot to make the plot more informative.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_diversity.html">plot_diversity</a></span><span class="op">(</span><span class="va">div</span>, metric <span class="op">=</span> <span class="st">"richness"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">marker</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">marker</span><span class="op">)</span></span></code></pre></div>
<p><img src="summarizing_diversity_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_diversity.html">plot_diversity</a></span><span class="op">(</span><span class="va">div</span>, metric <span class="op">=</span> <span class="st">"berger.parker"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">marker</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">marker</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red3"</span>, <span class="st">"blue4"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">fill</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">fill</span>, which will replace the existing scale.</span></span></code></pre>
<p><img src="summarizing_diversity_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_diversity.html">plot_diversity</a></span><span class="op">(</span><span class="va">div</span>, metric <span class="op">=</span> <span class="st">"simpson"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">timepoint</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">marker</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red3"</span>, <span class="st">"blue4"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">fill</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">fill</span>, which will replace the existing scale.</span></span></code></pre>
<p><img src="summarizing_diversity_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_diversity.html">plot_diversity</a></span><span class="op">(</span><span class="va">div</span>, metric <span class="op">=</span> <span class="st">"shannon"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">timepoint</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">marker</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red3"</span>, <span class="st">"blue4"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">fill</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">fill</span>, which will replace the existing scale.</span></span></code></pre>
<p><img src="summarizing_diversity_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_diversity.html">plot_diversity</a></span><span class="op">(</span><span class="va">div</span>, metric <span class="op">=</span> <span class="st">"top10fraction"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">timepoint</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">marker</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red3"</span>, <span class="st">"blue4"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">fill</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">fill</span>, which will replace the existing scale.</span></span></code></pre>
<p><img src="summarizing_diversity_files/figure-html/unnamed-chunk-9-1.png" class="r-plt" width="700"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/NicholasClark/" class="external-link">Nicholas Clark</a>, <a href="https://scholar.google.com/citations?user=oiypK_UAAAAJ" class="external-link">Mikhail Pogorelyy</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  
</body>
</html>
